<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/star.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/star.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/star.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/blog/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"mazui3.com","root":"/blog/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","width":265,"display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":{"disqus":{"text":"Load Disqus","order":-1}}},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="æ¥ç¬¬ä¸€å›ä¸ç¬¬äºŒå›.">
<meta property="og:type" content="article">
<meta property="og:title" content="å…³äºdataçš„ç¬”è®° - Week3">
<meta property="og:url" content="https://mazui3.com/blog/2021/03/14/P170/index.html">
<meta property="og:site_name" content="Underlake Reading Room">
<meta property="og:description" content="æ¥ç¬¬ä¸€å›ä¸ç¬¬äºŒå›.">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-03-14T05:01:54.000Z">
<meta property="article:modified_time" content="2021-08-19T23:13:15.762Z">
<meta property="article:author" content="Mazui">
<meta property="article:tag" content="ç¼–ç ">
<meta property="article:tag" content="ä»¥å¤´æŠ¢åœ°(è¯š)">
<meta property="article:tag" content="data">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://mazui3.com/blog/2021/03/14/P170/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>å…³äºdataçš„ç¬”è®° - Week3 | Underlake Reading Room</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

  <!--<script type="text/javascript" src="/js/my_js/clicklove.js"></script>-->

<link rel="alternate" href="/blog/atom.xml" title="Underlake Reading Room" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Underlake Reading Room</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">è¿™é‡Œæ˜¯å›¾ä¹¦é¦†å¤–çš„é˜…è§ˆå®¤ğŸŒŸ</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-readme">

    <a href="/blog/about/" rel="section"><i class="fa fa-user fa-fw"></i>ReadMe</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/blog/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/blog/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Schedule</a>

  </li>
        <li class="menu-item menu-item-friendlink">

    <a href="/blog/link/" rel="section"><i class="fas fa-user-friends fa-fw"></i>FriendLink</a>

  </li>
        <li class="menu-item menu-item-back">

    <a href="https://www.mazui3.com/" rel="noopener" target="_blank"><i class="fas fa-carrot fa-fw"></i>Back</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>



    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://mazui3.com/blog/2021/03/14/P170/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/logo_4.jpg">
      <meta itemprop="name" content="Mazui">
      <meta itemprop="description" content="ä¸å­¤ç‹¬å’Œå¹³å…±å¤„.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Underlake Reading Room">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          å…³äºdataçš„ç¬”è®° - Week3
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-03-14 00:01:54" itemprop="dateCreated datePublished" datetime="2021-03-14T00:01:54-05:00">2021-03-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-08-19 19:13:15" itemprop="dateModified" datetime="2021-08-19T19:13:15-04:00">2021-08-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E6%95%B0%E5%AD%A6%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">æ•°å­¦ç¬”è®°</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/blog/2021/03/14/P170/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021/03/14/P170/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>12k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>11 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>æ¥<a target="_blank" rel="noopener" href="https://mazui3.github.io/blog/2020/11/28/P140/">ç¬¬ä¸€å›</a>ä¸<a target="_blank" rel="noopener" href="https://mazui3.github.io/blog/2020/11/28/P141/">ç¬¬äºŒå›.</a><br><a id="more"></a><br>Note:<br>å‰ä¸¤å›å¤§å¤šæ˜¯pythonå’Œå…¶pandaså’Œnumpyåº“çš„ç¼–ç ç¬”è®°.<br>ç¬¬ä¸€å›é™„åŠ äº†å®‰è£…jupyter notebookçš„è¿‡ç¨‹,ç¬¬äºŒå›å¢åŠ äº†DAçš„è¿‡ç¨‹.</p>
<p><br><br><br><br><br><br><br></p>
<p>ç¬”è®°æœ‰å°‘è®¸é‡å¤,ä»…è®°è½½å¸¸ç”¨code,ä»¥å‰è®°å½•è¿‡çš„functionä¹Ÿæœ‰åœ¨æ—§ç¬”è®°ä¸­è¡¥å…….</p>
<p><strong>data wrangling</strong></p>
<h3 id="gather"><a href="#gather" class="headerlink" title="gather"></a>gather</h3><p>ä¸¾ä¾‹:<br>åœ¨rottenTomatoesä¸Šä¸‹è½½ç”µå½±è¯„ä»·.<a target="_blank" rel="noopener" href="https://www.rottentomatoes.com/top/bestofrt/">link</a><br>åœ¨æŸä½å½±è¯„äººç½‘ç«™ä¸Šä¸‹è½½è¯„ä»·.<a target="_blank" rel="noopener" href="https://www.rogerebert.com/">link</a><br>Word cloud æ’ä»¶.<a target="_blank" rel="noopener" href="https://amueller.github.io/word_cloud/">link</a></p>
<p>Flat File Structure.ä¸€ç§æ–‡ä»¶æ ¼å¼:Flat files contain tabular data in plain text format with one data record per line and each record or line having one or more fields. These fields are separated by delimiters, like commas, tabs, or colons.</p>
<p>å¦‚æœæ•°æ®ç”¨commaåˆ†å‰²å°±æ˜¯csv,ç”¨tabæ˜¯tsv.<br>æ˜¯äººèƒ½è¯»å¾—æ‡‚çš„.<br>æ³¨:excelå¹¶ä¸æ˜¯,excelçš„æºæ–‡ä»¶æ˜¯äººè¯»ä¸æ‡‚çš„.</p>
<p>ä¹Ÿå¯ä»¥ç”¨read_csvæ¥read tsv.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&quot;bestofrt.tsv&quot;</span>, sep=<span class="string">&#x27;\t&#x27;</span>)</span><br></pre></td></tr></table></figure></p>
<p><br><br><br><br><br></p>
<h4 id="web-scraping"><a href="#web-scraping" class="headerlink" title="web scraping"></a>web scraping</h4><p>æ³¨:æˆ‘ä»¬ä½¿ç”¨äº†os libraryæ¥è¯»å–æ–‡ä»¶å’Œå­˜å‚¨.è¯»å–ä¹Ÿå¯ä»¥ä½¿ç”¨ glob library.</p>
<h5 id="request"><a href="#request" class="headerlink" title="request"></a>request</h5><p>ç”¨request library make http request.<a target="_blank" rel="noopener" href="https://2.python-requests.org/en/master/">link.</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># Make directory if it doesn&#x27;t already exist</span></span><br><span class="line">folder_name = <span class="string">&#x27;theFolderName&#x27;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(folder_name):</span><br><span class="line">    os.makedirs(folder_name)</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;the_adress&#x27;</span></span><br><span class="line">response = requests.get(url)</span><br></pre></td></tr></table></figure>
<p>responseæ˜¯200å°±æ˜¯æˆåŠŸçš„æ„æ€.<br>ç°åœ¨ä¸œè¥¿åœ¨responseé‡Œ,å°†å…¶å¯¼å‡º.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(os.path.join(folder_name,</span><br><span class="line">                        url.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">-1</span>]), mode=<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(response.content)</span><br></pre></td></tr></table></figure></p>
<p>check content.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.listdir(folder_name)</span><br></pre></td></tr></table></figure></p>
<p><br><br><br><br><br></p>
<h5 id="glob"><a href="#glob" class="headerlink" title="glob"></a>glob</h5><p>ç”¨globè¯»å–ç±»ä¼¼txtçš„æ–‡ä»¶.</p>
<p>ç”¨glob.globè¯»å–ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„å†…å®¹.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># List of dictionaries to build file by file and later convert to a DataFrame</span></span><br><span class="line">df_list = []</span><br><span class="line"><span class="keyword">for</span> ebert_review <span class="keyword">in</span> glob.glob(<span class="string">&#x27;ebert_reviews/*.txt&#x27;</span>):</span><br><span class="line">    <span class="keyword">with</span> open(ebert_review, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file: <span class="comment"># æ³¨æ„è¿™é‡Œçš„encodingéœ€è¦åœ¨åŸç½‘é¡µæ–‡ä»¶ä¸‹æŸ¥çœ‹</span></span><br><span class="line">        title = file.readline()[:<span class="number">-1</span>] <span class="comment"># readlineæ¥å–ä¸€è¡Œä¸€è¡Œçš„å†…å®¹,æœ€åçš„-1æ˜¯ç”¨äºå‡å»newline characterçš„</span></span><br><span class="line">        review_url = file.readline()[:<span class="number">-1</span>]</span><br><span class="line">        review_text = file.read()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Append to list of dictionaries</span></span><br><span class="line">        df_list.append(&#123;<span class="string">&#x27;title&#x27;</span>: title,</span><br><span class="line">                        <span class="string">&#x27;review_url&#x27;</span>: review_url,</span><br><span class="line">                        <span class="string">&#x27;review_text&#x27;</span>: review_text&#125;)</span><br><span class="line">df = pd.DataFrame(df_list, columns = [<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;review_url&#x27;</span>, <span class="string">&#x27;review_text&#x27;</span>]) <span class="comment"># æœ€åè½¬æˆdf</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p><br><br><br><br><br></p>
<h5 id="beautiful-soap"><a href="#beautiful-soap" class="headerlink" title="beautiful soap"></a>beautiful soap</h5><p>é¦–å…ˆå…ˆdownloadä¸€ä¸ªhtmlæ–‡ä»¶.ç”¨beautiful soapæ¥æŠ“data.<a target="_blank" rel="noopener" href="https://www.crummy.com/software/BeautifulSoup/">link.</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">&#x27;fileName.html&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">  soup = BeautifulSoup(file, <span class="string">&#x27;lxml&#x27;</span>) <span class="comment"># first we make a soup</span></span><br><span class="line">  <span class="comment"># in the soup we have everything in the html file without clean</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç„¶åç”¨findæ¥å¯»æ‰¾æŸä¸ªæˆ‘ä»¬æƒ³è¦çš„tagå†…çš„å†…å®¹.</span></span><br><span class="line">soup.find(<span class="string">&#x27;title&#x27;</span>)</span><br><span class="line"><span class="comment"># return everything with tag title</span></span><br><span class="line">soup.find(<span class="string">&#x27;title&#x27;</span>).content[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># returnç¬¬ä¸€ä¸ªåœ¨title tagå†…çš„å†…å®¹.</span></span><br><span class="line">soup.find(<span class="string">&#x27;title&#x27;</span>).content[<span class="number">0</span>][:-len(<span class="string">&#x27; the thing wanna delete&#x27;</span>)]</span><br><span class="line"><span class="comment"># è¿›è¡Œstringçš„åˆ å‡.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ä»¥ç”¨tagå’Œclassä¸€èµ·æ‰¾.è¿™ä¸ªä¾‹å­æ˜¯åœ¨(æœ‰classçš„)divé‡Œçš„span tag.</span></span><br><span class="line">soup.find(<span class="string">&#x27;div&#x27;</span>,class_=<span class="string">&#x27;className&#x27;</span>).find(<span class="string">&#x27;span&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>å‡å»white spaceç”¨strip.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;string&#x27;</span>.strip()</span><br></pre></td></tr></table></figure><br>ç”¨replaceå‡å»100,000ä¸­çš„comma.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;string&#x27;</span>.replace(<span class="string">&#x27;,&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># List of dictionaries to build file by file and later convert to a DataFrame</span></span><br><span class="line">    df_list = []</span><br><span class="line">    folder = <span class="string">&#x27;rt_html&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> movie_html <span class="keyword">in</span> os.listdir(folder):</span><br><span class="line">        <span class="keyword">with</span> open(os.path.join(folder, movie_html)) <span class="keyword">as</span> file:</span><br><span class="line">            soup = BeautifulSoup(file, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">            title = soup.find(<span class="string">&#x27;title&#x27;</span>).contents[<span class="number">0</span>][:-len(<span class="string">&#x27; - Rotten rottenTomatoes&#x27;</span>)]</span><br><span class="line">            audience_score = soup.find(<span class="string">&#x27;div&#x27;</span>, class_=<span class="string">&#x27;audience-score meter&#x27;</span>).find(<span class="string">&#x27;span&#x27;</span>).contents[<span class="number">0</span>][:<span class="number">-1</span>]</span><br><span class="line">            num_audience_ratings = soup.find(<span class="string">&#x27;div&#x27;</span>, class_=<span class="string">&#x27;audience-info hidden-xs superPageFontColor&#x27;</span>)</span><br><span class="line">            num_audience_ratings = num_audience_ratings.find_all(<span class="string">&#x27;div&#x27;</span>)[<span class="number">1</span>].contents[<span class="number">2</span>].strip().replace(<span class="string">&#x27;,&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="comment"># Append to list of dictionaries</span></span><br><span class="line">            df_list.append(&#123;<span class="string">&#x27;title&#x27;</span>: title,</span><br><span class="line">                            <span class="string">&#x27;audience_score&#x27;</span>: int(audience_score),</span><br><span class="line">                            <span class="string">&#x27;number_of_audience_ratings&#x27;</span>: int(num_audience_ratings)&#125;)</span><br><span class="line">    df = pd.DataFrame(df_list, columns = [<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;audience_score&#x27;</span>, <span class="string">&#x27;number_of_audience_ratings&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h5 id="api"><a href="#api" class="headerlink" title="api"></a>api</h5><p>æœ€æ–¹ä¾¿çš„åŠæ³•.<br>(æˆ‘ç†è§£apiä¸ºæ¥å£,åƒusbæ¥å£é‚£æ ·.)</p>
<p>ç”¨mediaWikiä¸¾ä¾‹.<a target="_blank" rel="noopener" href="https://www.mediawiki.org/wiki/API:Tutorial">link.</a><a target="_blank" rel="noopener" href="https://github.com/siznax/wptools">link.</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> wptools</span><br><span class="line"><span class="comment"># https://en.wikipedia.org/wiki/Mahatma_Gandhi</span></span><br><span class="line"></span><br><span class="line">page = wptools.page(<span class="string">&#x27;Mahatma_Gandhi&#x27;</span>).get()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ä¸­pageè‡ªå¸¦å¾ˆå¤šattribute,å¯ä»¥ç”¨å…¶ä¸­çš„imageæ¥æ‰¾wiki pageä¸Šçš„image</span></span><br><span class="line">page.data[<span class="string">&#x27;image&#x27;</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Note:å…³äºæ•°æ®çš„å‚¨å­˜,è¿˜å¯èƒ½æ˜¯json.Jsonç±»ä¼¼pythoné‡Œçš„list.<br>æ¯”å¦‚è¯´ä¹‹å‰çš„page objectä¸­å­˜æ”¾çš„å°±æ˜¯jsonçš„æ ¼å¼.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.data[<span class="string">&#x27;image&#x27;</span>][<span class="number">0</span>] <span class="comment"># access first image</span></span><br></pre></td></tr></table></figure><br>æ›´å¤šå…³äºjsonä¸pythonçš„<a target="_blank" rel="noopener" href="https://stackabuse.com/reading-and-writing-json-to-a-file-in-python/">link.</a></p>
<p>æ³¨:downloadæ–‡ä»¶æ—¶,å¦‚æœæ˜¯æ–‡å­—,è¦ç¡®è®¤encodeæ–¹å¼(eg.utf-8).<br>å¦‚æœæ˜¯å›¾ç‰‡è¦æ³¨æ„libraryçš„ä½¿ç”¨,æœ‰äº›å¯èƒ½ä¼šå‡ºé”™.<a target="_blank" rel="noopener" href="https://pillow.readthedocs.io/en/stable/">link</a><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line">r = requests.get(url)</span><br><span class="line">i = Image.open(BytesIO(r.content))</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># List of dictionaries to build and convert to a DataFrame later</span></span><br><span class="line">df_list = []</span><br><span class="line">image_errors = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> title <span class="keyword">in</span> title_list: <span class="comment"># title listæ˜¯è‡ªå·±åˆ›é€ å¥½çš„ä¸€ä¸ªlist of string</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># This cell is slow so print ranking to gauge time remaining</span></span><br><span class="line">        ranking = title_list.index(title) + <span class="number">1</span></span><br><span class="line">        print(ranking)</span><br><span class="line">        page = wptools.page(title, silent=<span class="literal">True</span>)</span><br><span class="line">        images = page.get().data[<span class="string">&#x27;image&#x27;</span>]</span><br><span class="line">        <span class="comment"># First image is usually the poster</span></span><br><span class="line">        first_image_url = images[<span class="number">0</span>][<span class="string">&#x27;url&#x27;</span>]</span><br><span class="line">        r = requests.get(first_image_url)</span><br><span class="line">        <span class="comment"># Download movie poster image</span></span><br><span class="line">        i = Image.open(BytesIO(r.content))</span><br><span class="line">        image_file_format = first_image_url.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">-1</span>]</span><br><span class="line">        i.save(folder_name + <span class="string">&quot;/&quot;</span> + str(ranking) + <span class="string">&quot;_&quot;</span> + title + <span class="string">&#x27;.&#x27;</span> + image_file_format)</span><br><span class="line">        <span class="comment"># Append to list of dictionaries</span></span><br><span class="line">        df_list.append(&#123;<span class="string">&#x27;ranking&#x27;</span>: int(ranking),</span><br><span class="line">                        <span class="string">&#x27;title&#x27;</span>: title,</span><br><span class="line">                        <span class="string">&#x27;poster_url&#x27;</span>: first_image_url&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Not best practice to catch all exceptions but fine for this short script</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(str(ranking) + <span class="string">&quot;_&quot;</span> + title + <span class="string">&quot;: &quot;</span> + str(e))</span><br><span class="line">        image_errors[str(ranking) + <span class="string">&quot;_&quot;</span> + title] = images</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨tryä¿æŠ¤,æœ€åæŸ¥çœ‹å‡ºé”™çš„å›¾ç‰‡</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> image_errors.keys():</span><br><span class="line">    print(key)</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<p>å…ˆç”¨terminal accessåˆ°æƒ³è¦ä¿å­˜æ–‡ä»¶çš„directory.<br>å†run:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jupyter notebook</span><br></pre></td></tr></table></figure><br>åœ¨ç•Œé¢é‡Œå¯ä»¥ç›´æ¥newåˆ›å»ºæ–‡ä»¶.<br>Note:ç”¨shift tabå¯ä»¥è¯»å–functionçš„æ ¼å¼å¤‡æ³¨.</p>
<p>zip file,<a target="_blank" rel="noopener" href="https://docs.python.org/3/library/zipfile.html#zipfile-objects">doc</a>:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="comment"># Extract all contents from zip file</span></span><br><span class="line"><span class="keyword">with</span> zipfile.ZipFile(<span class="string">&#x27;archive.zip&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> myzip:</span><br><span class="line">    myzip.extractall()</span><br></pre></td></tr></table></figure></p>
<p>å°†æ–‡ä»¶ä¿å­˜å¥½åå¯ä»¥å­˜æ”¾åˆ°fileä¸­æˆ–database.<br>(file:æ¯”å¦‚è¯´csv,database:æ¯”å¦‚è¯´å¯ä»¥ç”¨sqlè¯»çš„.)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.to_csv(<span class="string">&#x27;dataset.csv&#x27;</span>, index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥åœ¨pythonä¸­è¿ä¸Šsql.<a target="_blank" rel="noopener" href="https://www.sqlalchemy.org/">link.</a><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine</span><br><span class="line"><span class="comment"># Create SQLAlchemy Engine and empty bestofrt database</span></span><br><span class="line"><span class="comment"># bestofrt.db will not show up in the Jupyter Notebook dashboard yet</span></span><br><span class="line">engine = create_engine(<span class="string">&#x27;sqlite:///bestofrt.db&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Store cleaned master DataFrame (&#x27;df&#x27;) in a table called master in bestofrt.db</span></span><br><span class="line"><span class="comment"># bestofrt.db will be visible now in the Jupyter Notebook dashboard</span></span><br><span class="line">df.to_sql(<span class="string">&#x27;master&#x27;</span>, engine, index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure></p>
<h3 id="assess"><a href="#assess" class="headerlink" title="assess"></a>assess</h3><p>Focus on quality and tidiness.ç›®çš„æ˜¯äº†è§£å’Œå¯»æ‰¾å·®é”™.</p>
<p>Dirty: æ•°æ®æœ¬èº«æœ‰é—®é¢˜.å®Œæ•´æ€§(ç¼ºå¤±),é‡å¤,ç²¾å‡†,å‡ºé”™(æ•°æ®å•ä½ä¸ä¸€è‡´),ä¸€è‡´æ€§ç­‰.<br>Messy: æœ‰structureçš„é—®é¢˜.</p>
<p>ç”¨isnull checkç©ºç¼º.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum(df.columnName.isnull())</span><br></pre></td></tr></table></figure></p>
<p>åœ¨è¿™ä¸€æ­¥è®°è½½æ•°æ®çš„é—®é¢˜æ–¹ä¾¿åé¢æ›´æ”¹.</p>
<p>æ™®é€šçš„è¯»å–ç”¨indexæŸä¸€rowsçš„æ•°æ®.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">second_row = df.loc[[<span class="number">1</span>]]</span><br></pre></td></tr></table></figure><br><a target="_blank" rel="noopener" href="https://www.kite.com/python/answers/how-to-print-a-row-of-a-pandas-dataframe-in-python">link</a></p>
<p>check uniqueness.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df_1.nunique()</span><br><span class="line">df_1.shape</span><br></pre></td></tr></table></figure></p>
<p>check duplicate.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">duplicateRowsDF = df_1[df_1.duplicated([<span class="string">&#x27;tweet_id&#x27;</span>])]</span><br><span class="line">print(duplicateRowsDF)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_2.describe()</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h3 id="clean"><a href="#clean" class="headerlink" title="clean"></a>clean</h3><p>ç¬¬ä¸€ä»¶äº‹æ˜¯make a copy.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_clean = df.copy()</span><br></pre></td></tr></table></figure></p>
<h4 id="define"><a href="#define" class="headerlink" title="define"></a>define</h4><p>åœ¨è¿™ä¸€æ­¥è®°è½½å“ªäº›æ˜¯è¦cleançš„é—®é¢˜.ç”¨åŠ¨è¯å†™å‡ºè¦åšçš„æ­¥éª¤.</p>
<h4 id="code"><a href="#code" class="headerlink" title="code"></a>code</h4><p>codeæ›´å¤šç¿»æ‰¾ä¸Šä¸¤å›çš„ç¬”è®°.</p>
<p>string slicing.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;columnName&#x27;</span>].str[<span class="number">2</span>:]</span><br></pre></td></tr></table></figure></p>
<p>string replacing.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;columnName&#x27;</span>].str.replace(<span class="string">&#x27;oldValue&#x27;</span>,<span class="string">&#x27;newValue&#x27;</span>)</span><br></pre></td></tr></table></figure></p>
<p>columnçš„åå­—æ˜¯åº”å½“è®°è½½çš„å€¼.ç”¨melt.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">treatments_clean = pd.melt(treatments_clean, id_vars=[<span class="string">&#x27;given_name&#x27;</span>, <span class="string">&#x27;surname&#x27;</span>, <span class="string">&#x27;hba1c_start&#x27;</span>, <span class="string">&#x27;hba1c_end&#x27;</span>, <span class="string">&#x27;hba1c_change&#x27;</span>],</span><br><span class="line">                           var_name=<span class="string">&#x27;treatment&#x27;</span>, value_name=<span class="string">&#x27;dose&#x27;</span>)</span><br><span class="line">treatments_clean = treatments_clean[treatments_clean.dose != <span class="string">&quot;-&quot;</span>]</span><br><span class="line">treatments_clean[<span class="string">&#x27;dose_start&#x27;</span>], treatments_clean[<span class="string">&#x27;dose_end&#x27;</span>] = treatments_clean[<span class="string">&#x27;dose&#x27;</span>].str.split(<span class="string">&#x27; - &#x27;</span>, <span class="number">1</span>).str</span><br><span class="line">treatments_clean = treatments_clean.drop(<span class="string">&#x27;dose&#x27;</span>, axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">treatments_clean = pd.merge(treatments_clean, adverse_reactions_clean,</span><br><span class="line">                            on=[<span class="string">&#x27;given_name&#x27;</span>, <span class="string">&#x27;surname&#x27;</span>], how=<span class="string">&#x27;left&#x27;</span>)</span><br></pre></td></tr></table></figure><br><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/50607740/reverse-a-get-dummies-encoding-in-pandas">stackoverflow</a>é‡Œçš„ä¾‹å­.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;ID&#x27;</span>:&#123;<span class="number">0</span>:<span class="string">&#x27;0&#x27;</span>,<span class="number">1</span>:<span class="string">&#x27;1&#x27;</span>,<span class="number">2</span>:<span class="string">&#x27;2&#x27;</span>&#125;,</span><br><span class="line">                   <span class="string">&#x27;A&#x27;</span>: &#123;<span class="number">0</span>: <span class="number">0</span>, <span class="number">1</span>: <span class="number">1</span>, <span class="number">2</span>: <span class="number">0</span>&#125;,</span><br><span class="line">                   <span class="string">&#x27;B&#x27;</span>: &#123;<span class="number">0</span>: <span class="number">1</span>, <span class="number">1</span>: <span class="number">0</span>, <span class="number">2</span>: <span class="number">0</span>&#125;,</span><br><span class="line">                   <span class="string">&#x27;C&#x27;</span>: &#123;<span class="number">0</span>: <span class="number">0</span>, <span class="number">1</span>: <span class="number">0</span>, <span class="number">2</span>: <span class="number">1</span>&#125;&#125;)</span><br><span class="line">df = (df.melt(<span class="string">&#x27;ID&#x27;</span>, var_name=<span class="string">&#x27;Col2&#x27;</span>)</span><br><span class="line">        .query(<span class="string">&#x27;value== 1&#x27;</span>)</span><br><span class="line">        .sort_values([<span class="string">&#x27;ID&#x27;</span>, <span class="string">&#x27;Col2&#x27;</span>])</span><br><span class="line">        .drop(<span class="string">&#x27;value&#x27;</span>,<span class="number">1</span>))</span><br></pre></td></tr></table></figure><br><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/26886653/pandas-create-new-column-based-on-values-from-other-columns-apply-a-function-o">stackoverflow</a>ç”¨lambdaè‡ªå®šä¹‰functinoçš„æ–¹æ³•.</p>
<p>åè¿‡æ¥å¯ä»¥ç”¨get_dummies.</p>
<p>å°†emailå’Œç”µè¯å·ç åˆ†æˆä¸¤ä¸ªcolumn.ç”¨extract.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">patients_clean[<span class="string">&#x27;phone_number&#x27;</span>] = patients_clean.contact.str.extract(<span class="string">&#x27;((?:\+\d&#123;1,2&#125;\s)?\(?\d&#123;3&#125;\)?[\s.-]?\d&#123;3&#125;[\s.-]?\d&#123;4&#125;)&#x27;</span>, expand=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [a-zA-Z] to signify emails in this dataset all start and end with letters</span></span><br><span class="line">patients_clean[<span class="string">&#x27;email&#x27;</span>] = patients_clean.contact.str.extract(<span class="string">&#x27;([a-zA-Z][a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])&#x27;</span>, expand=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Note: axis=1 denotes that we are referring to a column, not a row</span></span><br><span class="line">patients_clean = patients_clean.drop(<span class="string">&#x27;contact&#x27;</span>, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure></p>
<p>å¤§å°å†™è½¬æ¢.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.columnName = df.columnName.str.lower()</span><br></pre></td></tr></table></figure></p>
<p><br><br><br><br><br></p>
<p>ç”¨renameæ›´æ”¹columnåå­—.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df_clean = df_clean.rename(columns=&#123;<span class="string">&#x27;oldName1&#x27;</span>: <span class="string">&#x27;newName1&#x27;</span>,</span><br><span class="line">                                    <span class="string">&#x27;oldName2&#x27;</span>: <span class="string">&#x27;newName2&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨value_countså¿«é€Ÿäº†è§£columnå†…çš„æ•°å€¼åˆ†å¸ƒ.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.columnName.value_counts()</span><br></pre></td></tr></table></figure></p>
<p>æ›´æ”¹columnå†…çš„æ•°å€¼:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">list = [<span class="string">&#x27;valueWannaReplace&#x27;</span>,<span class="string">&#x27;valueWannaReplace&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> value <span class="keyword">in</span> asap_list:</span><br><span class="line">    df_clean.StartDate.replace( value ,<span class="string">&#x27;newValue&#x27;</span>, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><br>é™„<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/21608228/conditional-replace-pandas">stackoverflow</a>é‡Œçš„ä¾‹å­.</p>
<p>é€‰ä¸­å¤šåˆ—å¹¶æ›´æ”¹çš„æƒ…å†µ.<br>(isinæ˜¯ç”¨valueåˆ¤å®šçš„)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[df[<span class="string">&#x27;A&#x27;</span>].isin([<span class="number">3</span>, <span class="number">6</span>])] <span class="comment"># é€‰ä¸­A columné‡Œæœ‰3å’Œ6çš„row</span></span><br></pre></td></tr></table></figure><br>ä½¿ç”¨index.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_1[df_1.index.isin([<span class="number">231</span>,<span class="number">837</span>,<span class="number">885</span>,<span class="number">1480</span>])] <span class="comment"># æŠŠdf[&#x27;columnName&#x27;]æ”¹æˆindex</span></span><br></pre></td></tr></table></figure><br><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/12096252/use-a-list-of-values-to-select-rows-from-a-pandas-dataframe">stackoverflow</a>.</p>
<p>ç”¨assertæ¥testæ¡ä»¶.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> value <span class="keyword">in</span> asap_list:</span><br><span class="line">    <span class="keyword">assert</span> value <span class="keyword">not</span> <span class="keyword">in</span> df_clean.StartDate.values</span><br></pre></td></tr></table></figure></p>
<p>merge.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">treatments_clean = pd.merge(treatments_clean, adverse_reactions_clean,</span><br><span class="line">                            on=[<span class="string">&#x27;given_name&#x27;</span>, <span class="string">&#x27;surname&#x27;</span>], how=<span class="string">&#x27;left&#x27;</span>)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Mapping from full state name to abbreviation</span></span><br><span class="line">state_abbrev = &#123;<span class="string">&#x27;California&#x27;</span>: <span class="string">&#x27;CA&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;New York&#x27;</span>: <span class="string">&#x27;NY&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Illinois&#x27;</span>: <span class="string">&#x27;IL&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Florida&#x27;</span>: <span class="string">&#x27;FL&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Nebraska&#x27;</span>: <span class="string">&#x27;NE&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Function to apply</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">abbreviate_state</span>(<span class="params">patient</span>):</span></span><br><span class="line">    <span class="keyword">if</span> patient[<span class="string">&#x27;state&#x27;</span>] <span class="keyword">in</span> state_abbrev.keys():</span><br><span class="line">        abbrev = state_abbrev[patient[<span class="string">&#x27;state&#x27;</span>]]</span><br><span class="line">        <span class="keyword">return</span> abbrev</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> patient[<span class="string">&#x27;state&#x27;</span>]</span><br><span class="line"></span><br><span class="line">patients_clean[<span class="string">&#x27;state&#x27;</span>] = patients_clean.apply(abbreviate_state, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>æ•°æ®ç±»å‹è½¬å˜.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># To category</span></span><br><span class="line">patients_clean.assigned_sex = patients_clean.assigned_sex.astype(<span class="string">&#x27;category&#x27;</span>)</span><br><span class="line">patients_clean.state = patients_clean.state.astype(<span class="string">&#x27;category&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># To datetime</span></span><br><span class="line">patients_clean.birthdate = pd.to_datetime(patients_clean.birthdate)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Strip u and to integer</span></span><br><span class="line">treatments_clean.dose_start = treatments_clean.dose_start.str.strip(<span class="string">&#x27;u&#x27;</span>).astype(int)</span><br><span class="line">treatments_clean.dose_end = treatments_clean.dose_end.str.strip(<span class="string">&#x27;u&#x27;</span>).astype(int)</span><br></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨padå¡«å……string.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Strip all &quot; &quot;, &quot;-&quot;, &quot;(&quot;, &quot;)&quot;, and &quot;+&quot; and store each number without any formatting. Pad the phone number with a 1 if the length of the number is 10 digits (we want country code).</span></span><br><span class="line">patients_clean.phone_number = patients_clean.phone_number.str.replace(<span class="string">r&#x27;\D+&#x27;</span>, <span class="string">&#x27;&#x27;</span>).str.pad(<span class="number">11</span>, fillchar=<span class="string">&#x27;1&#x27;</span>)</span><br></pre></td></tr></table></figure></p>
<p>remove some data.ç”¨ä¸ç­‰äºå°±è¡Œ.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">patients_clean = patients_clean[patients_clean.surname != <span class="string">&#x27;Doe&#x27;</span>]</span><br></pre></td></tr></table></figure></p>
<p><br><br><br><br><br></p>
<h4 id="test"><a href="#test" class="headerlink" title="test"></a>test</h4><p>checké‡å¤.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Patient ID should be the only duplicate column</span></span><br><span class="line">all_columns = pd.Series(list(patients_clean) + list(treatments_clean)) <span class="comment"># patients_cleanæ˜¯df.</span></span><br><span class="line">all_columns[all_columns.duplicated()]</span><br></pre></td></tr></table></figure><br><a target="_blank" rel="noopener" href="https://thispointer.com/pandas-find-duplicate-rows-in-a-dataframe-based-on-all-or-selected-columns-using-dataframe-duplicated-in-python/">Link</a>.</p>
<p>checkæ‰€æœ‰æœ‰nullçš„row.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">patients[patients[<span class="string">&#x27;address&#x27;</span>].isnull()]</span><br><span class="line">all_columns[all_columns.duplicated()]</span><br></pre></td></tr></table></figure></p>
<h4 id="analysis-and-visualization"><a href="#analysis-and-visualization" class="headerlink" title="analysis and visualization"></a>analysis and visualization</h4><p>ä»¥å‰çš„ç¬”è®°è®°è½½çš„æ›´å¤š.</p>
<p>æ¯”å¦‚è¯´ç”¨value_counts()æ¥ç”»pie chart.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_clean.StartDate.value_counts().plot(kind=<span class="string">&quot;pie&quot;</span>)</span><br></pre></td></tr></table></figure></p>
<p><br><br><br><br><br></p>
<blockquote>
<p>é™„å½•:read and write files with python</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿™é‡Œçš„fæ˜¯ä¸€ä¸ªpython file,ræ˜¯read only</span></span><br><span class="line">f = open(<span class="string">&#x27;my_path/my_file.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="comment"># è¿™é‡Œçš„file_dataæ˜¯ä¸€ä¸ªstring</span></span><br><span class="line">file_data = f.read()</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wæ˜¯write.å¦‚æœmy_file.txtä¸å­˜åœ¨,ä¼šåˆ›é€ ä¸€ä¸ªæ–°çš„</span></span><br><span class="line">f = open(<span class="string">&#x27;my_path/my_file.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(<span class="string">&quot;Hello there!&quot;</span>)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p>withå¯ä»¥è‡ªå¸¦å…³é—­file.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">&#x27;my_path/my_file.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    file_data = f.read()</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f.readline() <span class="comment"># reads a single line from the file;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_cast_list</span>(<span class="params">filename</span>):</span></span><br><span class="line">    cast_list = []</span><br><span class="line">    <span class="keyword">with</span> open(filename) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">            name = line.split(<span class="string">&quot;,&quot;</span>)[<span class="number">0</span>]</span><br><span class="line">            cast_list.append(name)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cast_list</span><br><span class="line"></span><br><span class="line">cast_list = create_cast_list(<span class="string">&#x27;flying_circus_cast.txt&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> actor <span class="keyword">in</span> cast_list:</span><br><span class="line">    print(actor)</span><br></pre></td></tr></table></figure>

    </div>

    
    
    
      
  <div class="popular-posts-header">ç›¸å…³åšæ–‡</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/blog/2020/11/28/P141/" rel="bookmark">å…³äºdataçš„ç¬”è®° - Week2</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/blog/2020/11/28/P140/" rel="bookmark">å…³äºdataçš„ç¬”è®° - Week1</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/blog/2021/05/04/P193/" rel="bookmark">å…³äºdataçš„ç¬”è®° - Week4</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/blog/2021/01/18/P163/" rel="bookmark">å…³äºRè¯­è¨€çš„ç¬”è®° - R markdown</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/blog/2021/01/13/P164/" rel="bookmark">å…³äºRè¯­è¨€çš„ç¬”è®°</a></div>
    </li>
  </ul>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/blog/tags/%E7%BC%96%E7%A0%81/" rel="tag"># ç¼–ç </a>
              <a href="/blog/tags/%E4%BB%A5%E5%A4%B4%E6%8A%A2%E5%9C%B0-%E8%AF%9A/" rel="tag"># ä»¥å¤´æŠ¢åœ°(è¯š)</a>
              <a href="/blog/tags/data/" rel="tag"># data</a>
              <a href="/blog/tags/python/" rel="tag"># python</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/blog/2021/03/14/P176/" rel="prev" title="å…³äºbashçš„ç¬”è®° - ç®€é™‹ç‰ˆ">
      <i class="fa fa-chevron-left"></i> å…³äºbashçš„ç¬”è®° - ç®€é™‹ç‰ˆ
    </a></div>
      <div class="post-nav-item">
    <a href="/blog/2021/02/26/P173/" rel="next" title="å¥½ä½œå“è¡¥å…¨è®¡åˆ’ - é“¶ä¹‹åŒ™">
      å¥½ä½œå“è¡¥å…¨è®¡åˆ’ - é“¶ä¹‹åŒ™ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">


      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>



      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#gather"><span class="nav-number">1.</span> <span class="nav-text">gather</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#web-scraping"><span class="nav-number">1.1.</span> <span class="nav-text">web scraping</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#request"><span class="nav-number">1.1.1.</span> <span class="nav-text">request</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#glob"><span class="nav-number">1.1.2.</span> <span class="nav-text">glob</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#beautiful-soap"><span class="nav-number">1.1.3.</span> <span class="nav-text">beautiful soap</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#api"><span class="nav-number">1.1.4.</span> <span class="nav-text">api</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#assess"><span class="nav-number">2.</span> <span class="nav-text">assess</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#clean"><span class="nav-number">3.</span> <span class="nav-text">clean</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#define"><span class="nav-number">3.1.</span> <span class="nav-text">define</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#code"><span class="nav-number">3.2.</span> <span class="nav-text">code</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#test"><span class="nav-number">3.3.</span> <span class="nav-text">test</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#analysis-and-visualization"><span class="nav-number">3.4.</span> <span class="nav-text">analysis and visualization</span></a></li></ol></li></ol></div>


      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Mazui"
      src="/blog/images/logo_4.jpg">
  <p class="site-author-name" itemprop="name">Mazui</p>
  <div class="site-description" itemprop="description">ä¸å­¤ç‹¬å’Œå¹³å…±å¤„.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives/">
        
          <span class="site-state-item-count">199</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/blog/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/blog/tags/">
          
        <span class="site-state-item-count">41</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:mazui.and.rio@gmail.com" title="E-Mail â†’ mailto:mazui.and.rio@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/3032131561?topnav=1&wvr=6&topsug=1&ssl_rnd=1606158448.6943&is_all=1" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;3032131561?topnav&#x3D;1&amp;wvr&#x3D;6&amp;topsug&#x3D;1&amp;ssl_rnd&#x3D;1606158448.6943&amp;is_all&#x3D;1" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/mazui_3" title="Twitter â†’ https:&#x2F;&#x2F;twitter.com&#x2F;mazui_3" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://instagram.com/mazui_3" title="Instagram â†’ https:&#x2F;&#x2F;instagram.com&#x2F;mazui_3" rel="noopener" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
      </span>
  </div>



      </div>

      <br>
      <!--new music test-->

  <!--ç½‘æ˜“äº‘æ’ä»¶-->
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=465530020&auto=0&height=66"></iframe>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
      <script>
//æš‚æ—¶å‚¨å­˜æ–‡ç« ä¸­çš„å†…å®¹
var div = $('.post-body');
//æš‚æ—¶å‚¨å­˜ç›®å½•çš„å†…å®¹
var toc=$('.post-toc-wrap')
function password() {
  if(''){
  //å°†æ–‡ç« å†…å®¹åˆ é™¤
    div.remove();
 //å°†ç›®å½•åˆ é™¤
    toc.remove();
  //å°†æ–‡ç« åˆ é™¤åï¼Œå‘åŸæ¥æ–‡ç« çš„åœ°æ–¹æ·»åŠ ï¼Œåº”è¯¥å‡ºç°çš„æç¤ºç”¨æˆ·è¾“å…¥å¯†ç çš„æ ·å¼
  //ä¸‹é¢è¿™é‡Œçš„ç¬¬ä¸€ä¸ªç”¨textareaæ˜¯å› ä¸ºå¦‚æœåœ¨æ‰‹æœºç«¯çš„æ—¶å€™åªèƒ½æ˜¾ç¤ºä¸€éƒ¨åˆ†æ–‡å­—ï¼Œ
  //åªæ˜¯æ‹“å±•:inputé‡Œé¢çš„å­—åªèƒ½æ˜¾ç¤ºä¸€è¡Œï¼Œä¸ä¼šè‡ªåŠ¨æ¢è¡Œï¼Œç›®å‰ä¸Šç½‘æœç´¢æ²¡æœ‰å‘ç°å¥½çš„åŠæ³•ï¼Œæ‰€ä»¥ç”¨äº†textareaï¼Œå³ä¸‹è§’çš„å°ä¸‰è§’é€šè¿‡resize:none å»æ‰ã€‚
   $('.post-header').after('<textarea class="description" value="Please enter your password and press enter to build" style="border: none;display: block;' +'width: 60%;margin: 0 auto;text-align: center;outline: none;margin-bottom: 50px;resize:none ">
      Please enter your password and press enter to build</textarea>' +
      '<div class="qiang" style="height: 100px;width: 60%;margin:0 auto">' +
      '<input class="password"  type="text" value="" style="border: none;display: block;border-bottom: 1px solid #ccc;' +
      'margin: 0 auto;outline: none;width:95%"/>' +
      '</div>')
      //ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼Œå¦‚æœæ˜¯ç‚¹å‡»çš„.password è¿™ä¸ªdivå°±æ”¹å˜æ ·å¼ï¼Œå¦‚æœæ˜¯documentä¸­é™¤äº†divä¹‹å¤–çš„å…¶ä»–ä»»ä½•å…ƒç´ ï¼Œå°±å˜å›åŸæ¥çš„æ ·å¼ã€‚
    document.onclick = function (event) {
      var e = event || window.event;
      var elem = e.srcElement || e.target;

      while (elem) {
        if (elem != document) {
          if (elem.className == "password") {
            $(".password").animate({paddingTop:"30px",width:"100%",borderWidth:"2px"},300)
            return;
          }
          elem = elem.parentNode;
        } else {
          $(".password").animate({paddingTop:"0px",width:"95%",borderWidth:"1px"},300)
          return;
        }
      }
    }
    //ç»‘å®šenteré”®æŒ‰ä¸‹åç¦»å¼€çš„äº‹ä»¶
    $(document).keyup(function(event){
      if(event.keyCode ==13&&$('.password').length>0){
        //console.log($('.password').val())
        //console.log('')
        if ($('.password').val() == '') {
        //æ¢å¤æ–‡ç« å†…å®¹
          (div).appendTo($(".post-header"))
          //æ¢å¤ç›®å½•
          toc.appendTo($(".sidebar-inner"))
          //åˆ é™¤æœ¬é¡µé¢çš„è¾“å…¥å¯†ç ç»„ä»¶
           $(".description").remove();
          $(".qiang").remove();
          $(".password").remove();

          //é‡æ–°å¤„ç†pjaxäº‹ä»¶,å¦‚æœæ²¡æœ‰åŠ pjaxçš„ä»ä¸‹é¢è¿™è¡Œèµ·åˆ°ä¸‹é¢çš„elseä¹‹é—´çš„ä»£ç éœ€è¦å»æ‰ã€‚
          //å›¾ç‰‡æ‡’åŠ è½½ï¼Œæ²¡æœ‰åŠ å…¥æ­¤åŠŸèƒ½çš„è¿™ä¸ªå‡½æ•°éœ€è¦å»æ‰
	          $('img').lazyload({
	             placeholder: '/images/loading.gif',
	             effect: 'fadeIn',
	             threshold : 100,
	             failure_limit : 20,
	             skip_invisible : false
	           });
	           //pjaxåå‡ºç°æ–‡ç« ä¸æ˜¾ç¤ºï¼Œæ²¡æœ‰pjaxçš„ä¸‹é¢å››è¡Œéœ€è¦å»æ‰
	            $(".post-block").css({opacity:1});
	            $(".post-header").css({opacity:1});
	            $(".post-body").css({opacity:1});
	            $(".pagination").css({opacity:1});
        }else {
          alert("Sorry, the password is wrong.")
        }
      }
      //å°†documentçš„keyupç§»é™¤ï¼Œé˜²æ­¢åœ¨pjaxçš„æƒ…å†µä¸‹ä¼šé‡å¤ç»‘å®šäº‹ä»¶
    });
  }
}
password();
</script>

    </main>


    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2015 â€“ 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mazui</span>

<!--
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>


    <span title="Symbols count total">378k</span>
  -->

  <!--
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">5:44</span>

  -->
  
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>
<br>
<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">ä¼‘æ¯å®¤ä¸€å…±æœ‰378kçš„è€å…”æ­£åœ¨æ‰“çŒç¡</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/blog/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/blog/lib/velocity/velocity.min.js"></script>
  <script src="/blog/lib/velocity/velocity.ui.min.js"></script>

<script src="/blog/js/utils.js"></script>

<script src="/blog/js/motion.js"></script>


<script src="/blog/js/schemes/pisces.js"></script>


<script src="/blog/js/next-boot.js"></script>




  




  
<script src="/blog/js/local-search.js"></script>













  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://mazui3-com.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://mazui3.com/blog/2021/03/14/P170/";
    this.page.identifier = "2021/03/14/P170/";
    this.page.title = "å…³äºdataçš„ç¬”è®° - Week3";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://mazui3-com.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

  <script type="text/javascript" src="/js/my_js/firework.js"></script>

</body>
</html>


<!-- calendar widget -->


