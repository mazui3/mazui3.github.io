<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/star.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/star.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/star.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/blog/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"mazui3.com","root":"/blog/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","width":265,"display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":{"text":"Load Disqus","order":-1}},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="å‹æƒ…é“¾æ¥:SAS workspace.SAS text book.">
<meta property="og:type" content="article">
<meta property="og:title" content="å…³äºSASçš„ç¬”è®°">
<meta property="og:url" content="https://mazui3.com/blog/2021/10/05/P160/index.html">
<meta property="og:site_name" content="Underlake Reading Room">
<meta property="og:description" content="å‹æƒ…é“¾æ¥:SAS workspace.SAS text book.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://mazui3.com/blog/2021/10/05/P160/P160_.png">
<meta property="og:image" content="https://mazui3.com/blog/2021/10/05/P160/P160_1.png">
<meta property="og:image" content="https://mazui3.com/blog/2021/10/05/P160/P160_2.png">
<meta property="og:image" content="https://mazui3.com/blog/2021/10/05/P160/P160_3.png">
<meta property="og:image" content="https://mazui3.com/blog/2021/10/05/P160/P160_4.png">
<meta property="og:image" content="https://mazui3.com/blog/2021/10/05/P160/P160_5.png">
<meta property="og:image" content="https://mazui3.com/blog/2021/10/05/P160/P160_6.png">
<meta property="og:image" content="https://mazui3.com/blog/2021/10/05/P160/P160_7.png">
<meta property="og:image" content="https://mazui3.com/blog/2021/10/05/P160/P160_8.png">
<meta property="og:image" content="https://mazui3.com/blog/2021/10/05/P160/P160_9.png">
<meta property="og:image" content="https://mazui3.com/blog/2021/10/05/P160/P160_10.png">
<meta property="og:image" content="https://mazui3.com/blog/2021/10/05/P160/P160.png">
<meta property="og:image" content="https://mazui3.com/blog/2021/10/05/P160/P160_11.png">
<meta property="article:published_time" content="2021-10-05T04:43:07.000Z">
<meta property="article:modified_time" content="2021-11-18T00:09:34.501Z">
<meta property="article:author" content="Mazui">
<meta property="article:tag" content="ç¼–ç ">
<meta property="article:tag" content="ä»¥å¤´æŠ¢åœ°(è¯š)">
<meta property="article:tag" content="data">
<meta property="article:tag" content="SAS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mazui3.com/blog/2021/10/05/P160/P160_.png">

<link rel="canonical" href="https://mazui3.com/blog/2021/10/05/P160/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>å…³äºSASçš„ç¬”è®° | Underlake Reading Room</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Underlake Reading Room</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">è¿™é‡Œæ˜¯å›¾ä¹¦é¦†å¤–çš„é˜…è§ˆå®¤ğŸŒŸ</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/blog/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/blog/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Schedule</a>

  </li>
        <li class="menu-item menu-item-friendlink">

    <a href="/blog/link/" rel="section"><i class="fas fa-user-friends fa-fw"></i>FriendLink</a>

  </li>
        <li class="menu-item menu-item-back">

    <a href="https://www.mazui3.com/" rel="noopener" target="_blank"><i class="fas fa-carrot fa-fw"></i>Back</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://mazui3.com/blog/2021/10/05/P160/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/logo_6.png">
      <meta itemprop="name" content="Mazui">
      <meta itemprop="description" content="ä¸å­¤ç‹¬å’Œå¹³å…±å¤„.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Underlake Reading Room">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          å…³äºSASçš„ç¬”è®°
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-10-05 00:43:07" itemprop="dateCreated datePublished" datetime="2021-10-05T00:43:07-04:00">2021-10-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-11-17 19:09:34" itemprop="dateModified" datetime="2021-11-17T19:09:34-05:00">2021-11-17</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E6%95%B0%E5%AD%A6%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">æ•°å­¦ç¬”è®°</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/blog/2021/10/05/P160/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021/10/05/P160/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
            <span class="post-meta-item" title="C">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>45k</span>
            </span>
            <span class="post-meta-item" title="T">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>41 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <img src="/blog/2021/10/05/P160/P160_.png" class="">

<p>å‹æƒ…é“¾æ¥:<br><a target="_blank" rel="noopener" href="https://www.sas.com/en_ca/software/on-demand-for-academics.html">SAS workspace.</a><br><a target="_blank" rel="noopener" href="https://ca1lib.org/book/17389833/346ea7">SAS text book.</a></p>
<span id="more"></span>

<h1 id="Structure-of-SAS-program"><a href="#Structure-of-SAS-program" class="headerlink" title="Structure of SAS program"></a>Structure of SAS program</h1><ul>
<li>step(one paragraph of code)</li>
<li>statement(a code)</li>
<li>option(a keyword)</li>
<li>comment</li>
</ul>
<p>step:</p>
<ul>
<li>data step(create/update dataset)</li>
<li>proc step(åˆ†æ,å¤„ç†,å±•ç¤ºdataset)</li>
</ul>
<p>statement:</p>
<ul>
<li>data step stmt</li>
<li>proc step stmt</li>
<li>global stmt(setting)</li>
<li>macro stmt</li>
</ul>
<p>option:</p>
<ul>
<li>global option</li>
<li>dataset option(concise)</li>
<li>other</li>
</ul>
<br>
<br>

<p>No distinction between upper or lower case, except within â€œâ€.<br><a target="_blank" rel="noopener" href="https://lo.unisa.edu.au/mod/book/view.php?id=646442&chapterid=148097">SAS variable name requirement.</a></p>
<blockquote>
<p>The first character must be an English letter (A, B, C, . . ., Z) or underscore (_). Subsequent characters can be letters, numeric digits (0, 1, . . ., 9), or underscores.</p>
</blockquote>
<br>
<br>

<p>example:</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span>overview; <span class="comment">/* to generate a new data set called overview */</span></span><br><span class="line"><span class="meta">infile</span> <span class="emphasis">cards; /* read in a file starting from cards statement */</span></span><br><span class="line"><span class="emphasis">length country $30; /*length of country can be as long as 30*/</span></span><br><span class="line"><span class="emphasis">input Country $ Year gdp pop; /* read in those variables, use $ to</span></span><br><span class="line"><span class="emphasis">make it a character variable*/</span></span><br><span class="line"><span class="emphasis">cards;</span></span><br><span class="line"><span class="emphasis">Canada 2007 87943 1900</span></span><br><span class="line"><span class="emphasis">Canada 2006 89345 1876</span></span><br><span class="line"><span class="emphasis">Canada 2005 97712 1873</span></span><br><span class="line"><span class="emphasis">Australia 2007 85711 2412</span></span><br><span class="line"><span class="emphasis">Australia 2006 91028 2356</span></span><br><span class="line"><span class="emphasis">Australia 2005 101124 2342</span></span><br><span class="line"><span class="emphasis">China 2007 146018 11948</span></span><br><span class="line"><span class="emphasis">China 2006 151337 11542</span></span><br><span class="line"><span class="emphasis">China 2005 152035 11182</span></span><br><span class="line"><span class="emphasis">India 2007 64269 9023</span></span><br><span class="line"><span class="emphasis">India 2006 63558 8943</span></span><br><span class="line"><span class="emphasis">India 2005 62854 8876</span></span><br><span class="line"><span class="emphasis">;</span></span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span>overview_new_1; <span class="comment">/*æ–°ç”Ÿæˆdata*/</span></span><br><span class="line"><span class="meta">set</span> overview; <span class="comment">/*setå°±æ˜¯copy*/</span></span><br><span class="line"><span class="meta">keep</span> country year pop; <span class="comment">/*drop gdp;*/</span></span><br><span class="line"><span class="meta">rename</span> pop=population;</span><br><span class="line"><span class="meta">where</span> country=<span class="string">&#x27;China&#x27;</span>;</span><br><span class="line"><span class="meta">label</span> year=<span class="string">&quot;Fiscal Year&quot;</span>;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„keepå’Œdropåœ¨æ‹¬å·é‡Œéœ€è¦å¸¦ç­‰å·,æ²¡æœ‰æ‹¬å·ä¸èƒ½å¸¦ç­‰å·.</p>
<br>
<br>

<h1 id="SAS-Data"><a href="#SAS-Data" class="headerlink" title="SAS Data"></a>SAS Data</h1><ul>
<li>SAS Data: Perm dataset(lib) + Temp dataset(work)</li>
<li>External Data: Excel, txt, csv</li>
</ul>
<p>*æ³¨:ä¸€èˆ¬æ˜¯lib.datasetçš„æ ¼å¼,åªæœ‰workå¯ä»¥çœç•¥lib,ç›´æ¥ç”¨datasetçš„åå­—.</p>
<h2 id="Import"><a href="#Import" class="headerlink" title="Import"></a>Import</h2><p>Two methods for reading external data into SAS.</p>
<ol>
<li>The IMPORT procedure</li>
</ol>
<p>By default, the IMPORT procedure expects the variable names to appear in the first row.<br>We can modify whether SAS extracts the variable names from the first row of the data set by [GETNAMES=NO]</p>
<p>By default, the procedure scans the first 20 rows to count the variables, and it attempts to determine the correct informat and format for each variable.<br>(for example, variableçš„æœ€é•¿é•¿åº¦.)<br>We can indicate how many rows SAS scans for variables to determine the type and length [GUESSINGROWS=]</p>
<p>We can indicate at which row SAS begins to read the data [DATAROW=]</p>
<br>
<br>

<p>Importing an Excel File with an XLSX Extension</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc import </span>datafile=<span class="string">&#x27;/courses/d4c186d5ba27fe300/boots.xlsx&#x27;</span></span><br><span class="line">dbms=xlsx <span class="comment">/*xlsx/excel file*/</span></span><br><span class="line"><span class="meta">out</span>=work.bootsales <span class="comment">/*import to work lib bootsales dataset*/</span></span><br><span class="line"><span class="meta">replace</span>;</span><br><span class="line">sheet=boot; <span class="comment">/*worksheet called boot*/</span></span><br><span class="line">getnames=yes; <span class="comment">/*also by default*/</span></span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>


<p>Importing a Comma-Delimited File with a CSV Extension</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc import </span>datafile=<span class="string">&#x27;/courses/d4c186d5ba27fe300/boot.csv&#x27;</span></span><br><span class="line">dbms=csv <span class="comment">/*csv does not have multi worksheet*/</span></span><br><span class="line"><span class="meta">out</span>=shoes</span><br><span class="line"><span class="meta">replace</span>;</span><br><span class="line">getnames=no;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<p>Importing a Delimited File with a TXT Extension</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc import </span>datafile=<span class="string">&#x27;/courses/d4c186d5ba27fe300/delimiter.txt&#x27;</span></span><br><span class="line">dbms=dlm <span class="comment">/*delimited*/</span></span><br><span class="line"><span class="meta">out</span>=mydata</span><br><span class="line"><span class="meta">replace</span>;</span><br><span class="line"><span class="meta">delimiter</span>=<span class="string">&#x27;&amp;&#x27;</span>;</span><br><span class="line">getnames=yes;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<div class="note ">
            <p>Aside:<br>data looks like this:</p><blockquote><p>Region&amp;State&amp;Month&amp;Expenses&amp;Revenue<br>Southern&amp;GA&amp;JAN2001&amp;2000&amp;8000</p></blockquote><p>In this case, delimiter=â€™&amp;â€™.</p>
          </div>

<p>Importing a Space-Delimited File with a TXT Extension</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">filename</span> stdata <span class="string">&#x27;/courses/d4c186d5ba27fe300/state_data.txt&#x27;</span>; <span class="comment">/*this is equal to rename the filepath to &#x27;stdata&#x27;*/</span></span><br><span class="line"><span class="keyword">proc import </span>datafile=stdata</span><br><span class="line">dbms=dlm</span><br><span class="line"><span class="meta">out</span>=states</span><br><span class="line"><span class="meta">replace</span>;</span><br><span class="line"><span class="meta">delimiter</span>=<span class="string">&#x27; &#x27;</span>;</span><br><span class="line">getnames=yes;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<p>Importing a Tab-Delimited File with a TXT Extension</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc import </span>datafile=<span class="string">&#x27;/courses/d4c186d5ba27fe300/class.txt&#x27;</span></span><br><span class="line">dbms= dlm</span><br><span class="line"><span class="meta">out</span>=class</span><br><span class="line"><span class="meta">replace</span>;</span><br><span class="line"><span class="meta">delimiter</span>=<span class="string">&#x27;09&#x27;</span><span class="meta">x</span>; <span class="comment">/*tab*/</span></span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<div class="note ">
            <p>Aside:<br>å¦‚æœæ²¡æœ‰replace,æƒ³è¦åˆ›å»ºä¸€ä¸ªåå­—ä¸€æ ·çš„dataset, program will not complete and will not create a new dataset.</p>
          </div>

<br>
<br>

<ol start="2">
<li>Reading Microsoft Excel Data with the XLSX Engine<br>å› ä¸ºexcelå¯èƒ½æœ‰å¤šä¸ªsheetæ‹¥æœ‰æ•°æ®,è¿™ä¸ªæ˜¯ç®€ä¾¿æ–¹å¼.</li>
</ol>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">libname</span> certxl XLSX <span class="string">&#x27;/courses/d4c186d5ba27fe300/exercise.xlsx&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>The SAS/ACCESS LIBNAME statement creates the library called Certxl, which points to the Excel workbook exercise.xlsx. The workbook contains 3 worksheets, which are now available in the new SAS library as data sets.</p>
<br>
<br>


<h2 id="Character-and-Numeric-variable"><a href="#Character-and-Numeric-variable" class="headerlink" title="Character and Numeric variable"></a>Character and Numeric variable</h2><ul>
<li>Numericæ•°å­—</li>
<li>Characterå­—æ¯å’Œæ•°å­—å’Œç¬¦å·</li>
</ul>
<p>You cannot æ°¸ä¹…åœ° change the type of the variable. However, you can convert them temporarily:</p>
<p>Where SAS expects a numeric value, character will be converted into numeric if <strong>it only contains numbers</strong> . Otherwise a data error (execution error) will be issued and missing value will be generated.</p>
<p>Where SAS expects a character value, numeric data will be converted in to character based on best12. format. Best12. is a SAS format that allows SAS to determine the best format in 12 columns.</p>
<div class="note ">
            <p>Aside:</p><p>åœ¨SASä¸­, numericçš„æ•°æ®ä¼šé å³, charä¼šé å·¦.</p>
          </div>

<br>
<br>


<p>â€œWhereâ€ statement selects the observations that satisfy certain conditions. It requires <strong>compatible</strong> variables (num compare to num, char compare to char).</p>
<p>The length of a character is by default $8 (infile cards).</p>
<ul>
<li>Otherwise, the length of a character is defined by the first assignment during <strong>compiling</strong> (the length of the assigning variable or the assigning string value).</li>
<li>If you use a LENGTH statement to assign a length to a character variable, then it must be the first reference to the character variables in the DATA step. Therefore, the best position in the DATA step for a LENGTH statement is immediately after the DATA statement.</li>
</ul>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span>work.staff;</span><br><span class="line">JobCategory = <span class="string">&#x27;FA&#x27;</span>;</span><br><span class="line">JobLevel = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">JobCategory = JobCategory || JobLevel;</span><br><span class="line"><span class="keyword">run;</span> <span class="comment">/*output FA*/</span></span><br></pre></td></tr></table></figure>

<br>
<br>

<h2 id="Missing-data"><a href="#Missing-data" class="headerlink" title="Missing data"></a>Missing data</h2><ul>
<li>Numeric missing is presented as a period (.); character missing is presented as blank</li>
<li><strong>Missing data is less than any other valid values</strong> (åšwhereå¯»æ‰¾æ—¶éœ€è¦æ³¨æ„)</li>
<li>SAS will treat as missing numeric value if it encounters:</li>
</ul>
<ol>
<li>an invalid numeric data (for example, letters, see the previous example)</li>
<li>division by zero (5/0 = missing)</li>
<li>performing an operation on missing value (1+missing = missing)</li>
</ol>
<br>
<br>

<h2 id="SAS-date"><a href="#SAS-date" class="headerlink" title="SAS date"></a>SAS date</h2><p>SAS date value is a value that represents the number of days between January 1, 1960(as numeric value 0), and a<br>specified date.</p>
<p>â€œddMMMyyyyâ€d</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â€œ02Jan1960â€d = 1</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>Function</th>
<th>Usage</th>
<th>Result</th>
</tr>
</thead>
<tbody><tr>
<td>MDY</td>
<td>MDY(2,5,2017)</td>
<td>20855</td>
</tr>
<tr>
<td></td>
<td>MDY(â€˜01â€™,â€™01â€™,1960)</td>
<td>0</td>
</tr>
<tr>
<td>Day</td>
<td>Day(â€˜05Feb2017â€™d)</td>
<td>5</td>
</tr>
<tr>
<td>Month</td>
<td>Month(â€˜05Feb2017â€™d)</td>
<td>2</td>
</tr>
<tr>
<td>Year</td>
<td>Year(20855)</td>
<td>2017</td>
</tr>
<tr>
<td>Weekday</td>
<td>Weekday(20855)</td>
<td>1   #Sunday</td>
</tr>
<tr>
<td>Qtr</td>
<td>Qtr(20855)</td>
<td>1   #First</td>
</tr>
<tr>
<td>Time</td>
<td>Time()</td>
<td>Current time</td>
</tr>
<tr>
<td>Date/today</td>
<td>Date() or Today()</td>
<td>Current date</td>
</tr>
<tr>
<td>Datetime</td>
<td>Datetime()</td>
<td>Current date and time</td>
</tr>
</tbody></table>
<div class="note ">
            <p>Aside:</p><p>Results are all numeric, character can be used in the input, but will be converted into numeric automatically. 05FEB2017 is 20855 and Sunday</p>
          </div>

<div class="note ">
            <p>Aside:</p><p>Time(): # of seconds from 00:00:00<br>Date() or today(): # of days from 1960/01/01<br>Datetime(): # of seconds from 1960/01/01 00:00:00</p>
          </div>

<br>
<br>


<h2 id="SAS-format"><a href="#SAS-format" class="headerlink" title="SAS format"></a>SAS format</h2><table>
<thead>
<tr>
<th>Format</th>
<th>Original</th>
<th>FORMAT statement for data/proc steps</th>
<th>After</th>
</tr>
</thead>
<tbody><tr>
<td>w.d</td>
<td>12</td>
<td>format amount 4.1;</td>
<td>12.00</td>
</tr>
<tr>
<td>DATEw.</td>
<td>8966</td>
<td>format birth date7.;</td>
<td>19JUL84</td>
</tr>
<tr>
<td></td>
<td></td>
<td>format birth date9.;</td>
<td>19JUL1984</td>
</tr>
<tr>
<td>MMDDYYw. / DDMMYYw.</td>
<td>8966</td>
<td>format birth mmddyy6.;</td>
<td>071984</td>
</tr>
<tr>
<td></td>
<td></td>
<td>format birth mmddyy8.;</td>
<td>07/19/84</td>
</tr>
<tr>
<td>COMMAw.d</td>
<td>2234234.34</td>
<td>format amount comma15.2;</td>
<td>2,234,234.34</td>
</tr>
<tr>
<td>DOLLARw.d</td>
<td>2234234.34</td>
<td>format dollar dollar15.2;</td>
<td>$2,234,234.34</td>
</tr>
<tr>
<td>Percentw.d</td>
<td>0.12</td>
<td>format num percent7.2;</td>
<td>12.00%</td>
</tr>
</tbody></table>
<br>
<br>

<h2 id="format"><a href="#format" class="headerlink" title="format"></a>format</h2><p>andå’Œorç­‰çš„è¡¨ç°æ–¹å¼è·Ÿbashæœ‰ç‚¹ç‚¹åƒ.</p>
<div class="note ">
            <p>+, -, *, /, **<br>&amp; and, | or, ^ not</p>
          </div>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">= or EQ equal to</span><br><span class="line">^= or NE not equal to</span><br><span class="line">&gt; or GT greater than</span><br><span class="line">&lt; or LT less than</span><br><span class="line">&gt;= or GE greater than or equal to</span><br><span class="line">&lt;= or LE less than or equal to</span><br><span class="line">IN equal to one of a list</span><br></pre></td></tr></table></figure>

<p>The default encoding for a dataset in SAS is â€œwlatin1â€ (or â€œwlatin1 Western (windows)â€). wlatin1 is used in the â€œwestern worldâ€ and does not suppose Asian characters. UTF-8 is a universal encoding that can handle characters from all possible languages.</p>
<br>
<br>

<h2 id="PROCs"><a href="#PROCs" class="headerlink" title="PROCs"></a>PROCs</h2><p><strong>proc contents</strong>ç”¨äºæŸ¥çœ‹ä¸€ä¸ªtableçš„ä¿¡æ¯,åŠ ä¸‹åˆ’çº¿allæ˜¯ä¸€ä¸ªlibraryé‡Œæ‰€æœ‰çš„tableä¿¡æ¯.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc contents </span>data=SASHELP.<span class="literal">_all_</span> VARNUM;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<p><strong>proc sort.</strong></p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc sort </span>data=sashelp.class <span class="meta">out</span>=class; <span class="comment">/* work.class */</span></span><br><span class="line"><span class="meta">by</span> sex descending age; <span class="comment">/* this descending the age, if we want two descending we need to right it twice*/</span></span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<div class="note ">
            <p>â¢ Out= option allows you to specify the name (class) of the sorted data set, if omitted, the original data set (SASHELP.class) will be overwritten.<br>â¢ By default, SAS will sort the data set in ascending order (by sex). Option DESCENDING before the variable age asks SAS to sort in descending order (by age).<br>â¢ Proc sort does not generate SAS results, but generate a new sorted data set.</p>
          </div>

<p>If you specify NODUP option, the duplicated records will be deleted from the sorted data set (overview2_nodup).</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc sort </span>data=cert.overview2 <span class="meta">out</span>=overview2_nodup nodup; <span class="comment">/* de-dup */</span></span><br><span class="line"><span class="meta">by</span> country;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬è¿˜å¯ä»¥ç”¨éš”å£sqlçš„distinctæ¥de-dup.</p>
<p>If you specify NODUPKEY option, only one record (the first one) with the same key variables (the variables specified in BY statement) will be kept in the sorted data set (overview2_nodupkey).</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc sort </span>data=cert.overview2 <span class="meta">out</span>=overview2_nodupkey nodupkey;</span><br><span class="line"><span class="meta">by</span> country; <span class="comment">/* å¦‚æœcountryæœ‰ä¸€æ ·çš„å°±åˆ æ‰*/</span></span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<p><strong>proc means.</strong></p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc means </span>data=SASHELP.CLASS std mean max maxdec=2; <span class="comment">/* maxdecæ˜¯å°æ•°ç‚¹åæœ€å¤šä¿ç•™ä¸¤ä½ */</span></span><br><span class="line">var Height;</span><br><span class="line">class Sex Age; <span class="comment">/* å…ˆåˆ†ç»„,è¿™ç§æƒ…å†µä¼šåˆ†ä¸ºå››ç»„*/</span></span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<div class="note ">
            <p>âœ“ Class statement asks SAS to calculate the statistics for VAR Height within each class levels (Sex, Age)<br>âœ“ VAR statement asks for statistics of specified numeric variables, ignoring missing values. When omitted, the statistics for all the numeric variables will be calculated with missing values ignored.<br>âœ“ STD, MEAN, MAX â€¦ are the statistics you can require to calculate. By default, SAS will calculate N, mean, std, min and max. â€œN Obsâ€ is always given by SAS output, which counts total number of observations in each class level, including all missing values.<br>âœ“ MAXDEC = specifies the maximum of decimal points you would like SAS to report.<br>âœ“ Format, where and label statement can be applied in PROC MEANS as well</p>
          </div>

<p><strong>proc print.</strong></p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc print </span>data=class <span class="meta">label</span>;</span><br><span class="line">id name;</span><br><span class="line">var sex age height weight;</span><br><span class="line"><span class="meta">label</span> sex=<span class="string">&quot;Gender: M/F&quot;</span>;</span><br><span class="line"><span class="meta">format</span> height weight 7.1;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<div class="note ">
            <p>âœ“ Proc print displays the data portion of the data set. (what about proc contents?)<br>âœ“ VAR statement specifies which variables to print. If omitted, then SAS will by default print all the variables.<br>âœ“ Label option in the proc print statement asks SAS to print label instead of variable name in the header.è¦æ‰“å°labelå¾—åœ¨proc printé‚£è¡Œä¸€å¼€å§‹å°±è¯´.<br>âœ“ ID statement uses NAME for the row names instead of observations (1,2,3â€¦). For example, without ID statement, the result will be like:<br>âœ“ You can also use BY statement to have separate reports for different BY levels, however, data set must by sorted before using BY statement. Indeed, before using BY statement in any data/proc step, you must sort your data.</p>
          </div>

<p>**proc freq.**ç”¨äºåˆ†ææ•°æ®é¢‘ç‡.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc freq </span>data = sashelp.shoes;</span><br><span class="line">tables region;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<p><strong>Two-way Tabulation</strong></p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc freq </span>data = sashelp.shoes;</span><br><span class="line">tables region<span class="comment">*product;</span></span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<p>**proc format.**è¿™æ˜¯ä¸€ä¸ªç»„åˆæŠ€.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc format;</span></span><br><span class="line">value score</span><br><span class="line">low - &lt;60 = <span class="string">&quot;Fail&quot;</span></span><br><span class="line">60 - high = <span class="string">&quot;Pass&quot;</span>;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="keyword">proc format;</span></span><br><span class="line">value $sex <span class="comment">/* ä¿®é¥°character value */</span></span><br><span class="line"><span class="string">&quot;M&quot;</span> = <span class="string">&quot;Male&quot;</span></span><br><span class="line"><span class="string">&quot;F&quot;</span> = <span class="string">&quot;Female&quot;</span>;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* defineäº†ä¹‹åå†ä½¿ç”¨ */</span></span><br><span class="line"><span class="keyword">proc print </span>data =class;</span><br><span class="line">var score;</span><br><span class="line"><span class="meta">format</span> score score.;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<p>The user-defined format will be stored in a SAS catalog (not SAS data set).<br>Use $ before the format name in the value statement if you want to apply it to a character variable.</p>
<p>proc transpose: Transposing from horizontal (wide) to vertical (long) or transposing from vertical to horizontal</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Proc transpose </span>data=[] <span class="meta">out</span>=[] prefix=[];</span><br><span class="line"><span class="meta">By</span> [variable <span class="meta">list</span>]; <span class="comment">/* ç”¨äºåˆ†ç»„çš„variable */</span></span><br><span class="line">Var [variable <span class="meta">list</span>]; <span class="comment">*transpose these variables;</span> shortcutæœ‰RR:æ˜¯æ‰€æœ‰Rå¼€å¤´çš„column</span><br><span class="line">Id [variable <span class="meta">list</span>]; <span class="comment">*value becomes to variable name;</span> çºµåˆ°æ¨ªæ‰éœ€è¦id</span><br><span class="line"><span class="keyword">Run;</span></span><br></pre></td></tr></table></figure>

<div class="note ">
            <p>ID statement is critical when you transfer vertical to horizontal!<br>If you omit the VAR statement, then the TRANSPOSE procedure transposes all numeric variables in the input data set that are not listed in another statement.ä¹Ÿå°±æ˜¯BYä¸èƒ½ä¸å†™ä½†VARå¯ä»¥çœç•¥.<br>You must list character variables in a VAR statement if you want to transpose them.</p>
          </div>

<br>
<br>
<br>

<h2 id="function"><a href="#function" class="headerlink" title="function"></a>function</h2><p><strong>Mean, min, max, sum</strong><br>All the above functions ignore missing values. For example Sum (.,1,2,3) = 6, but . + 1 +2 +3 = .</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Y<span class="meta">=Mean(</span>x1,x2);</span><br><span class="line">Y<span class="meta">=Mean(</span>of X1-X5); <span class="comment">/* of æ˜¯ç®€ç•¥å†™æ³•,è¿™é‡Œæ˜¯sum x1åˆ°x5*/</span></span><br><span class="line">Y<span class="meta">=Mean(</span>of <span class="meta">X</span>:); <span class="comment">/* è¿™é‡Œæ˜¯sum æ‰€æœ‰çš„x column*/</span></span><br></pre></td></tr></table></figure>

<p><strong>inputå’Œput</strong>å¯ä»¥ç”¨æ¥è½¬æ¢æ ¼å¼.<br>Input(var,informat.): read variable into SAS value (normally numeric) using given informat.<br>Put(var,format.): present SAS values using given format, put function always <strong>returns a character</strong>.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var1=â€˜10Oct2021â€™;</span><br><span class="line"></span><br><span class="line">var2<span class="meta">=input(</span>var1,date9.); <span class="comment">/* è¿™é‡Œçš„date9.æ˜¯ç”¨äºè½¬æ¢çš„æ ¼å¼informat*/</span></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>Informat</th>
<th>Original</th>
<th>INput</th>
<th>After</th>
</tr>
</thead>
<tbody><tr>
<td>DATEw.</td>
<td>1jan1961</td>
<td>INPUT (Day, DATE9.)</td>
<td>366</td>
</tr>
<tr>
<td></td>
<td>1 jan 61</td>
<td></td>
<td>366</td>
</tr>
<tr>
<td>MMDDYYw. / DDMMYYw.</td>
<td>01.01.61</td>
<td>INPUT (Day, DDMMYY10.)</td>
<td>366</td>
</tr>
<tr>
<td></td>
<td>02/01/61</td>
<td>INPUT (Day, DDMMYY10.)</td>
<td>367</td>
</tr>
<tr>
<td>COMMAw.d</td>
<td>$1,000,001</td>
<td>INPUT (Income, COMMA10.)</td>
<td>1000001</td>
</tr>
<tr>
<td></td>
<td>(1,234)</td>
<td>INPUT (Income, COMMA10.)</td>
<td>-1234</td>
</tr>
</tbody></table>
<p>INDEX(character1, character2) returns first position of character2 string in in character1 string.ä»1å¼€å§‹æ•°.<br>Returns 0 if string not found.</p>
<p>FIND(character1, character2 &lt;, start position&gt; &lt;, modifier&gt;) Searches for a specific substring of characters within a character string, it is a more powerful version of INDEX function<br>Start position: from which position to search, should be numeric</p>
<blockquote>
<p>Modifier: is a character constant, variable, or expression that specifies one or more modifiers. The following modifiers can be in uppercase or lowercase: â€˜iâ€™: ignores character case during the search. If this modifier is not specified, FIND only searches for character substrings with the same case as the characters in substring.<br>åŠ äº†Iæˆ–è€…iéƒ½ä¼šignoreå¤§å°å†™.<br>start positionä¼šignoreæ‰å‰é¢çš„å­—æ¯,ä»start positionå¼€å§‹æ•°.</p>
</blockquote>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Text=<span class="string">&quot;Australia, US, Denmark&quot;</span>;</span><br><span class="line">Pos=find(Text,â€USâ€,â€iâ€,5);</span><br></pre></td></tr></table></figure>

<p>SUBSTR(character, numeric1&lt;, numeric2&gt;) extracts a substring from character of length numeric2 starting from position numeric1.</p>
<p>LENGTH(string) Returns the length of a non-blank character string, excluding trailing blanks, and returns 1 for a blank character string.</p>
<p>TRANWRD(source, target, replacement) Replaces all occurrences of a substring in a character string.<br>åƒatomé‡Œçš„æŸ¥æ‰¾å¹¶ä¸€é”®æ›¿æ¢åŠŸèƒ½.</p>
<p>TRIM(character) trims trailing blanks (blanks after the last non-blank character).</p>
<p>SCAN(character, n&lt;,delimiters &gt;) Returns the n-th <strong>word</strong> from a character string.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CAT(OF X1-X4)  == X1||X2||X3||X4</span><br><span class="line">CATS(OF X1-X4) == TRIM(LEFT(X1))||TRIM(LEFT(X2))||TRIM(LEFT(X3))||TRIM(LEFT(X4))</span><br><span class="line">CATT(OF X1-X4) == TRIM(X1)||TRIM(X2)||TRIM(X3)||TRIM(X4)</span><br><span class="line">CATX(SP, OF X1-X4) == TRIM(LEFT(X1))||SP||TRIM(LEFT(X2))||SP||TRIM(LEFT(X3))||SP||TRIM(LEFT(X4))</span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h2 id="control-data-step-flow"><a href="#control-data-step-flow" class="headerlink" title="control data step flow"></a>control data step flow</h2><p><strong>subsetting if</strong><br>ç­‰äºwhereæ¥ç­›é€‰çš„åŠŸèƒ½.ä½†æ˜¯where is more efficient.åœ¨datasetä¸­,whereåªèƒ½å‡ºç°ä¸€æ¬¡,ifå¯ä»¥å‡ºç°å¤šæ¬¡.</p>
<p><strong>ifâ€¦then</strong><br>æ™®é€šçš„if statement.<br>æ³¨æ„,å¦‚æœè¦å†™ if A, then B and C.æˆ‘ä»¬éœ€è¦group Bå’ŒC.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span>do_group;</span><br><span class="line"><span class="meta">set</span> cert.Overview;</span><br><span class="line"><span class="meta">if</span> country=<span class="string">&quot;China&quot;</span> <span class="meta">then</span> <span class="meta">do</span>;</span><br><span class="line">FX=0.2;</span><br><span class="line"><span class="meta">output</span>;</span><br><span class="line"><span class="meta">end</span>;</span><br><span class="line"><span class="meta">else</span> <span class="meta">if</span> country =<span class="string">&quot;Canada&quot;</span> <span class="meta">then</span> <span class="meta">do</span>;</span><br><span class="line">FX=1;</span><br><span class="line"><span class="meta">output</span>;</span><br><span class="line"><span class="meta">end</span>;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<p><strong>loop</strong></p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* numeric index */</span></span><br><span class="line"><span class="meta">do</span> i=1 to 20 <span class="meta">by</span> 1;</span><br><span class="line"><span class="comment">/* or */</span></span><br><span class="line"><span class="meta">do</span> i=1 to 20;</span><br><span class="line"><span class="comment">/* Do While */</span></span><br><span class="line"><span class="meta">do</span> <span class="meta">while</span> (PD&lt;0.5);</span><br><span class="line"><span class="comment">/* Do Until */</span></span><br><span class="line"><span class="meta">do</span> <span class="meta">until</span> (PD&gt;=0.5);</span><br></pre></td></tr></table></figure>
<p>Every DO (DO group or DO loop) must have a matching END.</p>
<br>
<br>
<br>

<p><strong>output</strong><br>Every time an output statement is hit the current record is saved to the output data set.</p>
<ul>
<li>If a data step has no OUTPUT statement then there is an implied OUTPUT at the end of the data<br>step.</li>
<li>If the data step contains one or more OUTPUT statements then there is no longer an OUTPUT<br>implied at the end of the data step.</li>
</ul>
<p>ODS can Save SAS output to various destinations such as rtf (word), pdf, csv, html â€¦<br>Sample Syntax to save the result of PROC FREQ into a html file:</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ods html <span class="meta">file</span>=<span class="string">&quot;C:\SAS\data\for lecture\output.html&quot;</span>;</span><br><span class="line"><span class="keyword">proc freq </span>data=overview;</span><br><span class="line">tables country;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line">ods html close;</span><br></pre></td></tr></table></figure>

<p>Other destinations can be used by SAS:<br>RTF, CSVALL, CSV, PDF, HTML, MSOFFICE2K, EXCELXP â€¦</p>
<br>
<br>
<br>

<h2 id="combine"><a href="#combine" class="headerlink" title="combine"></a>combine</h2><p>ç¬¬ä¸€ç§combine:åªcombineæ•°é‡ä¸€æ ·çš„è¡Œ,ä¸åŒçš„dropæ‰.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span>one_to_one;</span><br><span class="line"><span class="meta">set</span> a;</span><br><span class="line"><span class="meta">set</span> b;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<p>å·¦:</p>
<table>
<thead>
<tr>
<th>Num</th>
<th>VarA</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>A1</td>
</tr>
<tr>
<td>3</td>
<td>A2</td>
</tr>
<tr>
<td>5</td>
<td>A3</td>
</tr>
</tbody></table>
<p>å³:</p>
<table>
<thead>
<tr>
<th>Num</th>
<th>VarB</th>
</tr>
</thead>
<tbody><tr>
<td>2</td>
<td>B2</td>
</tr>
<tr>
<td>4</td>
<td>B4</td>
</tr>
</tbody></table>
<p>ç»“æœ:</p>
<table>
<thead>
<tr>
<th>Num</th>
<th>VarA</th>
<th>VarB</th>
</tr>
</thead>
<tbody><tr>
<td>2</td>
<td>A1</td>
<td>B2</td>
</tr>
<tr>
<td>4</td>
<td>A2</td>
<td>B4</td>
</tr>
</tbody></table>
<p>ç¬¬äºŒç§Data Concatenation: to stack two or more SAS data sets together.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DATA </span>new_data_set;</span><br><span class="line"><span class="meta">SET</span> data_set_1 ... data_set_n;</span><br><span class="line"><span class="keyword">RUN;</span></span><br></pre></td></tr></table></figure>

<p>å·¦:</p>
<table>
<thead>
<tr>
<th>Num</th>
<th>VarA</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>A1</td>
</tr>
<tr>
<td>3</td>
<td>A2</td>
</tr>
<tr>
<td>5</td>
<td>A3</td>
</tr>
</tbody></table>
<p>å³:</p>
<table>
<thead>
<tr>
<th>Num</th>
<th>VarB</th>
</tr>
</thead>
<tbody><tr>
<td>2</td>
<td>B2</td>
</tr>
<tr>
<td>4</td>
<td>B4</td>
</tr>
</tbody></table>
<p>ç»“æœ:</p>
<table>
<thead>
<tr>
<th>Num</th>
<th>VarA</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>A1</td>
</tr>
<tr>
<td>3</td>
<td>A2</td>
</tr>
<tr>
<td>5</td>
<td>A3</td>
</tr>
<tr>
<td>2</td>
<td>B2</td>
</tr>
<tr>
<td>4</td>
<td>B4</td>
</tr>
</tbody></table>
<p>ç¬¬äºŒç§combineå¸¦sort.All the data sets need to be sorted before using any BY statement!<br><strong>æ³¨æ„è¿™æ—¶å¾—ä¸¤ä¸ªtableå·²ç»sortå¥½äº†.è¿™ä¸ªæ¡ä»¶é™åˆ¶äºæ‰€æœ‰sort.</strong></p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DATA </span>new_data_set;</span><br><span class="line"><span class="meta">SET</span> data_set_1 ... data_set_n;</span><br><span class="line"><span class="meta">BY</span> variable_list;</span><br><span class="line"><span class="keyword">RUN;</span></span><br></pre></td></tr></table></figure>

<p>å·¦:</p>
<table>
<thead>
<tr>
<th>Num</th>
<th>VarA</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>A1</td>
</tr>
<tr>
<td>3</td>
<td>A2</td>
</tr>
<tr>
<td>5</td>
<td>A3</td>
</tr>
</tbody></table>
<p>å³:</p>
<table>
<thead>
<tr>
<th>Num</th>
<th>VarA</th>
</tr>
</thead>
<tbody><tr>
<td>2</td>
<td>B2</td>
</tr>
<tr>
<td>4</td>
<td>B4</td>
</tr>
</tbody></table>
<p>ç»“æœ:</p>
<table>
<thead>
<tr>
<th>Num</th>
<th>VarA(ä¿ç•™å·¦è¾¹çš„VarAå‚¨å­˜å±æ€§)</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>A1</td>
</tr>
<tr>
<td>2</td>
<td>B2</td>
</tr>
<tr>
<td>3</td>
<td>A2</td>
</tr>
<tr>
<td>4</td>
<td>B4</td>
</tr>
<tr>
<td>5</td>
<td>A3</td>
</tr>
</tbody></table>
<p>å¦‚æœå·¦è¡¨å›¾æ˜¯VarAå³è¡¨å›¾æ˜¯VarB,åˆ™ä¼šåŒæ—¶ä¿ç•™VarAå’ŒVarB.</p>
<p>ç¬¬ä¸‰ç§çœŸæ­£çš„merge(ä¹Ÿå«join).<br>æ³¨:åœ¨mergeå‰è¦checkæ˜¯å¦sorted,ä»¥åŠcheck keyvar nameæ˜¯å¦identical.<br>sas datastep mergeä¸æ”¯æŒmany to many.sqlå¯ä»¥.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DATA </span>new_data_set;</span><br><span class="line"><span class="meta">MERGE</span> data_set_1(<span class="meta">in</span>=ind_1) data_set_2(<span class="meta">in</span>=ind_2);</span><br><span class="line"><span class="meta">BY</span> variable-<span class="meta">list</span>;</span><br><span class="line"><span class="meta">if</span> ind_1=1; <span class="comment">*left join;</span></span><br><span class="line"><span class="comment">*if ind_2=1;</span> <span class="comment">*right join;</span></span><br><span class="line"><span class="comment">*if ind_1=1 and ind_2=1;</span> <span class="comment">*inner join;</span></span><br><span class="line"><span class="comment">*if ind_1=1 or ind_2=1;</span> <span class="comment">*SAS default: full join;</span></span><br><span class="line"><span class="keyword">RUN;</span></span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h2 id="Retain-and-Sum-Statement"><a href="#Retain-and-Sum-Statement" class="headerlink" title="Retain and Sum Statement"></a>Retain and Sum Statement</h2><p>Use the RETAINç´¯åŠ  statement when you want SAS to preserve a variableâ€™s value from the previous iteration of the DATA step.<br>å¦‚æœæˆ‘ä»¬ä½¿ç”¨loop,sasæ— æ³•ç´¯è®¡ä¸Šä¸€è½®çš„temp variableå€¼.æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨retain functionå­˜å‚¨ temp variable.<br>â¢ The RETAIN statement can appear anywhere in the DATA step, it is more efficient than the assignment statement, because it will be executed only once (declarative).<br>â¢ Retain statement syntax (if not specifying initial value, then initialize the variable list with missing):</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">RETAIN</span> variable-<span class="meta">list</span>;</span><br><span class="line"><span class="meta">RETAIN</span> variable-<span class="meta">list</span> initial-value;</span><br></pre></td></tr></table></figure>

<p>â¢ A sum statement also retains values from the previous iteration of the DATA step, but you use it for the special cases where you simply want to cumulatively add the value of an expression to a variable.<br>â¢ Sum statement syntax</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">variable + expression; <span class="comment">/* è¦æ³¨æ„è¿™è·Ÿvariable= variable + expressison ä¸ä¸€æ ·,commenté‡Œçš„æ˜¯æ™®é€šçš„åŠ æ³•,æ— æ³•å¤„ç†missing value,è€Œcodeblocké‡Œçš„æ˜¯retainçš„å†™æ³•,å¯ä»¥å¤„ç†missing value.*/</span></span><br></pre></td></tr></table></figure>

<p>This is equivalent to:</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">RETAIN</span> variable 0;</span><br><span class="line">variable =<span class="meta"> SUM(</span>variable, expression);</span><br></pre></td></tr></table></figure>

<p>â¢ The sum statement will ignore missing values, because it is equivalent to sum function not + operator.</p>
<br>
<br>
<br>

<h2 id="SAS-Automatic-Variables"><a href="#SAS-Automatic-Variables" class="headerlink" title="SAS Automatic Variables"></a>SAS Automatic Variables</h2><p>Those SAS Automatic variables will be automatically dropped from the data step, and <strong>can be only used with IF statement, but not where statement</strong>.</p>
<p><strong>FIRST.by</strong> and <strong>LAST.by</strong><br>The FIRST.by and LAST.by automatic variables are available when you are using a BY statement in a DATA step.<br>The FIRST.by will have a value of 1 when SAS is processing an observation with the first occurrence of a new value for that variable and a value of 0 for the other observations.<br>The LAST.by will have a value of 1 for an observation with the last occurrence of a value for that variable and the value 0 for the other observations.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc sort </span>data=class;</span><br><span class="line"><span class="meta">by</span> class descending name; <span class="comment">/* å› ä¸ºè¦ä½¿ç”¨first.class last.classæ‰€ä»¥å…ˆæ’åºå¥½ */</span></span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">data </span>sum_class;</span><br><span class="line"><span class="meta">set</span> class;</span><br><span class="line"><span class="meta">by</span> class descending name;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ç”¨äºåˆ†ç»„ç´¯åŠ .æ³¨æ„ä¸€å®šè¦æŒ‰byçš„featureæ’åºå¥½.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span>WORK.TOTAL;</span><br><span class="line"><span class="meta">set</span> WORK.SALARY;</span><br><span class="line"><span class="meta">by</span> Department Gender;</span><br><span class="line"><span class="meta">if</span> First.&lt;_insert_code_&gt; <span class="meta">then</span> Payroll=0; <span class="comment">/* è¿™ä¸‰è¡Œæ˜¯ä¸ªcombo */</span></span><br><span class="line">Payroll+Wagerate;</span><br><span class="line"><span class="meta">if</span> Last.&lt;_insert_code_&gt;;<span class="comment">/* ç®—ä»€ä¹ˆçš„accumulate subtotals for each feature å°±æŠŠinsert_codeæ”¹æˆé‚£ä¸ªfeature*/</span></span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>
<p>Inserted code will accumulate subtotals for each Gender within Department.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span>WORK.TOTAL;</span><br><span class="line"><span class="meta">set</span> WORK.SALARY(<span class="meta">keep</span>=Department MonthlyWageRate);</span><br><span class="line"><span class="meta">by</span> Department;</span><br><span class="line"><span class="meta">if</span> First.Department=1 <span class="meta">then</span> Payroll=0;</span><br><span class="line">Payroll+(MonthlyWageRate<span class="comment">*12);</span> <span class="comment">/* ç´¯åŠ çš„æ˜¯MonthlyWageRate*12,å­˜åˆ°payrollé‡Œ */</span></span><br><span class="line"><span class="meta">if</span> Last.Department=1;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>
<p>The values of the variable Payroll represent the annual total for each department in the WORK.SALARY data set.</p>
<br>
<br>
<br>

<h1 id="Macro"><a href="#Macro" class="headerlink" title="Macro"></a>Macro</h1><p>SAS Macroä¸‰ç§ç”¨æ³•: Substitue, Condition, Loop (ä½œç”¨:automation/efficiency)</p>
<h2 id="Macro-variable"><a href="#Macro-variable" class="headerlink" title="Macro variable"></a>Macro variable</h2><p>ä¸‰ç§macro variableçš„å»ºç«‹:</p>
<ul>
<li>%let<br>Straightforward and easy to understand. Use period to separate out the macro variable you would like to resolve</li>
</ul>
<p><strong>åŒå¼•å·å¯ä»¥resolveä½†å•å¼•å·ä¸å¯ä»¥.</strong></p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">%let</span> data=work.overview; <span class="comment">*to define a macro variable;</span></span><br><span class="line"><span class="keyword">proc print </span>data=<span class="variable">&amp;data</span>; <span class="comment">*use &amp; to resolve(ä½¿ç”¨/æ›¿æ¢) it;</span></span><br><span class="line"><span class="comment">*double quotes &quot;&quot; - resolve macro variable;</span></span><br><span class="line"><span class="meta">title</span> <span class="string">&quot;A listing of the &amp;data SAS data set&quot;</span>;</span><br><span class="line"><span class="comment">*single quotes &#x27;&#x27; - not resolve macro variable;</span></span><br><span class="line">title2 <span class="string">&#x27;A listing of the &amp;data SAS data set&#x27;</span>;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<p>åŠ separatorçš„ç‚¹.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">%let</span> i=10; <span class="comment">*what if I want resolve &quot;i&quot; in &quot;ith&quot;;</span></span><br><span class="line"><span class="keyword">proc print </span>data=work.overview(firstobs=<span class="variable">&amp;i</span> obs=<span class="variable">&amp;i</span>);</span><br><span class="line"><span class="meta">title</span> <span class="string">&quot;&amp;i.th Record in work.overview&quot;</span>; <span class="comment">*resolved as 10th;</span></span><br><span class="line">title2 <span class="string">&quot;&amp;ith Record in work.overview&quot;</span>; <span class="comment">*can not resolve, since ith is</span></span><br><span class="line"><span class="comment">not a macro variable;</span></span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<img src="/blog/2021/10/05/P160/P160_1.png" class="" title="ç­”æ¡ˆæ˜¯C">
<img src="/blog/2021/10/05/P160/P160_2.png" class="" title="ç­”æ¡ˆæ˜¯C">
<p>å¦‚æœè¦ç”¨whereåšæ¯”è¾ƒ,å·¦è¾¹æœ‰å³è¾¹çš„value typeå¾—ç›¸åŒ.</p>
<hr>
<ul>
<li>Call symput: With CALL SYMPUT, you can create macro variables that contain the values of variables from SAS data sets. You cannot resolve them in the same data step.<br>%letåªèƒ½å®šä¹‰ä¸€ä¸ª,ä½†call symputå¯ä»¥å¤šä¸ª.</li>
</ul>
<p>call symput(var_name,value)</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span><span class="literal">_null_</span>; <span class="comment">*è¿™é‡Œçš„nullæ˜¯ä¸ç”Ÿæˆæ–°çš„dataset</span></span><br><span class="line"><span class="comment">set overview3;</span></span><br><span class="line"><span class="meta">call</span> sy<span class="meta">mput(</span>Record_No,gdp); <span class="comment">*Record_Noæ˜¯macro variableçš„åå­—,gdpä½œä¸ºvalue</span></span><br><span class="line"><span class="comment">run;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">%put</span> <span class="name">%int001</span> <span class="name">%int002</span> <span class="name">%int013</span>; <span class="comment">*æ£€éªŒç”¨</span></span><br><span class="line"><span class="comment">%put _user_;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span><span class="literal">_null_</span>;</span><br><span class="line"><span class="meta">set</span> cert.overview3;</span><br><span class="line"><span class="meta">if</span> <span class="literal">_n_</span> =1 <span class="meta">then</span> <span class="meta">call</span> sy<span class="meta">mput(</span>Record_No,gdp); <span class="comment">*_n_ = 1ä¸­çš„næ˜¯sasçš„è‡ªåŠ¨variable.æ„æ€æ˜¯åœ¨å¤„ç†overviewçš„ç¬¬ä¸€è¡Œçš„æ—¶å€™å»æ‰§è¡Œcall symput</span></span><br><span class="line"><span class="comment">run;</span></span><br><span class="line"><span class="built_in">%put</span> <span class="variable">&amp;int001</span>;</span><br></pre></td></tr></table></figure>
<p>åŒç†å¯ä»¥ç”¨ä»€ä¹ˆ n in (1,3,5,7,9).</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span><span class="literal">_null_</span>;</span><br><span class="line"><span class="meta">set</span> cert.overview3;</span><br><span class="line"><span class="meta">if</span> <span class="literal">_n_</span>=1 <span class="meta">then</span> <span class="meta">call</span> sy<span class="meta">mput(</span><span class="string">&quot;MV&quot;</span>,gdp); <span class="comment">*marco variableå«MV</span></span><br><span class="line"><span class="comment">run;</span></span><br><span class="line"><span class="built_in">%put</span> <span class="variable">&amp;mv</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span><span class="literal">_null_</span>;</span><br><span class="line"><span class="meta">set</span> cert.overview3;</span><br><span class="line"><span class="meta">call</span> sy<span class="meta">mput(</span><span class="string">&quot;line&quot;</span>|<span class="meta">|compress(</span><span class="literal">_n_</span>)<span class="meta">,put(</span>gdp,dollar10.1));</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<hr>
<ul>
<li>Select into: Create macro variables in PROC SQL</li>
</ul>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">PROC SQL;</span></span><br><span class="line"><span class="meta">select</span> count(<span class="comment">*) into: n from work.overview;</span> --è¿™é‡Œcountæ•°å‡ºä¸€å…±æœ‰13è¡Œ,ç„¶å<span class="meta">into</span>ç­‰äº <span class="built_in">%let</span> n=13</span><br><span class="line"><span class="meta">select</span> <span class="meta">distinct</span> country <span class="meta">into</span>: country_list separated <span class="meta">by</span> <span class="string">&quot;,&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">from</span> work.overview;</span><br><span class="line"><span class="keyword">quit;</span></span><br></pre></td></tr></table></figure>

<p>Example 22:<br>Write a SAS program that will:<br>â€¢ Perform an SQL query to create a macro variable named AverageHits from sashelp.baseball<br>â€¢ AverageHits should be the average of the CrHits columns.<br>â€¢ The program should not produce a report in the results.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc sql </span>noprint;</span><br><span class="line"><span class="meta">select</span><span class="meta"> mean(</span>CrHits) <span class="meta">into</span>: AverageHits <span class="meta">from</span> sashelp.baseball;</span><br><span class="line"><span class="keyword">quit;</span></span><br></pre></td></tr></table></figure>

<hr>
<p>Consecutive &amp;</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">%let</span> a=alpha;</span><br><span class="line"><span class="built_in">%let</span> b=beta;</span><br><span class="line"><span class="built_in">%let</span> abeta=pair;</span><br><span class="line"><span class="built_in">%put</span> <span class="variable">&amp;a</span><span class="variable">&amp;b</span>; <span class="comment">*resolve to alphabeta;</span></span><br><span class="line"><span class="built_in">%put</span> <span class="variable">&amp;&amp;a</span><span class="variable">&amp;b</span>; <span class="comment">*resolve to: &amp;abeta which resolves to pair;</span></span><br></pre></td></tr></table></figure>

<p>Method to understand how consecutive &amp; resolves<br>â€¢ Rule 1: SAS resolve left to right<br>â€¢ Rule 2: &amp;&amp;Ã &amp;<br>â€¢ Rule 3: In each read, SAS only resolve each &amp; once<br>â€¢ Rule 4: SAS will read again while there is &amp; unresolved</p>
<p>Exercise:</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">%let</span> attri=name;</span><br><span class="line"><span class="built_in">%let</span> name=shan;</span><br><span class="line"><span class="built_in">%let</span> shan=chinese;</span><br><span class="line"><span class="built_in">%put</span> <span class="variable">&amp;name</span> is a <span class="variable">&amp;&amp;</span><span class="variable">&amp;&amp;name</span>; -- <span class="variable">&amp;&amp;name</span> -&gt; <span class="variable">&amp;name</span> -&gt; shan</span><br><span class="line"><span class="built_in">%put</span> <span class="variable">&amp;name</span> is a <span class="variable">&amp;&amp;</span><span class="variable">&amp;&amp;</span><span class="variable">&amp;name</span>; -- <span class="variable">&amp;&amp;shan</span> -&gt; <span class="variable">&amp;shan</span> -&gt; chinese</span><br><span class="line"><span class="built_in">%put</span> <span class="variable">&amp;name</span> is a <span class="variable">&amp;&amp;</span><span class="variable">&amp;&amp;</span><span class="variable">&amp;&amp;name</span>; -- <span class="variable">&amp;&amp;</span><span class="variable">&amp;name</span> -&gt; <span class="variable">&amp;shan</span> -&gt; chinese</span><br></pre></td></tr></table></figure>

<img src="/blog/2021/10/05/P160/P160_3.png" class="" title="B">

<hr>
<h2 id="Macro-Functions"><a href="#Macro-Functions" class="headerlink" title="Macro Functions"></a>Macro Functions</h2><p>(åªå¤„ç†macro variable):</p>
<ul>
<li>%eval (expression)è·Ÿè¿ç®—æœ‰å…³çš„macro function: allows integer arithmetic of macro variables (decimal points are not allowed in expression).inputå’Œoutputåªèƒ½è¾“å‡ºæ•´æ•°éƒ¨åˆ†.</li>
<li>%sysevalf (expression): returns the numeric results of a mathematical expression, which contains operators and numeric constants only.å¯ä»¥åšå°æ•°,åªèƒ½åŒ…å«è¿ç®—ç¬¦å·å’Œå¸¸æ•°(æ¯”å¦‚å¼€æ ¹å·çš„ä¸¤ç§å†™æ³•0.25**0.5,sqrt(0.25)åªèƒ½æ”¯æŒç¬¬ä¸€ç§).</li>
<li>%sysfunc (data step function, <format>): allows us to use some data step functions outside of the data step.</li>
</ul>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">%let</span> express1=0.25<span class="comment">**0.5;</span></span><br><span class="line"><span class="built_in">%let</span> express2=<span class="built_in">%eval</span>(5/3);</span><br><span class="line"><span class="built_in">%let</span> express3=<span class="built_in">%sysevalf</span>(0.25<span class="comment">**0.5);</span></span><br><span class="line"><span class="built_in">%let</span> express4=<span class="built_in">%sysfunc</span><span class="meta">(sqrt(</span>0.25),4.1);</span><br><span class="line"><span class="built_in">%put</span> <span class="variable">&amp;express1</span>; -- è¿˜æ˜¯0.25<span class="comment">**0.5,ä¸ä¼šè®¡ç®—</span></span><br><span class="line"><span class="comment">%put &amp;express2 &amp;express3 &amp;express4;</span> -- 1, 0.5, 0.5</span><br></pre></td></tr></table></figure>

<img src="/blog/2021/10/05/P160/P160_4.png" class="" width="1">
<img src="/blog/2021/10/05/P160/P160_5.png" class="" width="2">

<hr>
<p>Macro version of datastep function.</p>
<p>%substr (string, position&lt;,length&gt;): returns the substring of a string starting from position and ending length characters later.<br>%length (string): returns length of string,<br>%upcase (string): returns upper case<br>%scan (string, n &lt;,delimiters&gt;): returns the nth word of the string where words are delineated by the specified delimiter(s)<br>%index (string, substring): Returns the position of the first occurrence of the substring found in the string. If the string is not found, then returns 0.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">%let</span> ss=Canadians are bad at math;</span><br><span class="line"><span class="built_in">%let</span> ss1=<span class="built_in">%substr</span>(<span class="variable">&amp;ss</span>,11,3);</span><br><span class="line"><span class="built_in">%let</span> ss2=<span class="built_in">%scan</span>(<span class="variable">&amp;ss</span>,4);</span><br><span class="line"><span class="built_in">%let</span> ss3=<span class="built_in">%index</span>(<span class="variable">&amp;ss</span>,American); <span class="comment">*no quotes are needed for American;</span></span><br><span class="line"><span class="built_in">%put</span> <span class="variable">&amp;ss1</span> <span class="variable">&amp;ss2</span> <span class="variable">&amp;ss3</span> <span class="built_in">%length</span>(<span class="variable">&amp;ss3</span>); -- are, at, 0, 1</span><br></pre></td></tr></table></figure>

<div class="note ">
            <p>ä¸‰ç§variable.</p><p>Num: 123 (int/floatæ„Ÿè§‰çš„variable)<br>Char: â€˜123â€™<br>Macro: abc (ç±»ä¼¼textçš„variable,ä¸æ˜¯charä¹Ÿä¸å¸¦å¼•å·)</p>
          </div>

<img src="/blog/2021/10/05/P160/P160_6.png" class="" title="D">

<hr>
<h2 id="Macros"><a href="#Macros" class="headerlink" title="Macros"></a>Macros</h2><p>A block of SAS steps that is resolved when the macro is revoked(å®šä¹‰ä¸€ä¸ªæ¨¡ç‰ˆä¸€èµ·è°ƒç”¨).</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--å®šä¹‰</span><br><span class="line"><span class="built_in">%MACRO</span> name(positional parameters, keyword parameters=);</span><br><span class="line">  &lt;contents of macro&gt;</span><br><span class="line"><span class="built_in">%MEND</span>;</span><br><span class="line"></span><br><span class="line">--è°ƒç”¨</span><br><span class="line"><span class="name">%name</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">%macro</span> p<span class="meta">rint(</span>data,var=);</span><br><span class="line"><span class="keyword">  proc print </span>data=<span class="variable">&amp;data</span> noobs <span class="meta">label</span>;</span><br><span class="line">    var <span class="variable">&amp;var</span>;</span><br><span class="line"><span class="keyword">  run;</span></span><br><span class="line"><span class="built_in">%mend</span>;</span><br><span class="line"></span><br><span class="line"><span class="name">%print</span>(work.overview,var=country year gdp)</span><br></pre></td></tr></table></figure>

<p>è¦å®šä¹‰ä¸€ä¸ªmacros,æˆ‘ä»¬è¦å®šä¹‰positional parameter(ä¾‹å­ä¸­çš„data)å’Œkeyward parameter(var=).</p>
<table>
<thead>
<tr>
<th></th>
<th>Position</th>
<th>Keyword</th>
</tr>
</thead>
<tbody><tr>
<td>å®šä¹‰</td>
<td>å†™parameter name</td>
<td>parameter name + â€œ=â€</td>
</tr>
<tr>
<td>è°ƒç”¨</td>
<td>ç›´æ¥assign value</td>
<td>æŠ„ä¸€éparameter name + â€œ=â€ + value</td>
</tr>
</tbody></table>
<p>å®šä¹‰æˆkeywordçš„å¥½å¤„æ˜¯å¯ä»¥<strong>æ–¹ä¾¿è°ƒç”¨é¡ºåº</strong>å’Œ<strong>è®¾ç½®é»˜è®¤å€¼default</strong>.</p>
<img src="/blog/2021/10/05/P160/P160_7.png" class="" title="C">
<img src="/blog/2021/10/05/P160/P160_8.png" class="" title="B">
<img src="/blog/2021/10/05/P160/P160_9.png" class="" title="printçš„è¯­æ³•é”™è¯¯æ‰€ä»¥å¤±è´¥,é»˜è®¤çš„æˆåŠŸäº†">

<p>Write a SAS program that will:<br>â€¢ Write a macro named test that contains one parameter, name list.<br>â€¢ Within this macro, use macro functions to create a new global macro variable named val that extracts the third value from list and stores it upper case.<br>â€¢ Call the macro test with the text Ford, Chevy, Toyota, Buick as the parameter value.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">%macro</span> test(<span class="meta">list</span>=);</span><br><span class="line"><span class="built_in">%global</span> val;</span><br><span class="line"><span class="built_in">%let</span> val=<span class="built_in">%upcase</span>(<span class="built_in">%scan</span>(<span class="variable">&amp;list</span>,3,<span class="string">&#x27;,&#x27;</span>));</span><br><span class="line"><span class="built_in">%put</span> <span class="variable">&amp;val</span>;</span><br><span class="line"><span class="built_in">%mend</span>;</span><br><span class="line"></span><br><span class="line"><span class="name">%test</span>(<span class="meta">list</span>=<span class="string">&quot;Ford,Chevy,Toyota,Buick&quot;</span>)</span><br></pre></td></tr></table></figure>
<hr>
<p>Macros related Global Options(debug):</p>
<p><strong>SYMBOLGEN:</strong> The SYMBOLGEN options shows when each macro variable reference resolution occurs; use SYMBOLGEN to help locate problems with macro variable reference resolution. To Turn it off, use <strong>NOSYMBOLGEN</strong>.<br><strong>MPRINT:</strong> The MPRINT options shows all SAS statements generated by macro code. Use MPRINT to help locate problems from errors generated by the SAS compiler. To turn it off, use NOMPRINT.<br><strong>MLOGIC:</strong> The MLOGIC option prints messages that indicate macro actions that were taken during macro execution.</p>
<hr>
<h2 id="Conditional-Processing-and-Iteration"><a href="#Conditional-Processing-and-Iteration" class="headerlink" title="Conditional Processing and Iteration"></a>Conditional Processing and Iteration</h2><p>Macro IF-ELSE-THEN</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">%IF</span> expression <span class="built_in">%THEN</span> <span class="built_in">%DO</span>;</span><br><span class="line">SAS code;</span><br><span class="line"><span class="built_in">%END</span>;</span><br><span class="line"><span class="built_in">%ELSE</span> <span class="built_in">%DO</span>;</span><br><span class="line">SAS code;</span><br><span class="line"><span class="built_in">%END</span>;</span><br></pre></td></tr></table></figure>

<p>Macro Iterative Do (Do Loop)</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">%DO</span> macro variable = start <span class="built_in">%TO</span> <span class="meta">stop</span> &lt;<span class="name">%BY</span> increment&gt;;</span><br><span class="line">SAS code;</span><br><span class="line"><span class="built_in">%END</span>;</span><br><span class="line"><span class="built_in">%DO</span> <span class="built_in">%WHILE</span>(expression);</span><br><span class="line">SAS code;</span><br><span class="line"><span class="built_in">%END</span>;</span><br><span class="line"><span class="built_in">%DO</span> <span class="built_in">%UNTIL</span>(expression);</span><br><span class="line">SAS code;</span><br><span class="line"><span class="built_in">%END</span>;</span><br></pre></td></tr></table></figure>

<p>Important: Macro loops and conditional processing as shown previously <strong>can not be use in open code. They must only be used within macros(å°±æ˜¯start with macro ends with mendçš„åœ°æ–¹)</strong>.</p>
<p>Example 34:<br>Write a SAS program that will:<br>Create a macro named macro34. The macro should:<br>â€¢ Use only macro statements.<br>â€¢ Create a global macro variable named X.<br>â€¢ Set the initial value of X to 1.25.<br>â€¢ Use a macro DO WHILE or DO UNTIL loop.<br>Within this loop:<br>â€¢ Write the current value of X to the SAS log.<br>â€¢ Increment the value of X by 0.25.<br>â€¢ Stop the loop when X =2.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">%macro</span> macro34;</span><br><span class="line"><span class="built_in">%global</span> <span class="meta">x</span>;</span><br><span class="line"><span class="built_in">%do</span> <span class="built_in">%while</span> (( <span class="variable">&amp;x</span>&lt;=2));</span><br><span class="line">  <span class="built_in">%put</span> <span class="variable">&amp;x</span>;</span><br><span class="line">  <span class="built_in">%let</span> <span class="meta">x</span>=<span class="built_in">%sysevalf</span>(<span class="variable">&amp;x</span>+0.25); -- sysevalf cuz we need 0.25</span><br><span class="line"><span class="built_in">%end</span>;</span><br><span class="line"><span class="built_in">%mend</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">%macro</span>34;</span><br></pre></td></tr></table></figure>


<p>Example 32:<br>Given the SAS data set SASUSER.HIGHWAY:<br><strong>Steering Seatbelt Speed Status Count</strong><br>absent No 0-29 serious 31<br>absent No 0-29 not 1419<br>absent No 30-49 serious 191<br>absent no 30-49 not 2004<br>absent no 50+ serious 216</p>
<p>The following SAS program is submitted:</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">%macro</span> SPLIT;</span><br><span class="line"><span class="keyword">proc sort </span>data=SASUSER.HIGHWAY</span><br><span class="line">    <span class="meta">out</span>=WORK.UNIQUES(<span class="meta">keep</span>=Status) nodupkey;</span><br><span class="line">  <span class="meta">by</span> Status;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">data </span><span class="literal">_null_</span>;</span><br><span class="line">  <span class="meta">set</span> uniques <span class="meta">end</span>=Lastobs;</span><br><span class="line">  <span class="meta">call</span> symputx(<span class="string">&#x27;Status&#x27;</span>|<span class="meta">|left(</span><span class="literal">_n_</span>),Status);</span><br><span class="line">  <span class="meta">if</span> Lastobs <span class="meta">then</span> <span class="meta">call</span> symputx(<span class="string">&#x27;Count&#x27;</span>,<span class="literal">_n_</span>);</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">%local</span> i;</span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">data</span></span><br><span class="line"><span class="keyword"></span><span class="built_in">%do</span> i=1 <span class="built_in">%to</span> <span class="variable">&amp;count</span>;</span><br><span class="line">[_insert_reference_]</span><br><span class="line"><span class="built_in">%end</span>;</span><br><span class="line">;</span><br><span class="line">  <span class="meta">set</span> SASUSER.HIGHWAY;</span><br><span class="line"></span><br><span class="line">  <span class="meta">select</span> (Status);</span><br><span class="line">    <span class="built_in">%do</span> i=1 <span class="built_in">%to</span> <span class="variable">&amp;Count</span>;</span><br><span class="line">      wh<span class="meta">en(</span><span class="string">&quot;[_insert_reference_]&quot;</span>) <span class="meta">output</span> [_insert_reference_];</span><br><span class="line">    <span class="built_in">%end</span>;</span><br><span class="line">    otherwise;</span><br><span class="line">  <span class="meta">end</span>;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">%mend</span>;</span><br><span class="line"></span><br><span class="line"><span class="name">%SPLIT</span></span><br></pre></td></tr></table></figure>

<img src="/blog/2021/10/05/P160/P160_10.png" class="" title="B">

<hr>
<h2 id="Scope-of-macro-variables-â€“-Global-and-Local"><a href="#Scope-of-macro-variables-â€“-Global-and-Local" class="headerlink" title="Scope of macro variables â€“ Global and Local"></a>Scope of macro variables â€“ Global and Local</h2><ul>
<li>Global macro variables exist for the duration of the SAS session and can be referenced anywhere.(åªè¦æ²¡å…³sas globalå°±ä¸€ç›´åœ¨)</li>
<li>Local macro variables exist only during the execution of the macro in which the variables are created and have no meaning outside the defining macro.(æ¯å½“è°ƒç”¨macroçš„æ—¶å€™,local symbol tableå»ºç«‹,çŸ¥é“macroæ‰§è¡Œç»“æŸ,æŒºå¿«çš„)</li>
<li>Use %local or %global to force it to be a local or global macro variable<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">%global</span> macro_name;</span><br><span class="line"><span class="built_in">%local</span> macro_name;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>You can create a global macro variable with the following:</p>
<ul>
<li>a %LET statement (used <strong>outside a macro definition</strong>)</li>
<li>a DATA step that contains a SYMPUT routine</li>
<li>a SELECT statement that contains an INTO clause in PROC SQL</li>
<li>a %GLOBAL statement.</li>
</ul>
<p>You can create local macro variables with the following:</p>
<ul>
<li> parameters in a macro definition</li>
<li>a %LET statement within a macro definition</li>
<li>a DATA step that contains a SYMPUT routine within a macro definition</li>
<li>a SELECT statement that contains an INTO clause in PROC SQL within a macro definition</li>
<li>a %LOCAL statement.</li>
</ul>
<p>Note: The SYMPUT routine can create a local macro variable if a local symbol table already exists.<br>A local symbol table is created when a macro that <strong>includes a parameter list</strong> is called or when a request is made to create a local macro variable during macro execution. The local symbol table is deleted when the macro finishes execution. That is, the local symbol table exists only while the macro executes.<br>If no local symbol table exists when the SYMPUT routine executes, it creates a global macro variable.</p>
<br>
<br>
<br>

<h1 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h1><p>è¯¦è§<a href="https://mazui3.com/blog/2021/01/31/P167/">SQL</a>ç›¸å…³note.è¿™é‡Œè®°å½•SASè·ŸSQLä¼šæ›¿æ¢çš„å†™æ³•.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc sql;</span></span><br><span class="line"><span class="meta">create</span> <span class="meta">table</span> work.china_06_gdp <span class="meta">as</span></span><br><span class="line"><span class="meta">select</span> country,year,gdp</span><br><span class="line"><span class="meta">from</span> cert.overview</span><br><span class="line"><span class="meta">where</span> country=<span class="string">&quot;china&quot;</span> <span class="meta">and</span> year=2006;</span><br><span class="line"><span class="keyword">quit;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span>work.china_06_gdp;</span><br><span class="line"><span class="meta">set</span> cert.overview;</span><br><span class="line"><span class="meta">where</span> country=<span class="string">&quot;china&quot;</span> <span class="meta">and</span> year=2006;</span><br><span class="line"><span class="meta">keep</span> country year gdp;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åœ¨selectå’Œkeepä¸­,åœ¨sqlä¸­variableä¼šéœ€è¦ç”¨é€—å·éš”å¼€ä½†sasä¸ä¼š.<br>åœ¨sasä¸­å¯ä»¥ç”¨sql labelç»™ä¸€ä¸ªcolumnåŠ label,è·³è¿‡åå­—,è¿™æ—¶å€™columnåå­—å°±æ˜¯ä¸€ä¸ªrandomçš„.</p>
<p>sqlä¸­çš„distinctç­‰äºsasä¸­çš„nodupçš„åŠŸèƒ½.åŒæ—¶sqlçš„distinctä¼šapplyåˆ°æ‰€æœ‰èƒŒåçš„variable.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">Select</span> country,<span class="meta"> min(</span>gdp)</span><br><span class="line"><span class="meta">From</span> overview --å»ºè®®ä»<span class="meta">from</span>å¼€å§‹è¯»sql code,æœ€åå†çœ‹<span class="meta">select</span></span><br><span class="line"><span class="meta">Where</span> pop &gt;2400</span><br><span class="line"><span class="meta">Group</span> <span class="meta">by</span> country</span><br><span class="line"><span class="meta">Having</span> count(<span class="comment">*) &gt;=2;</span> --countryä¸­æœ‰å¤šå°‘none <span class="meta">missing</span> value å¤§äº2</span><br></pre></td></tr></table></figure>
<p>count(*) function is only available in proc sql.</p>
<p>åœ¨sasä¸­éœ€è¦checkå¤šå¤„æ‰èƒ½merge.<br>åœ¨sqlä¸­ä¸éœ€è¦:</p>
<ul>
<li>all data sets not require to be sorted beforehand</li>
<li>all data sets not require common BY variables(key id ä¸éœ€è¦åŒæ ·)</li>
<li>many-to-many merge allowed</li>
</ul>
<hr>
<p>Example:</p>
<p>Write a SAS program that will:<br>â€¢ Perform an SQL query to create an output table named work.SQL09 by reading sashelp.cars and cert.CarRebates<br>â€¢ Work.SQL09 should contain:</p>
<ol>
<li>One row for all the unique combinations of Make and Type of cars from cert.CarRebates. If a Rebate exists for that Make and Type of cars.</li>
<li>If there is no Rebate for the specific Make and Type, then the Rebate value should be missing in the new table.</li>
<li>Three columns: Make, Type, Rebate.</li>
</ol>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc sql;</span></span><br><span class="line"><span class="meta">create</span> <span class="meta">table</span> work.sq109 <span class="meta">as</span></span><br><span class="line"><span class="meta">select</span> <span class="meta">distinct</span> a.make, a.type, rebate</span><br><span class="line"><span class="meta">from</span> sashelp.cars <span class="meta">as</span> a left join cert.carrebates <span class="meta">as</span> b</span><br><span class="line"><span class="meta">on</span> a.make=b.make <span class="meta">and</span> a.type=b.type;</span><br><span class="line"><span class="keyword">quit;</span></span><br></pre></td></tr></table></figure>

<img src="/blog/2021/10/05/P160/P160.png" class="">

<br>
<br>
<br>

<h1 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h1><p>Array assigns aliases for a series of variables and allows you to loop among variables</p>
<div class="note ">
            <p>Syntax:<br>array array-name (number-of-element) $ w variable-names (initialization);<br>$w is used to define character array and can be omitted, you can either use existing variables or create new variables as array elements</p>
          </div>

<p>Ã˜ Name of the array cannot be the name of the variable in the data set.<br>Ã˜ Name of the array exists only for the duration of the DATA step, while cannot be used in the PROC step<br>Ã˜ Array name cannot be used in the data set option, keep/drop statement or other statement.</p>
<p>Using Multidimensional Arrays</p>
<div class="note ">
            <p>Ã˜ General form, multidimensional ARRAY statement:<br>ARRAY array-name {rows,cols,â€¦} &lt;$&gt; <length><array-elements> &lt;(initial values)&gt;;</p>
          </div>

<p>Ã˜ When you work with arrays, remember the following:</p>
<ul>
<li>The name of the array must be a SAS name that is not the name of a SAS function or variable in the same DATA step.</li>
<li>The variables listed as array elements must all be the same type (either all numeric or all character).</li>
<li>The initial values that are specified can be numbers or character strings. You must enclose all character strings in quotation marks.</li>
</ul>
<br>
<br>
<br>

<h1 id="Creating-Functions-with-PROC-FCMP"><a href="#Creating-Functions-with-PROC-FCMP" class="headerlink" title="Creating Functions with PROC FCMP"></a>Creating Functions with PROC FCMP</h1><p>The SAS Function Compiler (FCMP) procedure enables you to create, test, and store user-defined functions, CALL routines, and subroutines for use in other SAS procedures and the DATA step.<br>Ã˜ You can use the functions and subroutines that you create in PROC FCMP with the DATA step, the WHERE statement, the Output Delivery System (ODS), and with some procedures.<br>Ã˜ Writing a PROC FCMP Step<br>General form for a basic PROC FCMP step to create and save a function:</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">PROC FCMP </span>OUTLIB= libref.data-<span class="meta">set</span>.package;</span><br><span class="line">Function function-name(argument1&lt;$&gt;,...,argument-n&lt;$&gt;&lt;<span class="meta">length</span>&gt;);</span><br><span class="line">programming statements;</span><br><span class="line"><span class="meta">Return</span> (expression);</span><br><span class="line">ENDSUB;</span><br><span class="line"><span class="keyword">QUIT;</span></span><br></pre></td></tr></table></figure>

<p>Ã˜ The PROC FCMP statement begins the FCMP step. The OUTLIB= option specifies the three-level name of an output package where the compiled functions are stored. Function and subroutine names must be unique within a package.<br>Ã˜ The definition of a function begins with the FUNCTION statement and ends with an ENDSUB statement.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc fcmp </span>outlib=orion.functions.dev;</span><br><span class="line">function ReverseName(name $) $40;</span><br><span class="line">retu<span class="meta">rn(</span>catx(<span class="string">&#x27; &#x27;</span><span class="meta">,scan(</span>name,2,<span class="string">&#x27;,&#x27;</span>)<span class="meta">,scan(</span>name,1,<span class="string">&#x27;,&#x27;</span>)));</span><br><span class="line">endsub;</span><br><span class="line"><span class="keyword">quit;</span></span><br></pre></td></tr></table></figure>

<p>You must specify the CMPLIB= system option in order to use the new function in a DATA step or supported PROC step. The CMPLIB= system option specifies one or more data sets that store user-defined functions. In this example, function ReverseName is saved to orion.functions.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">options</span> cmplib=orion.functions;</span><br><span class="line"><span class="keyword">data </span>work.emplist;</span><br><span class="line"><span class="meta">set</span> orion.employeeaddresses;</span><br><span class="line">NewName=ReverseName(EmployeeName);</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h1 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h1><p>An index can help you quickly locate one or more observations that you want to read.</p>
<p>Ã˜ Indexes provide direct access to observations in SAS data sets based on values of one or more key variables.<br>Ã˜ Index applications include the following:</p>
<ul>
<li>Yield faster access to small subsets of observations for WHERE processing</li>
<li>Perform table lookup operations</li>
<li>Join observations</li>
</ul>
<p>Ã˜ Without an index, SAS accesses observations sequentially, in the order in which they are stored in a data set.<br>Ã˜ An index consists of value/identifier pairs that enable you to locate an observation by value.</p>
<p>You can create two types of indexes:</p>
<ul>
<li>a simple index</li>
<li>a composite index</li>
</ul>
<p>Ã˜ A simple index consists of the values of one key variable, which can be character or numeric. When you create a simple index, SAS names the index after the key variable.<br>Ã˜ A composite index consists of the values of multiple key variables, which can be character, numeric, or a combination. The values of these key variables are concatenated to form a single value.<br>Ã˜ When you create a composite index, you must specify a unique index name that is not the name of any existing variable or index in the data set.</p>
<br>
<br>
<br>

<h1 id="Hash-Object"><a href="#Hash-Object" class="headerlink" title="Hash Object"></a>Hash Object</h1><p>The hash object provides an efficient, convenient mechanism for quick data storage and retrieval.</p>
<ul>
<li>Hash objects can return multiple values from a given lookup.</li>
<li>A hash object can be loaded from hardcoded values or a SAS data set, is sized dynamically, and exists for the duration of the DATA step.</li>
<li>The hash object is a good choice for lookups that use unordered data that can fit into memory because it provides in-memory storage and retrieval and does not require the data to be sorted or indexed.</li>
</ul>
<p>The Structure of a Hash Object<br>Ã˜ The key component has these characteristics:</p>
<ul>
<li>Might consist of numeric and character values</li>
<li>Maps key values to data rows</li>
<li>Must be unique</li>
<li>Can be a composite</li>
</ul>
<p>Ã˜ The data component has these characteristics:</p>
<ul>
<li>Can contain multiple data values per key value</li>
<li>Can consist of numeric and character values</li>
</ul>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span>work.difference (<span class="meta">drop</span>= goalamount);</span><br><span class="line"><span class="meta">if</span> <span class="literal">_N_</span> = 1 <span class="meta">then</span> <span class="meta">do</span>; --</span><br><span class="line">declare hash goal( );</span><br><span class="line">goal.definekey(<span class="string">&quot;QtrNum&quot;</span>);</span><br><span class="line">goal.definedata(<span class="string">&quot;GoalAmount&quot;</span>);</span><br><span class="line">goal.definedone( );</span><br><span class="line"><span class="meta">call</span> <span class="meta">missing</span>(goalamount);</span><br><span class="line">goal.<span class="meta">add</span>(<span class="meta">key</span>:<span class="string">&#x27;qtr1&#x27;</span>, data:10 );</span><br><span class="line">goal.<span class="meta">add</span>(<span class="meta">key</span>:<span class="string">&#x27;qtr2&#x27;</span>, data:15 );</span><br><span class="line">goal.<span class="meta">add</span>(<span class="meta">key</span>:<span class="string">&#x27;qtr3&#x27;</span>, data: 5 );</span><br><span class="line">goal.<span class="meta">add</span>(<span class="meta">key</span>:<span class="string">&#x27;qtr4&#x27;</span>, data:15 );</span><br><span class="line"><span class="meta">end</span>;</span><br><span class="line"><span class="meta">set</span> sasuser.contrib;</span><br><span class="line">goal.find();</span><br><span class="line">Diff = amount - goalamount;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span>work.info45 work.errors45;</span><br><span class="line"><span class="meta">if</span> <span class="literal">_n_</span>=1 <span class="meta">then</span> <span class="meta">do</span>;</span><br><span class="line"><span class="meta">if</span> 0 <span class="meta">then</span> <span class="meta">set</span> cert.country45;</span><br><span class="line"></span><br><span class="line">declare hash country_table (dataset: <span class="string">&quot;cert.country45&quot;</span>);</span><br><span class="line">country_table.definekey(<span class="string">&#x27;country_code&#x27;</span>);</span><br><span class="line">country_table.definedata(<span class="string">&#x27;country_name&#x27;</span>);</span><br><span class="line">country_table.definedone();</span><br><span class="line"><span class="meta">end</span>;</span><br><span class="line"><span class="meta">set</span> cert.employees45;</span><br><span class="line">rc=country_table.find(<span class="meta">key</span>:country_code);</span><br><span class="line"><span class="meta">if</span> rc=0 <span class="meta">then</span></span><br><span class="line"><span class="meta">output</span> work.info45;</span><br><span class="line"><span class="meta">else</span> <span class="meta">output</span> work.errors45;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h1 id="Compressed-File"><a href="#Compressed-File" class="headerlink" title="Compressed File"></a>Compressed File</h1><p>By default, a SAS data file is uncompressed. You can compress your data files to conserve disk space, although some files are not good candidates for compression.<br>Ã˜ The file structure of a compressed data file is different from the structure of an uncompressed file.</p>
<ul>
<li>You use the COMPRESS= data set option or system option to compress a data file.</li>
<li>You use the POINTOBS= data set option to enable SAS to access observations in compressed files directly rather than sequentially.</li>
<li>You use the REUSE= data set option or system option to specify that SAS should reuse space in a compressed file when observations are added or updated.</li>
</ul>
<p>Deciding Whether to Compress a Data File<br>Ã˜ When SAS need to read a compressed file, each observation must be uncompressed. This requires more CPU resources than reading an uncompressed file.<br>Ã˜ However, compression can be beneficial when the data file has one or more of the following properties:</p>
<ul>
<li>It is large.</li>
<li>Many long character values.</li>
<li>Many values that have repeated characters or binary zeros.</li>
<li>Many missing values.</li>
<li>Repeated values in variables that are physically stored next to one another (blanks).</li>
</ul>
<p>Ã˜ A data file is not a good candidate for compression if it has any of the following characteristics:</p>
<ul>
<li>Few repeated characters</li>
<li>Small physical size</li>
<li>Few missing values</li>
<li>Short text strings</li>
</ul>
<p>The COMPRESS= System Option and the COMPRESS= Data Set Option</p>
<p>Ã˜ To compress a data file, you use either the COMPRESS= data set option or the COMPRESS= system option.<br><strong>OPTIONS COMPRESS= NO | YES | CHAR | BINARY;</strong><br>Ã˜ NO-default setting, which does not compress the data set.<br>Note: The COMPRESS= data set option overrides the COMPRESS= system option.</p>
<p>(1)The YES or CHAR setting for the COMPRESS= option uses the RLE compression algorithm.</p>
<ul>
<li>RLE is most often useful for character data that contains repeated blanks.</li>
<li>The YES or CHAR setting is also good for compressing numeric data in which most of the values are zero.</li>
</ul>
<p>(2)The BINARY setting for the COMPRESS= option uses RDC, which combines run-length encoding and sliding-window compression.</p>
<ul>
<li>This method is highly effective for compressing medium to large blocks of binary data (numeric variables).</li>
<li>BINARY can also be very effective with character data that contains patterns rather than simple repetitions.</li>
</ul>
<br>
<br>
<br>

<h1 id="Dictionary-Tables"><a href="#Dictionary-Tables" class="headerlink" title="Dictionary Tables"></a>Dictionary Tables</h1><p>Dictionary tables are commonly used to monitor and manage SAS sessions.<br>Ã˜ Dictionary tables are special, read-only SAS tables that contain information about SAS libraries, SAS macros, and external files that are in use or available in the current SAS session.<br>Ã˜ Dictionary tables also contain the settings for SAS system options and SAS titles and footnotes that are currently in effect.<br>â€¢ For example, the Dictionary.Columns table contains information (such as name, type, length, and format) about all columns in all tables that are known to the current SAS session.</p>
<p>Dictionary tables are<br>â€¢ created each time they are referenced in a SAS program<br>â€¢ updated automatically<br>â€¢ limited to Read-Only access.</p>
<img src="/blog/2021/10/05/P160/P160_11.png" class="">

<br>
<br>
<br>

<h1 id="Quiz-example"><a href="#Quiz-example" class="headerlink" title="Quiz example"></a>Quiz example</h1><h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p>Example 22:</p>
<p>Open the existing program, program22.sas from<br>folder /home/kevin_7140/my_content/errors.<br>This program is intended to:<br>â€¢ Create variable, Bonus, that is 5% of the last income (Income5). If the Bonus is over $7,000, create the variable Total that sums Bonus and Income5. Then write that observations to the new data set, Bonusover7K.<br>There are multiple errors in the program. These may be syntax error, logic errors, or problems with the program structure. Logic errors might not produce messages in the log, but will cause the program to produce results different than intended.<br>Correct the errors, run the program, and then use the results to answer the next 3 questions.<br>a. What is the value of Total for observation 114?<br>b. What is the grand total of Total for the entire data set?<br>c. What is the maximum value for Total?</p>
<p>Save your program as program22.sas in folder before continuing with the next project.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* è¿™æ˜¯errorçš„program */</span></span><br><span class="line"><span class="keyword">Data </span>BonusOver7K;</span><br><span class="line">     <span class="meta">set</span> cert.input22;</span><br><span class="line">     Bonus=Income5<span class="comment">*0.05;</span></span><br><span class="line">     <span class="meta">if</span> bonus&gt;7000 <span class="meta">then</span> <span class="meta">output</span>; <span class="comment">/* é”™åœ¨è¿™é‡Œ */</span></span><br><span class="line">     Total=<span class="meta"> sum(</span>income5, bonus);</span><br><span class="line">      <span class="meta">format</span> bonus total dollar8.;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">proc print </span>data=BonusOver7K;</span><br><span class="line">     <span class="meta">title</span>=<span class="string">&quot;Bonuses Over $7,000&quot;</span>;</span><br><span class="line">     var firstName lastName Income5 Bonus Total;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">proc means </span>data=BonusOver7K max total;</span><br><span class="line">     var Total;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* è¿™æ˜¯è®¢æ­£è¿‡çš„program */</span></span><br><span class="line"><span class="keyword">Data </span>BonusOver7K;</span><br><span class="line">     <span class="meta">set</span> cert.input22;</span><br><span class="line">     Bonus=Income5<span class="comment">*0.05;</span></span><br><span class="line">     <span class="meta">if</span> bonus&gt;7000 <span class="meta">then</span> <span class="meta">do</span>; <span class="comment">/* ä¸è¦å…ˆè¾“å‡º */</span></span><br><span class="line">     Total=<span class="meta"> sum(</span>income5, bonus);</span><br><span class="line">     <span class="meta">output</span>;</span><br><span class="line">     <span class="meta">end</span>;</span><br><span class="line">      <span class="meta">format</span> bonus total dollar8.;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* æˆ–è€… */</span></span><br><span class="line"><span class="keyword">Data </span>BonusOver7K;</span><br><span class="line">     <span class="meta">set</span> cert.input22;</span><br><span class="line">     Bonus=Income5<span class="comment">*0.05;</span></span><br><span class="line">     <span class="meta">if</span> bonus&gt;7000;</span><br><span class="line">     Total=<span class="meta"> sum(</span>income5, bonus);</span><br><span class="line">      <span class="meta">format</span> bonus total dollar8.;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p>Example 20:</p>
<p>This project will use data set cert.input20. At any time, you may save your program as program20.<br>â€¢ The observations contain data for students and university.<br>â€¢ This data set needs to be cleaned to correct some data errors.</p>
<p>Write a SAS program that will:<br>â€¢ Read the data set cert.input20, create a new data set named results.output20.<br>â€¢ Inspect the variable major. The variable major:<br>o Should contain only one major. A major is a field of study for the student. For example: â€˜Electrical Engineeringâ€™ or â€˜Physicsâ€™.<br>o Some observations have two majors listed in this variable, separated by the word â€˜andâ€™, (always in lower case), such as â€˜Electrical Engineering and Computer Scienceâ€™.<br>o Use the word â€˜andâ€™ to identify a second major, and if found put the second major in a new variable named secondMajor.</p>
<p>â€¢ When there are 2 majors, the original major variable should be modified so that it contains only the first major.<br>Run the program and use additional SAS procedure step to answer the next 2 questions.<br>a. What is the most frequently occurring major in results.output20?<br>b. What is the most frequently occurring secondMajor in results.output20?</p>
<p>Now modify the program to also accomplish the following:<br>â€¢ Convert all 2-letter state codes to upper case. Take no action on state codes that are not 2 letters long.</p>
<p>Write additional SAS procedure step(s) to answer the following 2 questions.<br>a. How many students living in North Carolina are in their senior year (year=â€™Seniorâ€™) and do not have a second major? (Note: The state code for North Carolina is â€˜NCâ€™).<br>b. How many non-missing, unique values exist for the variable state?</p>
<p>Save your program as program20.sas in folder before continuing with the next project.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">libname</span> cert <span class="string">&quot;/home/kevin_7140/my_content&quot;</span>;</span><br><span class="line"><span class="meta">libname</span> results <span class="string">&quot;/home/kevin_7140/output&quot;</span>;</span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">data </span>results.output20;</span><br><span class="line"><span class="meta">set</span> cert.input20;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Method 1*/</span></span><br><span class="line"><span class="comment">/* origin_major=major; */</span></span><br><span class="line">major<span class="meta">=tranwrd(</span>major,<span class="string">&#x27;and &#x27;</span>,<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">secondMajor<span class="meta">=scan(</span>major,2,<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">major<span class="meta">=scan(</span>major,1,<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Method 2*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* if find(major,&#x27;and&#x27;,&#x27;i&#x27;)&gt;0 then do */</span></span><br><span class="line"><span class="comment">/* secondMajor=substr(major,find(major,&#x27;and&#x27;,&#x27;i&#x27;)+4); */</span></span><br><span class="line"><span class="comment">/* major=substr(major,1,find(major,&#x27;and&#x27;,&#x27;i&#x27;)-2);end; */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">if</span><span class="meta"> length(</span>state)=2 <span class="meta">then</span> state<span class="meta">=upcase(</span>state);</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">proc freq </span>data=results.output20;</span><br><span class="line">tables major secondmajor;run;</span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">proc freq </span>data=results.output20(<span class="meta">where</span>=(year=<span class="string">&#x27;Senior&#x27;</span> <span class="meta">and</span> state=<span class="string">&#x27;NC&#x27;</span>));</span><br><span class="line">tables secondMajor;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">data </span>t;</span><br><span class="line"><span class="meta">set</span> results.output20(<span class="meta">where</span>=(year=<span class="string">&#x27;Senior&#x27;</span> <span class="meta">and</span> state=<span class="string">&#x27;NC&#x27;</span>));</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">proc freq </span>data=results.output20 nlevels;</span><br><span class="line">tables state;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><p>This project will data set cert.input19.<br>Write a SAS program that will:<br>â€¢ Read cert.input19 as input<br>â€¢ Create the SAS data set results.output19<br>â€¢ Create a new variable named FULLNAME in this data set that is the concatenation of the FIRSTNAME and LASTNAME variables, separated by a single space.<br>â€¢ Determine the length (number of characters) of FULLNAME for each observation.<br>â€¢ Adjust the defined length is the same as the longest occurrence of FULLNAME and rerun the program.<br>â€¢ In the new data set, only keep the FULLNAME, FIRSTNAME and LASTNAME variables (3 variables total)</p>
<p>What is the length of the new variable that you created in your program?</p>
<p>Open the OUTPUT folder in SAS Studio. What is the file size, in kb, of the results.output19 data set?<br>Enter your numeric answer in the space below:</p>
<hr>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">libname</span> cert <span class="string">&quot;/the/address&quot;</span>;</span><br><span class="line"><span class="meta">libname</span> results <span class="string">&quot;/the/address&quot;</span>;</span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">data </span>results.output19;</span><br><span class="line"><span class="meta">set</span> cert.input19;</span><br><span class="line">FULLNAME = catx(<span class="string">&#x27; &#x27;</span>,FIRSTNAME,LASTNAME); <span class="comment">/* catxå•Šâ€¦ */</span></span><br><span class="line">LEN<span class="meta">=length(</span>FULLNAME);</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">proc sort </span>data=results.output19 <span class="meta">out</span>=new; <span class="comment">/* æ‰¾å‡ºæœ€é•¿çš„fullnameç„¶åæŒ‰å®ƒçš„é•¿åº¦cut */</span></span><br><span class="line"><span class="meta">by</span> descending len;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<p>åŠ ä¸Šè°ƒèŠ‚é•¿åº¦çš„ç‰ˆæœ¬.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span>results.output19;</span><br><span class="line"><span class="meta">length</span> FULLNAME $18; <span class="comment">/* å› ä¸ºæ˜¯charæ‰€ä»¥è¦åŠ $ */</span></span><br><span class="line"><span class="meta">set</span> cert.input19;</span><br><span class="line">FULLNAME = catx(<span class="string">&#x27; &#x27;</span>,FIRSTNAME,LASTNAME); <span class="comment">/* catxå•Šâ€¦ */</span></span><br><span class="line">LEN<span class="meta">=length(</span>FULLNAME);</span><br><span class="line"><span class="meta">keep</span> FULLNAME FIRSTNAME LASTNAME;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="4"><a href="#4" class="headerlink" title="4"></a>4</h2><p>Question 9</p>
<p>This project will use data set cert.input23. At any time, you may save your program.<br>Write a SAS program that will:<br>â€¢ Read cert.input23 as input.<br>â€¢ Create three data sets:<br>o results.Young23: people who are age 39 and younger.<br>o results.Mid23: people between the ages of 40 and 60, inclusive.<br>o results.NotasYoung23: people who are age 61 and older.<br>â€¢ Remove variables from the data sets as follows:<br>o Drop the variables Income3, Income4, and Income5 from the results.Young23 data set.<br>â€¢ For the results.Young23 data set, create a new variable named avgInc that is the average of the remaining Income variables for each observation.</p>
<p>Run the program and use the results to answer the next 2 questions.<br>a. How many people are in the results.Mid23 data set?<br>b. What is the average (mean) of the Income5 variable in the results.NotasYoung23 data set?<br>Enter your numeric answer in the space below (Round your answer to the nearest integer).<br>Save your program in folder.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span>results.Young23(<span class="meta">drop</span>=Income3 Income4 Income5) results.Mid23 results.NotasYoung23; <span class="comment">/* å¯ä»¥ä¸€æ¬¡æ€§ç”Ÿæˆä¸‰ä¸ª,ç‰›é€¼ */</span></span><br><span class="line"><span class="meta">set</span> cert.input23;</span><br><span class="line"><span class="meta">if</span> age &lt;= 39 <span class="meta">then</span> <span class="meta">output</span> results.Young23;</span><br><span class="line"><span class="meta">else</span> <span class="meta">if</span> age &gt;= 40 <span class="meta">and</span> age &lt;= 60 <span class="meta">then</span> <span class="meta">output</span> results.Mid23;</span><br><span class="line"><span class="meta">else</span> <span class="meta">if</span> age &gt;= 61 <span class="meta">then</span> <span class="meta">output</span> results.NotasYoung23;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">data </span>results.young23;</span><br><span class="line"><span class="meta">set</span> results.young23;</span><br><span class="line">avgInc =<span class="meta"> mean(</span>income1,income2);</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">proc mean </span>data=results.NotasYoung23 mean;</span><br><span class="line">var income5;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="5"><a href="#5" class="headerlink" title="5"></a>5</h2><p>Question 10</p>
<p>Open the existing program, program41.sas from folder /home/kevin_7140/my_content/errors. At any time, you may save your program as program41.</p>
<p>This program is intended to:<br>â€¢ Subset the data into two data sets, work.young and work.mid based on the Age variable.<br>o work.young should contain observations with Age less than 40 years old.<br>o work.mid should contain observations with Age between 40 and 65 years old, inclusively.</p>
<p>There are multiple errors in the program. There may be syntax errors, logic errors, or problems with the program structure. Logic errors might not produce messages in the log, but will cause the program to produce results different than intended.</p>
<p>Correct the errors, run the program, and then use the results to answer the next 3 questions.<br>a. How many observations are in the mid data set?<br>b. What is the customerID for observation 14 in the young data set?<br>c. What is the average Age of the customers in the young data set?<br>Save your program as program41.sas before continuing with the next project.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* è¿™æ˜¯ä¸ªæœ‰errorçš„program */</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">data </span>Young Mid;</span><br><span class="line">   <span class="meta">set</span> cert.input41;</span><br><span class="line">   <span class="meta">if</span> Age &lt; 40 <span class="meta">then</span> <span class="meta">output</span> young;</span><br><span class="line">   <span class="meta">else</span> <span class="meta">if</span> age between 40 <span class="meta">and</span> 65 <span class="meta">then</span> <span class="meta">output</span> mid; <span class="comment">/* datasetä¸­æ²¡æœ‰betweençš„ç”¨æ³• */</span></span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="comment">/* å¾—è€è€å®å®çš„å†™ */</span></span><br><span class="line"><span class="comment">/* else if age&gt;=40 and age &lt;=65 then output mid; */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">title</span> <span class="string">&#x27;Customers less than 40&#x27;</span>;</span><br><span class="line"><span class="keyword">proc print </span>data=younger; <span class="comment">/* dataçš„åå­—æ˜¯young */</span></span><br><span class="line">    var CustomerID lastName Age;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">title</span> <span class="string">&#x27;Means for mid group&#x27;</span>;</span><br><span class="line"><span class="keyword">proc means </span>data=mid mean n maxdec=2;</span><br><span class="line">    var age;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">title</span> <span class="string">&#x27;Means for younger group&#x27;</span>;</span><br><span class="line"><span class="keyword">proc means </span>data=younger mean n maxdec=2; <span class="comment">/* dataçš„åå­—æ˜¯young */</span></span><br><span class="line">    var age;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="meta">title</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="6"><a href="#6" class="headerlink" title="6"></a>6</h2><p>Question 11</p>
<p>Open the existing program, program21.sas from the folder /home/kevin_7140/my_content/errors. At any time, you may save your corrected program.</p>
<p>This program is intended to split the cert.input21 data set into 4 separate data sets<br>â€¢ The beds data set should contain only observations where product value =â€™BEDâ€™.<br>â€¢ The chairs data set should contain only observations where product value=â€™CHAIRâ€™.<br>â€¢ The desks data set should contain only observations where product value =â€™DESKâ€™.<br>â€¢ The sofas data set should contain only observations where product value=â€™SOFAâ€™.<br>There are multiple errors in the program. There may be syntax errors, logic errors, or problems with the program structure. Logic errors might not produce messages in the log, but will cause the program to produce results different than intended.</p>
<p>Correct the errors, run the program, and then use the results to answer the next 3 questions.<br>a. How many observations are in the chairs data set?<br>b. How many observations are in the sofas data set?<br>c. What is value of variable Predict in observation 25 or the sofas data set?<br>Save your program as program21.sas in folder before continuing with next project.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* è¿™æ˜¯ä¸ªæœ‰errorçš„program */</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">data </span>beds chairs desks sofas;</span><br><span class="line">        <span class="meta">set</span> cert.input21;</span><br><span class="line">        <span class="meta">if</span> product=<span class="string">&#x27;Bed&#x27;</span> <span class="meta">then</span> <span class="meta">output</span>; <span class="comment">/* â€˜Bedâ€™å¾—æ”¹æˆâ€˜BEDâ€™ */</span></span><br><span class="line">        <span class="meta">if</span> product=<span class="string">&#x27;Chair&#x27;</span> <span class="meta">then</span> <span class="meta">output</span>;</span><br><span class="line">        <span class="meta">if</span> product=<span class="string">&#x27;Desk&#x27;</span> <span class="meta">then</span> <span class="meta">output</span>;</span><br><span class="line">        <span class="meta">else</span> <span class="meta">output</span> sofas;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">title</span> <span class="string">&#x27;Chairs Data Set&#x27;</span>;</span><br><span class="line"><span class="keyword">proc print </span>data=chairs;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* è®¢æ­£ */</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">data </span>beds chairs desks sofas;</span><br><span class="line">        <span class="meta">set</span> cert.input21;</span><br><span class="line">        <span class="meta">if</span> product=<span class="string">&#x27;BED&#x27;</span> <span class="meta">then</span> <span class="meta">output</span> beds;</span><br><span class="line">        <span class="meta">if</span> product=<span class="string">&#x27;CHAIR&#x27;</span> <span class="meta">then</span> <span class="meta">output</span> chairs;</span><br><span class="line">        <span class="meta">if</span> product=<span class="string">&#x27;DESK&#x27;</span> <span class="meta">then</span> <span class="meta">output</span> desks;</span><br><span class="line">        <span class="meta">if</span> product=<span class="string">&#x27;SOFAS&#x27;</span> <span class="meta">output</span> sofas; <span class="comment">/* ä¸ç„¶ä¼šåŠ å…¥å¤šä½™çš„ä¸œè¥¿è¿›sofas */</span></span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">title</span> <span class="string">&#x27;Chairs Data Set&#x27;</span>;</span><br><span class="line"><span class="keyword">proc print </span>data=chairs;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="7"><a href="#7" class="headerlink" title="7"></a>7</h2><p>Question 12</p>
<p>The following SAS program is submitted:</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">proc format;</span></span><br><span class="line">value score <span class="comment">/* formatåå­—å®šä¹‰çš„æ—¶å€™æ²¡æœ‰ç‚¹ */</span></span><br><span class="line">1 - 50 = <span class="string">&#x27;Fail&#x27;</span></span><br><span class="line">51 - 100 = <span class="string">&#x27;Pass&#x27;</span>;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="keyword">proc report </span>data = work.courses nowd;</span><br><span class="line">column exam;</span><br><span class="line">define exam / <span class="meta">display</span> <span class="meta">format</span> = score.; <span class="comment">/* ä½†ä½¿ç”¨çš„æ—¶å€™æœ‰ç‚¹ */</span></span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<p>The variable EXAM has a value of 50.5.<br>How will the EXAM variable value be displayed in the REPORT procedure output?<br>A. Fail<br>B. Pass<br>C. 50.5 /* é€‰cå› ä¸ºæ²¡æœ‰è¢«å®šä¹‰åˆ°format */<br>D. . (missing numeric value)</p>
<hr>
<h2 id="8"><a href="#8" class="headerlink" title="8"></a>8</h2><p>Question 13</p>
<p>The following SAS program is submitted:</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span>WORK.VOLUME;</span><br><span class="line">  <span class="meta">do</span> Year=1 to 7;</span><br><span class="line">    <span class="meta">do</span> Month=1 to 12;</span><br><span class="line">      <span class="meta">X</span> + 1;</span><br><span class="line">    <span class="meta">end</span>;</span><br><span class="line">  <span class="meta">end</span>;</span><br><span class="line">  <span class="comment">/* å› ä¸ºæ²¡æœ‰output,sasä¼šåœ¨runå‰é»˜è®¤ä¸€ä¸ªoutput */</span></span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<p>How many observations are written to the WORK.VOLUME data set?<br>A. 0<br>B. 1 /* é€‰æ‹©b */<br>C. 7<br>D. 84</p>
<hr>
<h2 id="9"><a href="#9" class="headerlink" title="9"></a>9</h2><p>Example 19:</p>
<p>This project will use data set cert.input19. At any time, you may save your program as program19.</p>
<p>Write a SAS program that will:<br>â€¢ Read cert.input19 as input.<br>â€¢ Create an output data set results.output19.<br>â€¢ Replace any firstName variable with a value of â€œWilliamâ€ to â€œWillâ€<br>â€¢ Combine variables firstName and lastName into a single variable called name that is in the form, â€œlastName,firstNameâ€, with no spaces.<br>â€¢ Create a variable len and set it equal to the number of characters in the name variable for each observation.<br>â€¢ Adjust the defined length the same as the longest occurrence of name and rerun the program.<br>â€¢ Extract the numeric portion of the CustomerID variable and save it in a new numeric variable named IDnumber. All CustomerID variables are in the form â€œCSTnnnnnâ€, where n=a number.<br>â€¢ Find any name variables that contain the letter â€œZâ€ or â€œzâ€. If found, set a new numeric variable Zflag=1, else set Zflag=0.</p>
<p>Run the program and use the results and additional SAS procedure steps to answer the next 4 questions.<br>a. What is the maximum value of the variable len?<br>b. What is the mean of the Age variable for observations with firstName= â€˜Willâ€™. Enter your numeric answer in the space below (Round your answer to the nearest 1 decimal place).<br>c. What is the mean of the IDnumber variable for all observations in the results.output19 data set? Enter your numeric answer in the space below (Round your answer to the nearest integer).<br>d. How many observations have Zflag set to 1?</p>
<p>Save your program as program19.sas in folder before continuing with the next project.</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data </span>results.output19;</span><br><span class="line"><span class="meta">length</span> name $18; <span class="comment">/* ä¸ºç æ‰catxé»˜è®¤é•¿åº¦ */</span></span><br><span class="line"><span class="meta">set</span> cert.input19;</span><br><span class="line"><span class="meta">if</span> firstname=<span class="string">&#x27;Willam&#x27;</span> <span class="meta">then</span> firstname=<span class="string">&#x27;Will&#x27;</span>; <span class="comment">/* firstname=tranwrd(firstname,&#x27;William&#x27;,&#x27;Will&#x27;); */</span></span><br><span class="line">name = catx(<span class="string">&#x27;,&#x27;</span>,lastname,firstname); <span class="comment">/* catxé»˜è®¤é•¿åº¦200 */</span></span><br><span class="line">len =<span class="meta"> length(</span>name);</span><br><span class="line">IDnumber =<span class="meta"> substr(</span>CustomerID,4,5)+0; <span class="comment">/* æ³¨æ„,è¿™é‡Œå¦‚æœæ²¡æœ‰åŠ 0å°±æ˜¯char value,åŠ äº†å°±æ˜¯numeric value */</span></span><br><span class="line"><span class="meta">if</span> find(name,<span class="string">&#x27;z&#x27;</span>,<span class="string">&#x27;i&#x27;</span>) ne 0 <span class="meta">then</span> Zflag = 1; <span class="comment">/* ne 0 means find it*/</span></span><br><span class="line"><span class="meta">else</span> Zflag = 0;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">proc mean </span>data=results.output19;</span><br><span class="line">var age;</span><br><span class="line"><span class="meta">where</span> firstName=<span class="string">&#x27;Will&#x27;</span>;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">proc mean </span>data=results.output19;</span><br><span class="line">var IDnumber;</span><br><span class="line"><span class="keyword">run;</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">proc mean </span>data=results.output19 sum;</span><br><span class="line">var Zflag;</span><br><span class="line"><span class="keyword">run;</span></span><br></pre></td></tr></table></figure>

<p>é™„åŠ ä¹‹<a target="_blank" rel="noopener" href="http://support.sas.com/kb/24/590.html">å…³äºconvert char to numeric</a>.</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/blog/tags/%E7%BC%96%E7%A0%81/" rel="tag"># ç¼–ç </a>
              <a href="/blog/tags/%E4%BB%A5%E5%A4%B4%E6%8A%A2%E5%9C%B0-%E8%AF%9A/" rel="tag"># ä»¥å¤´æŠ¢åœ°(è¯š)</a>
              <a href="/blog/tags/data/" rel="tag"># data</a>
              <a href="/blog/tags/SAS/" rel="tag"># SAS</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/blog/2021/10/05/P210/" rel="prev" title="å…³äºdataçš„ç¬”è®°2.0 - Week1(è¿è½½ä¸­)">
      <i class="fa fa-chevron-left"></i> å…³äºdataçš„ç¬”è®°2.0 - Week1(è¿è½½ä¸­)
    </a></div>
      <div class="post-nav-item">
    <a href="/blog/2021/10/03/P148/" rel="next" title="é›¨æœªå¯¹ä½ æ¥è¯´æ˜¯æ€æ ·çš„å­˜åœ¨?">
      é›¨æœªå¯¹ä½ æ¥è¯´æ˜¯æ€æ ·çš„å­˜åœ¨? <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Structure-of-SAS-program"><span class="nav-number">1.</span> <span class="nav-text">Structure of SAS program</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SAS-Data"><span class="nav-number">2.</span> <span class="nav-text">SAS Data</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Import"><span class="nav-number">2.1.</span> <span class="nav-text">Import</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Character-and-Numeric-variable"><span class="nav-number">2.2.</span> <span class="nav-text">Character and Numeric variable</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Missing-data"><span class="nav-number">2.3.</span> <span class="nav-text">Missing data</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SAS-date"><span class="nav-number">2.4.</span> <span class="nav-text">SAS date</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SAS-format"><span class="nav-number">2.5.</span> <span class="nav-text">SAS format</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#format"><span class="nav-number">2.6.</span> <span class="nav-text">format</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PROCs"><span class="nav-number">2.7.</span> <span class="nav-text">PROCs</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#function"><span class="nav-number">2.8.</span> <span class="nav-text">function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#control-data-step-flow"><span class="nav-number">2.9.</span> <span class="nav-text">control data step flow</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#combine"><span class="nav-number">2.10.</span> <span class="nav-text">combine</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Retain-and-Sum-Statement"><span class="nav-number">2.11.</span> <span class="nav-text">Retain and Sum Statement</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SAS-Automatic-Variables"><span class="nav-number">2.12.</span> <span class="nav-text">SAS Automatic Variables</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Macro"><span class="nav-number">3.</span> <span class="nav-text">Macro</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Macro-variable"><span class="nav-number">3.1.</span> <span class="nav-text">Macro variable</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Macro-Functions"><span class="nav-number">3.2.</span> <span class="nav-text">Macro Functions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Macros"><span class="nav-number">3.3.</span> <span class="nav-text">Macros</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Conditional-Processing-and-Iteration"><span class="nav-number">3.4.</span> <span class="nav-text">Conditional Processing and Iteration</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Scope-of-macro-variables-%E2%80%93-Global-and-Local"><span class="nav-number">3.5.</span> <span class="nav-text">Scope of macro variables â€“ Global and Local</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SQL"><span class="nav-number">4.</span> <span class="nav-text">SQL</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Array"><span class="nav-number">5.</span> <span class="nav-text">Array</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Creating-Functions-with-PROC-FCMP"><span class="nav-number">6.</span> <span class="nav-text">Creating Functions with PROC FCMP</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Index"><span class="nav-number">7.</span> <span class="nav-text">Index</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Hash-Object"><span class="nav-number">8.</span> <span class="nav-text">Hash Object</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Compressed-File"><span class="nav-number">9.</span> <span class="nav-text">Compressed File</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Dictionary-Tables"><span class="nav-number">10.</span> <span class="nav-text">Dictionary Tables</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Quiz-example"><span class="nav-number">11.</span> <span class="nav-text">Quiz example</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1"><span class="nav-number">11.1.</span> <span class="nav-text">1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2"><span class="nav-number">11.2.</span> <span class="nav-text">2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3"><span class="nav-number">11.3.</span> <span class="nav-text">3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4"><span class="nav-number">11.4.</span> <span class="nav-text">4</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5"><span class="nav-number">11.5.</span> <span class="nav-text">5</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6"><span class="nav-number">11.6.</span> <span class="nav-text">6</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7"><span class="nav-number">11.7.</span> <span class="nav-text">7</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8"><span class="nav-number">11.8.</span> <span class="nav-text">8</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9"><span class="nav-number">11.9.</span> <span class="nav-text">9</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Mazui"
      src="/blog/images/logo_6.png">
  <p class="site-author-name" itemprop="name">Mazui</p>
  <div class="site-description" itemprop="description">ä¸å­¤ç‹¬å’Œå¹³å…±å¤„.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives/">
        
          <span class="site-state-item-count">213</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/blog/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/blog/tags/">
          
        <span class="site-state-item-count">50</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:mazui.and.rio@gmail.com" title="E-Mail â†’ mailto:mazui.and.rio@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/3032131561?topnav=1&wvr=6&topsug=1&ssl_rnd=1606158448.6943&is_all=1" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;3032131561?topnav&#x3D;1&amp;wvr&#x3D;6&amp;topsug&#x3D;1&amp;ssl_rnd&#x3D;1606158448.6943&amp;is_all&#x3D;1" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/mazui_3" title="Twitter â†’ https:&#x2F;&#x2F;twitter.com&#x2F;mazui_3" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://instagram.com/mazui_3" title="Instagram â†’ https:&#x2F;&#x2F;instagram.com&#x2F;mazui_3" rel="noopener" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
      </span>
  </div>



      </div>

<br>
      <!--new music test-->

  <!--ç½‘æ˜“äº‘æ’ä»¶-->
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=465530020&auto=0&height=66"></iframe>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2015 â€“ 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mazui</span>

<!--
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>


    <span title="C">575k</span>
  -->

  <!--
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="T">8:43</span>

  -->

</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>
<br>
<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">ä¼‘æ¯å®¤ä¸€å…±æœ‰575kçš„è€å…”æ­£åœ¨æ‰“çŒç¡</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/blog/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/blog/lib/velocity/velocity.min.js"></script>
  <script src="/blog/lib/velocity/velocity.ui.min.js"></script>

<script src="/blog/js/utils.js"></script>

<script src="/blog/js/motion.js"></script>


<script src="/blog/js/schemes/pisces.js"></script>


<script src="/blog/js/next-boot.js"></script>




  




  
<script src="/blog/js/local-search.js"></script>













  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://mazui3-com.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://mazui3.com/blog/2021/10/05/P160/";
    this.page.identifier = "2021/10/05/P160/";
    this.page.title = "å…³äºSASçš„ç¬”è®°";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://mazui3-com.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
