<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/star.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/star.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/star.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/blog/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/blog/lib/pace/pace-theme-minimal.min.css">
  <script src="/blog/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"mazui3.github.io","root":"/blog/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","width":265,"display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":{"text":"Load Disqus","order":-1}},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="两年前,在炎热夏日的宿舍房间里初学写C.那时看到了这个游戏制作公开课,因为C都写得极其头大,打开三分钟决定搁置.上个月一看:卧槽这公开课今年截止.于是试图在死线前摸点笔记.">
<meta property="og:type" content="article">
<meta property="og:title" content="GD50 - Pong">
<meta property="og:url" content="https://mazui3.github.io/blog/2022/02/08/P224/index.html">
<meta property="og:site_name" content="Underlake Reading Room">
<meta property="og:description" content="两年前,在炎热夏日的宿舍房间里初学写C.那时看到了这个游戏制作公开课,因为C都写得极其头大,打开三分钟决定搁置.上个月一看:卧槽这公开课今年截止.于是试图在死线前摸点笔记.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://mazui3.github.io/blog/2022/02/08/P224/P224_1.png">
<meta property="og:image" content="https://mazui3.github.io/blog/2022/02/08/P224/P224_2.png">
<meta property="og:image" content="https://mazui3.github.io/blog/2022/02/08/P224/P224_3.png">
<meta property="og:image" content="https://mazui3.github.io/blog/2022/02/08/P224/P224_4.png">
<meta property="og:image" content="https://mazui3.github.io/blog/2022/02/08/P224/P224_4.png">
<meta property="article:published_time" content="2022-02-08T21:57:15.000Z">
<meta property="article:modified_time" content="2022-02-11T15:09:14.562Z">
<meta property="article:author" content="Mazui">
<meta property="article:tag" content="编码">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mazui3.github.io/blog/2022/02/08/P224/P224_1.png">

<link rel="canonical" href="https://mazui3.github.io/blog/2022/02/08/P224/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>GD50 - Pong | Underlake Reading Room</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Underlake Reading Room</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">这里是图书馆外的阅览室🌟</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/blog/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/blog/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/blog/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Schedule</a>

  </li>
        <li class="menu-item menu-item-friendlink">

    <a href="/blog/link/" rel="section"><i class="fas fa-user-friends fa-fw"></i>FriendLink</a>

  </li>
        <li class="menu-item menu-item-back">

    <a href="https://mazui3.github.io/" rel="section"><i class="fas fa-carrot fa-fw"></i>Back</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://mazui3.github.io/blog/2022/02/08/P224/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/logo_7.png">
      <meta itemprop="name" content="Mazui">
      <meta itemprop="description" content="与孤独和平共处.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Underlake Reading Room">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          GD50 - Pong
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-02-08 16:57:15" itemprop="dateCreated datePublished" datetime="2022-02-08T16:57:15-05:00">2022-02-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-11 10:09:14" itemprop="dateModified" datetime="2022-02-11T10:09:14-05:00">2022-02-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/GameDev%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">GameDev笔记</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/blog/2022/02/08/P224/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2022/02/08/P224/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
            <span class="post-meta-item" title="C">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>62k</span>
            </span>
            <span class="post-meta-item" title="T">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>56 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>两年前,在炎热夏日的宿舍房间里初学写C.<br>那时看到了这个<a target="_blank" rel="noopener" href="https://learning.edx.org/course/course-v1:HarvardX+CS50G+Games/home">游戏制作公开课</a>,因为C都写得极其头大,打开三分钟决定搁置.<br>上个月一看:卧槽这公开课今年截止.<br>于是试图在死线前摸点笔记.</p>
<span id="more"></span>

<p>第一个project是经典小游戏Pong,附录<a target="_blank" rel="noopener" href="https://github.com/games50/pong">Github代码</a>.</p>
<br>
<br>
<br>

<h1 id="0"><a href="#0" class="headerlink" title="0"></a>0</h1><p>这个课程使用的是lua语言,run游戏的是love 2D.</p>
<p><a target="_blank" rel="noopener" href="https://love2d.org/#download">Download</a>&amp;<a target="_blank" rel="noopener" href="https://love2d.org/wiki/Getting_Started">Getting Started</a></p>
<p>摸了一下还是直接drag的方式最方便run.</p>
<blockquote>
<p>Otherwise, the easiest way to run the game is to drag the folder onto either love.exe or a shortcut to love.exe. Remember to drag the folder containing main.lua, and not main.lua itself.</p>
</blockquote>
<img src="/blog/2022/02/08/P224/P224_1.png" class="" title="写unity的时候倒是摸过这个loop">

<img src="/blog/2022/02/08/P224/P224_2.png" class="" title="y轴竟然是反的">

<h2 id="function"><a href="#function" class="headerlink" title="function"></a>function</h2><p>love.load()</p>
<ul>
<li>Used for initializing our game state at the very beginning of program execution. Load function肯定自带有,这是overwrite初始function. Love2D默认read main.lua file.</li>
</ul>
<p>love.update(dt) - dt:delta time</p>
<ul>
<li>Called each frame by LÖVE; dt will be the elapsed time in seconds since the last frame, and we can use this to scale any changes in our game for even behavior across frame rates.</li>
</ul>
<p>love.draw()</p>
<ul>
<li>Called each frame by LÖVE after update for drawing things to the screen once they’ve changed.</li>
</ul>
<p>LÖVE2D expects these functions to be implemented in main.lua and calls them internally; if we don’t define them, it will still function, but our game will be fundamentally incomplete, at least if update or draw are missing!</p>
<p>love.graphics.printf(text, x, y, [width], [align])</p>
<ul>
<li>Versatile print function that can align text left, right, or center on the screen.</li>
</ul>
<p>love.window.setMode(width, height, params)</p>
<ul>
<li>Used to initialize the window’s dimensions and to set parameters like vsync (vertical sync), whether we’re fullscreen or not, and whether the window is resizable after startup. Won’t be using past this example in favor of the push virtual resolution library, which has its own method like this, but useful to know if encountered in other code.</li>
</ul>
<h2 id="source-code"><a href="#source-code" class="headerlink" title="source code"></a>source code</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    GD50 2018</span></span><br><span class="line"><span class="comment">    Pong Remake</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    pong-0</span></span><br><span class="line"><span class="comment">    &quot;The Day-0 Update&quot;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    -- Main Program --</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"></span><br><span class="line">WINDOW_WIDTH = <span class="number">1280</span></span><br><span class="line">WINDOW_HEIGHT = <span class="number">720</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Runs when the game first starts up, only once; used to initialize the game.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.load</span><span class="params">()</span></span></span><br><span class="line">    love.window.setMode(WINDOW_WIDTH, WINDOW_HEIGHT, &#123;</span><br><span class="line">        fullscreen = <span class="literal">false</span>,</span><br><span class="line">        resizable = <span class="literal">false</span>,</span><br><span class="line">        vsync = <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Called after update by LÖVE2D, used to draw anything to the screen, updated or otherwise.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.draw</span><span class="params">()</span></span></span><br><span class="line">    love.graphics.printf(</span><br><span class="line">        <span class="string">&#x27;Hello Pong!&#x27;</span>,          <span class="comment">-- text to render</span></span><br><span class="line">        <span class="number">0</span>,                      <span class="comment">-- starting X (0 since we&#x27;re going to center it based on width)</span></span><br><span class="line">        WINDOW_HEIGHT / <span class="number">2</span> - <span class="number">6</span>,  <span class="comment">-- starting Y (halfway down the screen)</span></span><br><span class="line">        WINDOW_WIDTH,           <span class="comment">-- number of pixels to center within (the entire screen here)</span></span><br><span class="line">        <span class="string">&#x27;center&#x27;</span>)               <span class="comment">-- alignment mode, can be &#x27;center&#x27;, &#x27;left&#x27;, or &#x27;right&#x27;</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h1 id="1"><a href="#1" class="headerlink" title="1"></a>1</h1><p>下一步更改了resolution.</p>
<h2 id="function-1"><a href="#function-1" class="headerlink" title="function"></a>function</h2><p>love.graphics.setDefaultFilter(min, mag)</p>
<ul>
<li>Sets the texture scaling filter when minimizing and magnifying textures and fonts; default is bilinear, which causes blurriness, and for our use cases we will typically want nearest-neighbor filtering (‘nearest’), which results in perfect pixel upscaling and downscaling, simulating a retro feel.<br>当love2D run text or image的时候,会apply一个default filter.</li>
</ul>
<p>love.keypressed(key)</p>
<ul>
<li>A LÖVE2D callback function that executes whenever we press a key, assuming we’ve implemented this in our main.lua, in the same vein as love.load(), love.update(dt), and love.draw().</li>
</ul>
<p>love.event.quit()</p>
<ul>
<li>Simple function that terminates the application.</li>
</ul>
<img src="/blog/2022/02/08/P224/P224_3.png" class="">

<h2 id="source-code-1"><a href="#source-code-1" class="headerlink" title="source code"></a>source code</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    GD50 2018</span></span><br><span class="line"><span class="comment">    Pong Remake</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    pong-1</span></span><br><span class="line"><span class="comment">    &quot;The Low-Res Update&quot;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    -- Main Program --</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- push is a library that will allow us to draw our game at a virtual</span></span><br><span class="line"><span class="comment">-- resolution, instead of however large our window is; used to provide</span></span><br><span class="line"><span class="comment">-- a more retro aesthetic</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- https://github.com/Ulydev/push</span></span><br><span class="line"><span class="comment">-- 导入library</span></span><br><span class="line"></span><br><span class="line">push = <span class="built_in">require</span> <span class="string">&#x27;push&#x27;</span></span><br><span class="line"></span><br><span class="line">WINDOW_WIDTH = <span class="number">1280</span></span><br><span class="line">WINDOW_HEIGHT = <span class="number">720</span></span><br><span class="line"></span><br><span class="line">VIRTUAL_WIDTH = <span class="number">432</span></span><br><span class="line">VIRTUAL_HEIGHT = <span class="number">243</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 这一步是原本432*243大小的图像之后render成 1280*720,看起来像老游戏</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Runs when the game first starts up, only once; used to initialize the game.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.load</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">-- use nearest-neighbor filtering on upscaling and downscaling to prevent blurring of text</span></span><br><span class="line">    <span class="comment">-- and graphics; try removing this function to see the difference!</span></span><br><span class="line">    love.graphics.setDefaultFilter(<span class="string">&#x27;nearest&#x27;</span>, <span class="string">&#x27;nearest&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- initialize our virtual resolution, which will be rendered within our</span></span><br><span class="line">    <span class="comment">-- actual window no matter its dimensions; replaces our love.window.setMode call</span></span><br><span class="line">    <span class="comment">-- from the last example</span></span><br><span class="line">    push:setupScreen(VIRTUAL_WIDTH, VIRTUAL_HEIGHT, WINDOW_WIDTH, WINDOW_HEIGHT, &#123;</span><br><span class="line">        fullscreen = <span class="literal">false</span>,</span><br><span class="line">        resizable = <span class="literal">false</span>,</span><br><span class="line">        vsync = <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Keyboard handling, called by LÖVE2D each frame;</span></span><br><span class="line"><span class="comment">    passes in the key we pressed so we can access.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.keypressed</span><span class="params">(key)</span></span></span><br><span class="line">    <span class="comment">-- keys can be accessed by string name</span></span><br><span class="line">    <span class="keyword">if</span> key == <span class="string">&#x27;escape&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- function LÖVE gives us to terminate application</span></span><br><span class="line">        love.event.quit()</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Called after update by LÖVE2D, used to draw anything to the screen,</span></span><br><span class="line"><span class="comment">    updated or otherwise.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.draw</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">-- begin rendering at virtual resolution</span></span><br><span class="line">    push:apply(<span class="string">&#x27;start&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- condensed onto one line from last example</span></span><br><span class="line">    <span class="comment">-- note we are now using virtual width and height now for text placement</span></span><br><span class="line">    love.graphics.printf(<span class="string">&#x27;Hello Pong!&#x27;</span>, <span class="number">0</span>, VIRTUAL_HEIGHT / <span class="number">2</span> - <span class="number">6</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- end rendering at virtual resolution</span></span><br><span class="line">    push:apply(<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这个folder下有两个file.<br>上文是main.lua ,下文是push.lua .</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- push.lua v0.4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- Copyright (c) 2020 Ulysse Ramage</span></span><br><span class="line"><span class="comment">-- Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the &quot;Software&quot;), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</span></span><br><span class="line"><span class="comment">-- The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</span></span><br><span class="line"><span class="comment">-- THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> love11 = love.getVersion() == <span class="number">11</span></span><br><span class="line"><span class="keyword">local</span> getDPI = love11 <span class="keyword">and</span> love.window.getDPIScale <span class="keyword">or</span> love.window.getPixelScale</span><br><span class="line"><span class="keyword">local</span> windowUpdateMode = love11 <span class="keyword">and</span> love.window.updateMode <span class="keyword">or</span> <span class="function"><span class="keyword">function</span><span class="params">(width, height, settings)</span></span></span><br><span class="line">  <span class="keyword">local</span> _, _, flags = love.window.getMode()</span><br><span class="line">  <span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(settings) <span class="keyword">do</span> flags[k] = v <span class="keyword">end</span></span><br><span class="line">  love.window.setMode(width, height, flags)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> push = &#123;</span><br><span class="line"></span><br><span class="line">  defaults = &#123;</span><br><span class="line">    fullscreen = <span class="literal">false</span>,</span><br><span class="line">    resizable = <span class="literal">false</span>,</span><br><span class="line">    pixelperfect = <span class="literal">false</span>,</span><br><span class="line">    highdpi = <span class="literal">true</span>,</span><br><span class="line">    canvas = <span class="literal">true</span>,</span><br><span class="line">    stencil = <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">setmetatable</span>(push, push)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:applySettings</span><span class="params">(settings)</span></span></span><br><span class="line">  <span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(settings) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">self</span>[<span class="string">&quot;_&quot;</span> .. k] = v</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:resetSettings</span><span class="params">()</span></span> <span class="keyword">return</span> <span class="built_in">self</span>:applySettings(<span class="built_in">self</span>.defaults) <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:setupScreen</span><span class="params">(WWIDTH, WHEIGHT, RWIDTH, RHEIGHT, settings)</span></span></span><br><span class="line"></span><br><span class="line">  settings = settings <span class="keyword">or</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">self</span>._WWIDTH, <span class="built_in">self</span>._WHEIGHT = WWIDTH, WHEIGHT</span><br><span class="line">  <span class="built_in">self</span>._RWIDTH, <span class="built_in">self</span>._RHEIGHT = RWIDTH, RHEIGHT</span><br><span class="line"></span><br><span class="line">  <span class="built_in">self</span>:applySettings(<span class="built_in">self</span>.defaults) <span class="comment">--set defaults first</span></span><br><span class="line">  <span class="built_in">self</span>:applySettings(settings) <span class="comment">--then fill with custom settings</span></span><br><span class="line"></span><br><span class="line">  windowUpdateMode(<span class="built_in">self</span>._RWIDTH, <span class="built_in">self</span>._RHEIGHT, &#123;</span><br><span class="line">    fullscreen = <span class="built_in">self</span>._fullscreen,</span><br><span class="line">    resizable = <span class="built_in">self</span>._resizable,</span><br><span class="line">    highdpi = <span class="built_in">self</span>._highdpi</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">self</span>:initValues()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">self</span>._canvas <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">self</span>:setupCanvas(&#123; <span class="string">&quot;default&quot;</span> &#125;) <span class="comment">--setup canvas</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">self</span>._borderColor = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">self</span>._drawFunctions = &#123;</span><br><span class="line">    [<span class="string">&quot;start&quot;</span>] = <span class="built_in">self</span>.start,</span><br><span class="line">    [<span class="string">&quot;end&quot;</span>] = <span class="built_in">self</span>.finish</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">self</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:setupCanvas</span><span class="params">(canvases)</span></span></span><br><span class="line">  <span class="built_in">table</span>.<span class="built_in">insert</span>(canvases, &#123; name = <span class="string">&quot;_render&quot;</span>, private = <span class="literal">true</span> &#125;) <span class="comment">--final render</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">self</span>._canvas = <span class="literal">true</span></span><br><span class="line">  <span class="built_in">self</span>.canvases = &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i = <span class="number">1</span>, #canvases <span class="keyword">do</span></span><br><span class="line">    push:addCanvas(canvases[i])</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">self</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:addCanvas</span><span class="params">(params)</span></span></span><br><span class="line">  <span class="built_in">table</span>.<span class="built_in">insert</span>(<span class="built_in">self</span>.canvases, &#123;</span><br><span class="line">    name = params.name,</span><br><span class="line">    private = params.private,</span><br><span class="line">    shader = params.shader,</span><br><span class="line">    canvas = love.graphics.newCanvas(<span class="built_in">self</span>._WWIDTH, <span class="built_in">self</span>._WHEIGHT),</span><br><span class="line">    stencil = params.stencil <span class="keyword">or</span> <span class="built_in">self</span>._stencil</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:setCanvas</span><span class="params">(name)</span></span></span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">self</span>._canvas <span class="keyword">then</span> <span class="keyword">return</span> <span class="literal">true</span> <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">local</span> canvasTable = <span class="built_in">self</span>:getCanvasTable(name)</span><br><span class="line">  <span class="keyword">return</span> love.graphics.setCanvas(&#123; canvasTable.canvas, stencil = canvasTable.stencil &#125;)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:getCanvasTable</span><span class="params">(name)</span></span></span><br><span class="line">  <span class="keyword">for</span> i = <span class="number">1</span>, #<span class="built_in">self</span>.canvases <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">self</span>.canvases[i].name == name <span class="keyword">then</span></span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">self</span>.canvases[i]</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:setShader</span><span class="params">(name, shader)</span></span></span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span> shader <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">self</span>:getCanvasTable(<span class="string">&quot;_render&quot;</span>).shader = name</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">self</span>:getCanvasTable(name).shader = shader</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:initValues</span><span class="params">()</span></span></span><br><span class="line">  <span class="built_in">self</span>._PSCALE = (<span class="keyword">not</span> love11 <span class="keyword">and</span> <span class="built_in">self</span>._highdpi) <span class="keyword">and</span> getDPI() <span class="keyword">or</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">self</span>._SCALE = &#123;</span><br><span class="line">    x = <span class="built_in">self</span>._RWIDTH/<span class="built_in">self</span>._WWIDTH * <span class="built_in">self</span>._PSCALE,</span><br><span class="line">    y = <span class="built_in">self</span>._RHEIGHT/<span class="built_in">self</span>._WHEIGHT * <span class="built_in">self</span>._PSCALE</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">self</span>._stretched <span class="keyword">then</span> <span class="comment">--if stretched, no need to apply offset</span></span><br><span class="line">    <span class="built_in">self</span>._OFFSET = &#123;x = <span class="number">0</span>, y = <span class="number">0</span>&#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">local</span> scale = <span class="built_in">math</span>.<span class="built_in">min</span>(<span class="built_in">self</span>._SCALE.x, <span class="built_in">self</span>._SCALE.y)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">self</span>._pixelperfect <span class="keyword">then</span> scale = <span class="built_in">math</span>.<span class="built_in">floor</span>(scale) <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">self</span>._OFFSET = &#123;x = (<span class="built_in">self</span>._SCALE.x - scale) * (<span class="built_in">self</span>._WWIDTH/<span class="number">2</span>), y = (<span class="built_in">self</span>._SCALE.y - scale) * (<span class="built_in">self</span>._WHEIGHT/<span class="number">2</span>)&#125;</span><br><span class="line">    <span class="built_in">self</span>._SCALE.x, <span class="built_in">self</span>._SCALE.y = scale, scale <span class="comment">--apply same scale to X and Y</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">self</span>._GWIDTH = <span class="built_in">self</span>._RWIDTH * <span class="built_in">self</span>._PSCALE - <span class="built_in">self</span>._OFFSET.x * <span class="number">2</span></span><br><span class="line">  <span class="built_in">self</span>._GHEIGHT = <span class="built_in">self</span>._RHEIGHT * <span class="built_in">self</span>._PSCALE - <span class="built_in">self</span>._OFFSET.y * <span class="number">2</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:apply</span><span class="params">(operation, shader)</span></span></span><br><span class="line">  <span class="built_in">self</span>._drawFunctions[operation](<span class="built_in">self</span>, shader)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:start</span><span class="params">()</span></span></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">self</span>._canvas <span class="keyword">then</span></span><br><span class="line">    love.graphics.push()</span><br><span class="line">    love.graphics.setCanvas(&#123; <span class="built_in">self</span>.canvases[<span class="number">1</span>].canvas, stencil = <span class="built_in">self</span>.canvases[<span class="number">1</span>].stencil &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    love.graphics.translate(<span class="built_in">self</span>._OFFSET.x, <span class="built_in">self</span>._OFFSET.y)</span><br><span class="line">    love.graphics.setScissor(<span class="built_in">self</span>._OFFSET.x, <span class="built_in">self</span>._OFFSET.y, <span class="built_in">self</span>._WWIDTH*<span class="built_in">self</span>._SCALE.x, <span class="built_in">self</span>._WHEIGHT*<span class="built_in">self</span>._SCALE.y)</span><br><span class="line">    love.graphics.push()</span><br><span class="line">    love.graphics.scale(<span class="built_in">self</span>._SCALE.x, <span class="built_in">self</span>._SCALE.y)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:applyShaders</span><span class="params">(canvas, shaders)</span></span></span><br><span class="line">  <span class="keyword">local</span> _shader = love.graphics.getShader()</span><br><span class="line">  <span class="keyword">if</span> #shaders &lt;= <span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">    love.graphics.setShader(shaders[<span class="number">1</span>])</span><br><span class="line">    love.graphics.draw(canvas)</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">local</span> _canvas = love.graphics.getCanvas()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">local</span> _tmp = <span class="built_in">self</span>:getCanvasTable(<span class="string">&quot;_tmp&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> _tmp <span class="keyword">then</span> <span class="comment">--create temp canvas only if needed</span></span><br><span class="line">      <span class="built_in">self</span>:addCanvas(&#123; name = <span class="string">&quot;_tmp&quot;</span>, private = <span class="literal">true</span>, shader = <span class="literal">nil</span> &#125;)</span><br><span class="line">      _tmp = <span class="built_in">self</span>:getCanvasTable(<span class="string">&quot;_tmp&quot;</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    love.graphics.push()</span><br><span class="line">    love.graphics.origin()</span><br><span class="line">    <span class="keyword">local</span> outputCanvas</span><br><span class="line">    <span class="keyword">for</span> i = <span class="number">1</span>, #shaders <span class="keyword">do</span></span><br><span class="line">      <span class="keyword">local</span> inputCanvas = i % <span class="number">2</span> == <span class="number">1</span> <span class="keyword">and</span> canvas <span class="keyword">or</span> _tmp.canvas</span><br><span class="line">      outputCanvas = i % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">and</span> canvas <span class="keyword">or</span> _tmp.canvas</span><br><span class="line">      love.graphics.setCanvas(outputCanvas)</span><br><span class="line">      love.graphics.clear()</span><br><span class="line">      love.graphics.setShader(shaders[i])</span><br><span class="line">      love.graphics.draw(inputCanvas)</span><br><span class="line">      love.graphics.setCanvas(inputCanvas)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    love.graphics.pop()</span><br><span class="line"></span><br><span class="line">    love.graphics.setCanvas(_canvas)</span><br><span class="line">    love.graphics.draw(outputCanvas)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  love.graphics.setShader(_shader)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:finish</span><span class="params">(shader)</span></span></span><br><span class="line">  love.graphics.setBackgroundColor(<span class="built_in">unpack</span>(<span class="built_in">self</span>._borderColor))</span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">self</span>._canvas <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">local</span> _render = <span class="built_in">self</span>:getCanvasTable(<span class="string">&quot;_render&quot;</span>)</span><br><span class="line"></span><br><span class="line">    love.graphics.pop()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">local</span> white = love11 <span class="keyword">and</span> <span class="number">1</span> <span class="keyword">or</span> <span class="number">255</span></span><br><span class="line">    love.graphics.setColor(white, white, white)</span><br><span class="line"></span><br><span class="line">    <span class="comment">--draw canvas</span></span><br><span class="line">    love.graphics.setCanvas(_render.canvas)</span><br><span class="line">    <span class="keyword">for</span> i = <span class="number">1</span>, #<span class="built_in">self</span>.canvases <span class="keyword">do</span> <span class="comment">--do not draw _render yet</span></span><br><span class="line">      <span class="keyword">local</span> _table = <span class="built_in">self</span>.canvases[i]</span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">not</span> _table.private <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">local</span> _canvas = _table.canvas</span><br><span class="line">        <span class="keyword">local</span> _shader = _table.shader</span><br><span class="line">        <span class="built_in">self</span>:applyShaders(_canvas, <span class="built_in">type</span>(_shader) == <span class="string">&quot;table&quot;</span> <span class="keyword">and</span> _shader <span class="keyword">or</span> &#123; _shader &#125;)</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    love.graphics.setCanvas()</span><br><span class="line"></span><br><span class="line">    <span class="comment">--draw render</span></span><br><span class="line">    love.graphics.translate(<span class="built_in">self</span>._OFFSET.x, <span class="built_in">self</span>._OFFSET.y)</span><br><span class="line">    <span class="keyword">local</span> shader = shader <span class="keyword">or</span> _render.shader</span><br><span class="line">    love.graphics.push()</span><br><span class="line">    love.graphics.scale(<span class="built_in">self</span>._SCALE.x, <span class="built_in">self</span>._SCALE.y)</span><br><span class="line">    <span class="built_in">self</span>:applyShaders(_render.canvas, <span class="built_in">type</span>(shader) == <span class="string">&quot;table&quot;</span> <span class="keyword">and</span> shader <span class="keyword">or</span> &#123; shader &#125;)</span><br><span class="line">    love.graphics.pop()</span><br><span class="line"></span><br><span class="line">    <span class="comment">--clear canvas</span></span><br><span class="line">    <span class="keyword">for</span> i = <span class="number">1</span>, #<span class="built_in">self</span>.canvases <span class="keyword">do</span></span><br><span class="line">      love.graphics.setCanvas(<span class="built_in">self</span>.canvases[i].canvas)</span><br><span class="line">      love.graphics.clear()</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    love.graphics.setCanvas()</span><br><span class="line">    love.graphics.setShader()</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    love.graphics.pop()</span><br><span class="line">    love.graphics.setScissor()</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:setBorderColor</span><span class="params">(color, g, b)</span></span></span><br><span class="line">  <span class="built_in">self</span>._borderColor = g <span class="keyword">and</span> &#123;color, g, b&#125; <span class="keyword">or</span> color</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:toGame</span><span class="params">(x, y)</span></span></span><br><span class="line">  x, y = x - <span class="built_in">self</span>._OFFSET.x, y - <span class="built_in">self</span>._OFFSET.y</span><br><span class="line">  <span class="keyword">local</span> normalX, normalY = x / <span class="built_in">self</span>._GWIDTH, y / <span class="built_in">self</span>._GHEIGHT</span><br><span class="line"></span><br><span class="line">  x = (x &gt;= <span class="number">0</span> <span class="keyword">and</span> x &lt;= <span class="built_in">self</span>._WWIDTH * <span class="built_in">self</span>._SCALE.x) <span class="keyword">and</span> normalX * <span class="built_in">self</span>._WWIDTH <span class="keyword">or</span> <span class="literal">nil</span></span><br><span class="line">  y = (y &gt;= <span class="number">0</span> <span class="keyword">and</span> y &lt;= <span class="built_in">self</span>._WHEIGHT * <span class="built_in">self</span>._SCALE.y) <span class="keyword">and</span> normalY * <span class="built_in">self</span>._WHEIGHT <span class="keyword">or</span> <span class="literal">nil</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> x, y</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--doesn&#x27;t work - TODO</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:toReal</span><span class="params">(x, y)</span></span></span><br><span class="line">  <span class="keyword">return</span> x + <span class="built_in">self</span>._OFFSET.x, y + <span class="built_in">self</span>._OFFSET.y</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:switchFullscreen</span><span class="params">(winw, winh)</span></span></span><br><span class="line">  <span class="built_in">self</span>._fullscreen = <span class="keyword">not</span> <span class="built_in">self</span>._fullscreen</span><br><span class="line">  <span class="keyword">local</span> windowWidth, windowHeight = love.window.getDesktopDimensions()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">self</span>._fullscreen <span class="keyword">then</span> <span class="comment">--save windowed dimensions for later</span></span><br><span class="line">    <span class="built_in">self</span>._WINWIDTH, <span class="built_in">self</span>._WINHEIGHT = <span class="built_in">self</span>._RWIDTH, <span class="built_in">self</span>._RHEIGHT</span><br><span class="line">  <span class="keyword">elseif</span> <span class="keyword">not</span> <span class="built_in">self</span>._WINWIDTH <span class="keyword">or</span> <span class="keyword">not</span> <span class="built_in">self</span>._WINHEIGHT <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">self</span>._WINWIDTH, <span class="built_in">self</span>._WINHEIGHT = windowWidth * <span class="number">.5</span>, windowHeight * <span class="number">.5</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">self</span>._RWIDTH = <span class="built_in">self</span>._fullscreen <span class="keyword">and</span> windowWidth <span class="keyword">or</span> winw <span class="keyword">or</span> <span class="built_in">self</span>._WINWIDTH</span><br><span class="line">  <span class="built_in">self</span>._RHEIGHT = <span class="built_in">self</span>._fullscreen <span class="keyword">and</span> windowHeight <span class="keyword">or</span> winh <span class="keyword">or</span> <span class="built_in">self</span>._WINHEIGHT</span><br><span class="line"></span><br><span class="line">  <span class="built_in">self</span>:initValues()</span><br><span class="line"></span><br><span class="line">  love.window.setFullscreen(<span class="built_in">self</span>._fullscreen, <span class="string">&quot;desktop&quot;</span>)</span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">self</span>._fullscreen <span class="keyword">and</span> (winw <span class="keyword">or</span> winh) <span class="keyword">then</span></span><br><span class="line">    windowUpdateMode(<span class="built_in">self</span>._RWIDTH, <span class="built_in">self</span>._RHEIGHT) <span class="comment">--set window dimensions</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:resize</span><span class="params">(w, h)</span></span></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">self</span>._highdpi <span class="keyword">then</span> w, h = w / <span class="built_in">self</span>._PSCALE, h / <span class="built_in">self</span>._PSCALE <span class="keyword">end</span></span><br><span class="line">  <span class="built_in">self</span>._RWIDTH = w</span><br><span class="line">  <span class="built_in">self</span>._RHEIGHT = h</span><br><span class="line">  <span class="built_in">self</span>:initValues()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:getWidth</span><span class="params">()</span></span> <span class="keyword">return</span> <span class="built_in">self</span>._WWIDTH <span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:getHeight</span><span class="params">()</span></span> <span class="keyword">return</span> <span class="built_in">self</span>._WHEIGHT <span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push:getDimensions</span><span class="params">()</span></span> <span class="keyword">return</span> <span class="built_in">self</span>._WWIDTH, <span class="built_in">self</span>._WHEIGHT <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> push</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h1 id="2"><a href="#2" class="headerlink" title="2"></a>2</h1><p>画出paddle和球.</p>
<h2 id="function-2"><a href="#function-2" class="headerlink" title="function"></a>function</h2><p>love.graphics.newFont(path, size)</p>
<ul>
<li>Loads a font file into memory at a specific path, setting it to a specific size, and storing it in an object we can use to globally change the currently active font that LÖVE2D is using to render text (functioning like a state machine). Deafult is Arial.</li>
</ul>
<p>love.graphics.setFont(font)</p>
<ul>
<li>Sets LÖVE2D’s currently active font (of which there can only be one at a time) to a passed-in font object that we can create using love.graphics.newFont.</li>
</ul>
<p>love.graphics.clear(r, g, b, a)</p>
<ul>
<li>Wipes the entire screen with a color defined by an RGBA set, each component of which being from 0-255.</li>
</ul>
<p>love.graphics.rectangle(mode, x, y, width, height)</p>
<ul>
<li>Draws a rectangle onto the screen using whichever our active color is (love.graphics.setColor, which we don’t need to use in this particular project since most everything is white, the default LÖVE2D color). mode can be set to ‘fill’ or ‘line’, which result in a filled or outlined rectangle, respectively, and the other four parameters are its position and size dimensions. This is the cornerstone drawing function of the entirety of our Pong implementation!</li>
</ul>
<h2 id="source-code-2"><a href="#source-code-2" class="headerlink" title="source code"></a>source code</h2><p>这次文件夹下有main.lua, push.lua and font.ttf .</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    GD50 2018</span></span><br><span class="line"><span class="comment">    Pong Remake</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    pong-2</span></span><br><span class="line"><span class="comment">    &quot;The Rectangle Update&quot;</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- push is a library that will allow us to draw our game at a virtual</span></span><br><span class="line"><span class="comment">-- resolution, instead of however large our window is; used to provide</span></span><br><span class="line"><span class="comment">-- a more retro aesthetic</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- https://github.com/Ulydev/push</span></span><br><span class="line">push = <span class="built_in">require</span> <span class="string">&#x27;push&#x27;</span></span><br><span class="line"></span><br><span class="line">WINDOW_WIDTH = <span class="number">1280</span></span><br><span class="line">WINDOW_HEIGHT = <span class="number">720</span></span><br><span class="line"></span><br><span class="line">VIRTUAL_WIDTH = <span class="number">432</span></span><br><span class="line">VIRTUAL_HEIGHT = <span class="number">243</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Runs when the game first starts up, only once; used to initialize the game.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.load</span><span class="params">()</span></span></span><br><span class="line">    love.graphics.setDefaultFilter(<span class="string">&#x27;nearest&#x27;</span>, <span class="string">&#x27;nearest&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- more &quot;retro-looking&quot; font object we can use for any text</span></span><br><span class="line">    smallFont = love.graphics.newFont(<span class="string">&#x27;font.ttf&#x27;</span>, <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- set LÖVE2D&#x27;s active font to the smallFont obect</span></span><br><span class="line">    love.graphics.setFont(smallFont)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- initialize window with virtual resolution</span></span><br><span class="line">    push:setupScreen(VIRTUAL_WIDTH, VIRTUAL_HEIGHT, WINDOW_WIDTH, WINDOW_HEIGHT, &#123;</span><br><span class="line">        fullscreen = <span class="literal">false</span>,</span><br><span class="line">        resizable = <span class="literal">false</span>,</span><br><span class="line">        vsync = <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Keyboard handling, called by LÖVE2D each frame;</span></span><br><span class="line"><span class="comment">    passes in the key we pressed so we can access.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.keypressed</span><span class="params">(key)</span></span></span><br><span class="line">    <span class="comment">-- keys can be accessed by string name</span></span><br><span class="line">    <span class="keyword">if</span> key == <span class="string">&#x27;escape&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- function LÖVE gives us to terminate application</span></span><br><span class="line">        love.event.quit()</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Called after update by LÖVE2D, used to draw anything to the screen,</span></span><br><span class="line"><span class="comment">    updated or otherwise.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.draw</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">-- begin rendering at virtual resolution</span></span><br><span class="line">    push:apply(<span class="string">&#x27;start&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- clear the screen with a specific color; in this case, a color similar</span></span><br><span class="line">    <span class="comment">-- to some versions of the original Pong</span></span><br><span class="line">    love.graphics.clear(<span class="number">40</span>/<span class="number">255</span>, <span class="number">45</span>/<span class="number">255</span>, <span class="number">52</span>/<span class="number">255</span>, <span class="number">255</span>/<span class="number">255</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- draw welcome text toward the top of the screen</span></span><br><span class="line">    love.graphics.printf(<span class="string">&#x27;Hello Pong!&#x27;</span>, <span class="number">0</span>, <span class="number">20</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">--</span></span><br><span class="line">    <span class="comment">-- paddles are simply rectangles we draw on the screen at certain points,</span></span><br><span class="line">    <span class="comment">-- as is the ball</span></span><br><span class="line">    <span class="comment">--</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- render first paddle (left side)</span></span><br><span class="line">    love.graphics.rectangle(<span class="string">&#x27;fill&#x27;</span>, <span class="number">10</span>, <span class="number">30</span>, <span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- render second paddle (right side)</span></span><br><span class="line">    love.graphics.rectangle(<span class="string">&#x27;fill&#x27;</span>, VIRTUAL_WIDTH - <span class="number">10</span>, VIRTUAL_HEIGHT - <span class="number">50</span>, <span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- render ball (center) 减2是因为ball本身有2 pixel</span></span><br><span class="line">    love.graphics.rectangle(<span class="string">&#x27;fill&#x27;</span>, VIRTUAL_WIDTH / <span class="number">2</span> - <span class="number">2</span>, VIRTUAL_HEIGHT / <span class="number">2</span> - <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- end rendering at virtual resolution</span></span><br><span class="line">    push:apply(<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h1 id="3"><a href="#3" class="headerlink" title="3"></a>3</h1><p>让paddle动起来!</p>
<h2 id="function-3"><a href="#function-3" class="headerlink" title="function"></a>function</h2><p>love.keyboard.isDown(key)</p>
<ul>
<li>Returns true or false depending on whether the specified key is currently held down; differs from love.keypressed(key) in that this can be called arbitrarily and will continuously return true if the key is pressed down, where love.keypressed(key) will only fire its code once every time the key is initially pressed down. However, since we want to be able to move our paddles up and down by holding down the appropriate keys, we need a function to test for longer periods of input, hence the use of love.keyboard.isDown(key)!<br>This returns true or false.</li>
</ul>
<h2 id="source-code-3"><a href="#source-code-3" class="headerlink" title="source code"></a>source code</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    GD50 2018</span></span><br><span class="line"><span class="comment">    Pong Remake</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    pong-3</span></span><br><span class="line"><span class="comment">    &quot;The Paddle Update&quot;</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- push is a library that will allow us to draw our game at a virtual</span></span><br><span class="line"><span class="comment">-- resolution, instead of however large our window is; used to provide</span></span><br><span class="line"><span class="comment">-- a more retro aesthetic</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- https://github.com/Ulydev/push</span></span><br><span class="line">push = <span class="built_in">require</span> <span class="string">&#x27;push&#x27;</span></span><br><span class="line"></span><br><span class="line">WINDOW_WIDTH = <span class="number">1280</span></span><br><span class="line">WINDOW_HEIGHT = <span class="number">720</span></span><br><span class="line"></span><br><span class="line">VIRTUAL_WIDTH = <span class="number">432</span></span><br><span class="line">VIRTUAL_HEIGHT = <span class="number">243</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- paddle移动速度; multiplied by dt in update</span></span><br><span class="line">PADDLE_SPEED = <span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Runs when the game first starts up, only once; used to initialize the game.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.load</span><span class="params">()</span></span></span><br><span class="line">    love.graphics.setDefaultFilter(<span class="string">&#x27;nearest&#x27;</span>, <span class="string">&#x27;nearest&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- more &quot;retro-looking&quot; font object we can use for any text</span></span><br><span class="line">    smallFont = love.graphics.newFont(<span class="string">&#x27;font.ttf&#x27;</span>, <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- larger font for drawing the score on the screen</span></span><br><span class="line">    scoreFont = love.graphics.newFont(<span class="string">&#x27;font.ttf&#x27;</span>, <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- set LÖVE2D&#x27;s active font to the smallFont obect</span></span><br><span class="line">    love.graphics.setFont(smallFont)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- initialize window with virtual resolution</span></span><br><span class="line">    push:setupScreen(VIRTUAL_WIDTH, VIRTUAL_HEIGHT, WINDOW_WIDTH, WINDOW_HEIGHT, &#123;</span><br><span class="line">        fullscreen = <span class="literal">false</span>,</span><br><span class="line">        resizable = <span class="literal">false</span>,</span><br><span class="line">        vsync = <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- initialize score variables, used for rendering on the screen and keeping</span></span><br><span class="line">    <span class="comment">-- track of the winner</span></span><br><span class="line">    player1Score = <span class="number">0</span></span><br><span class="line">    player2Score = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- paddle positions on the Y axis (they can only move up or down)</span></span><br><span class="line">    player1Y = <span class="number">30</span></span><br><span class="line">    player2Y = VIRTUAL_HEIGHT - <span class="number">50</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Runs every frame, with &quot;dt&quot; passed in, our delta in seconds</span></span><br><span class="line"><span class="comment">    since the last frame, which LÖVE2D supplies us.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.update</span><span class="params">(dt)</span></span></span><br><span class="line">    <span class="comment">-- player 1 movement</span></span><br><span class="line">    <span class="keyword">if</span> love.keyboard.isDown(<span class="string">&#x27;w&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- add negative paddle speed to current Y scaled by deltaTime,这里的横线是负的意思</span></span><br><span class="line">        player1Y = player1Y + -PADDLE_SPEED * dt</span><br><span class="line">    <span class="keyword">elseif</span> love.keyboard.isDown(<span class="string">&#x27;s&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- add positive paddle speed to current Y scaled by deltaTime</span></span><br><span class="line">        player1Y = player1Y + PADDLE_SPEED * dt</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- player 2 movement</span></span><br><span class="line">    <span class="keyword">if</span> love.keyboard.isDown(<span class="string">&#x27;up&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- add negative paddle speed to current Y scaled by deltaTime</span></span><br><span class="line">        player2Y = player2Y + -PADDLE_SPEED * dt</span><br><span class="line">    <span class="keyword">elseif</span> love.keyboard.isDown(<span class="string">&#x27;down&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- add positive paddle speed to current Y scaled by deltaTime</span></span><br><span class="line">        player2Y = player2Y + PADDLE_SPEED * dt</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Keyboard handling, called by LÖVE2D each frame;</span></span><br><span class="line"><span class="comment">    passes in the key we pressed so we can access.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.keypressed</span><span class="params">(key)</span></span></span><br><span class="line">    <span class="comment">-- keys can be accessed by string name</span></span><br><span class="line">    <span class="keyword">if</span> key == <span class="string">&#x27;escape&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- function LÖVE gives us to terminate application</span></span><br><span class="line">        love.event.quit()</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Called after update by LÖVE2D, used to draw anything to the screen,</span></span><br><span class="line"><span class="comment">    updated or otherwise.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.draw</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">-- begin rendering at virtual resolution</span></span><br><span class="line">    push:apply(<span class="string">&#x27;start&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- clear the screen with a specific color; in this case, a color similar</span></span><br><span class="line">    <span class="comment">-- to some versions of the original Pong</span></span><br><span class="line">    love.graphics.clear(<span class="number">40</span>/<span class="number">255</span>, <span class="number">45</span>/<span class="number">255</span>, <span class="number">52</span>/<span class="number">255</span>, <span class="number">255</span>/<span class="number">255</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- draw welcome text toward the top of the screen</span></span><br><span class="line">    love.graphics.setFont(smallFont)</span><br><span class="line">    love.graphics.printf(<span class="string">&#x27;Hello Pong!&#x27;</span>, <span class="number">0</span>, <span class="number">20</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- draw score on the left and right center of the screen</span></span><br><span class="line">    <span class="comment">-- need to switch font to draw before actually printing</span></span><br><span class="line">    love.graphics.setFont(scoreFont)</span><br><span class="line">    love.graphics.<span class="built_in">print</span>(<span class="built_in">tostring</span>(player1Score), VIRTUAL_WIDTH / <span class="number">2</span> - <span class="number">50</span>,</span><br><span class="line">        VIRTUAL_HEIGHT / <span class="number">3</span>)</span><br><span class="line">    love.graphics.<span class="built_in">print</span>(<span class="built_in">tostring</span>(player2Score), VIRTUAL_WIDTH / <span class="number">2</span> + <span class="number">30</span>,</span><br><span class="line">        VIRTUAL_HEIGHT / <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- render first paddle (left side), now using the players&#x27; Y variable</span></span><br><span class="line">    love.graphics.rectangle(<span class="string">&#x27;fill&#x27;</span>, <span class="number">10</span>, player1Y, <span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- render second paddle (right side)</span></span><br><span class="line">    love.graphics.rectangle(<span class="string">&#x27;fill&#x27;</span>, VIRTUAL_WIDTH - <span class="number">10</span>, player2Y, <span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- render ball (center)</span></span><br><span class="line">    love.graphics.rectangle(<span class="string">&#x27;fill&#x27;</span>, VIRTUAL_WIDTH / <span class="number">2</span> - <span class="number">2</span>, VIRTUAL_HEIGHT / <span class="number">2</span> - <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- end rendering at virtual resolution</span></span><br><span class="line">    push:apply(<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h1 id="4"><a href="#4" class="headerlink" title="4"></a>4</h1><p>让球动起来!</p>
<h2 id="function-4"><a href="#function-4" class="headerlink" title="function"></a>function</h2><p>math.randomseed(num)</p>
<ul>
<li>”Seeds” the random number generator used by Lua (math.random) with some value such that its randomness is dependent on that supplied value, allowing us to pass in different numbers each playthrough to guarantee non-consistency across different program executions (or uniformity if we want consistent behavior for testing).</li>
</ul>
<p>os.time()</p>
<ul>
<li>Lua function that returns, in seconds, the time since 00:00:00 UTC, January 1, 1970, also known as Unix epoch time<br>(<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Unix_time">https://en.wikipedia.org/wiki/Unix_time</a>).<br>因为每次的时间不一样,所以可以拿来当作seed.</li>
</ul>
<p>math.random(min, max)</p>
<ul>
<li>Returns a random number, dependent on the seeded random number generator, between min and max,<br>inclusive.</li>
</ul>
<p>math.min(num1, num2)</p>
<ul>
<li>Returns the lesser of the two numbers passed in.</li>
</ul>
<p>math.max(num1, num2)</p>
<ul>
<li>Returns the greater of the two numbers passed in.</li>
</ul>
<h2 id="source-code-4"><a href="#source-code-4" class="headerlink" title="source code"></a>source code</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    GD50 2018</span></span><br><span class="line"><span class="comment">    Pong Remake</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    pong-4</span></span><br><span class="line"><span class="comment">    &quot;The Ball Update&quot;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    -- Main Program --</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- push is a library that will allow us to draw our game at a virtual</span></span><br><span class="line"><span class="comment">-- resolution, instead of however large our window is; used to provide</span></span><br><span class="line"><span class="comment">-- a more retro aesthetic</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- https://github.com/Ulydev/push</span></span><br><span class="line">push = <span class="built_in">require</span> <span class="string">&#x27;push&#x27;</span></span><br><span class="line"></span><br><span class="line">WINDOW_WIDTH = <span class="number">1280</span></span><br><span class="line">WINDOW_HEIGHT = <span class="number">720</span></span><br><span class="line"></span><br><span class="line">VIRTUAL_WIDTH = <span class="number">432</span></span><br><span class="line">VIRTUAL_HEIGHT = <span class="number">243</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- speed at which we will move our paddle; multiplied by dt in update</span></span><br><span class="line">PADDLE_SPEED = <span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Runs when the game first starts up, only once; used to initialize the game.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.load</span><span class="params">()</span></span></span><br><span class="line">    love.graphics.setDefaultFilter(<span class="string">&#x27;nearest&#x27;</span>, <span class="string">&#x27;nearest&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- &quot;seed&quot; the RNG so that calls to random are always random</span></span><br><span class="line">    <span class="comment">-- use the current time, since that will vary on startup every time</span></span><br><span class="line">    <span class="built_in">math</span>.<span class="built_in">randomseed</span>(<span class="built_in">os</span>.<span class="built_in">time</span>())</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- more &quot;retro-looking&quot; font object we can use for any text</span></span><br><span class="line">    smallFont = love.graphics.newFont(<span class="string">&#x27;font.ttf&#x27;</span>, <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- set LÖVE2D&#x27;s active font to the smallFont obect</span></span><br><span class="line">    love.graphics.setFont(smallFont)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- initialize window with virtual resolution</span></span><br><span class="line">    push:setupScreen(VIRTUAL_WIDTH, VIRTUAL_HEIGHT, WINDOW_WIDTH, WINDOW_HEIGHT, &#123;</span><br><span class="line">        fullscreen = <span class="literal">false</span>,</span><br><span class="line">        resizable = <span class="literal">false</span>,</span><br><span class="line">        vsync = <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- paddle positions on the Y axis (they can only move up or down)</span></span><br><span class="line">    player1Y = <span class="number">30</span></span><br><span class="line">    player2Y = VIRTUAL_HEIGHT - <span class="number">50</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- velocity and position variables for our ball when play starts</span></span><br><span class="line">    ballX = VIRTUAL_WIDTH / <span class="number">2</span> - <span class="number">2</span></span><br><span class="line">    ballY = VIRTUAL_HEIGHT / <span class="number">2</span> - <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- math.random returns a random value between the left and right number</span></span><br><span class="line">    <span class="comment">-- dx and dy are delta x and delta y, which represent velocity</span></span><br><span class="line">    ballDX = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">2</span>) == <span class="number">1</span> <span class="keyword">and</span> <span class="number">100</span> <span class="keyword">or</span> <span class="number">-100</span></span><br><span class="line">    ballDY = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">-50</span>, <span class="number">50</span>)</span><br><span class="line">    <span class="comment">-- by adding them one frame by one frame in update, ball will move</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- game state variable used to transition between different parts of the game</span></span><br><span class="line">    <span class="comment">-- (used for beginning, menus, main game, high score list, etc.)</span></span><br><span class="line">    <span class="comment">-- we will use this to determine behavior during render and update</span></span><br><span class="line">    gameState = <span class="string">&#x27;start&#x27;</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Runs every frame, with &quot;dt&quot; passed in, our delta in seconds</span></span><br><span class="line"><span class="comment">    since the last frame, which LÖVE2D supplies us.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.update</span><span class="params">(dt)</span></span></span><br><span class="line">    <span class="comment">-- player 1 movement</span></span><br><span class="line">    <span class="keyword">if</span> love.keyboard.isDown(<span class="string">&#x27;w&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- add negative paddle speed to current Y scaled by deltaTime</span></span><br><span class="line">        <span class="comment">-- now, we clamp our position between the bounds of the screen</span></span><br><span class="line">        <span class="comment">-- math.max returns the greater of two values; 0 and player Y</span></span><br><span class="line">        <span class="comment">-- will ensure we don&#x27;t go above it</span></span><br><span class="line">        player1Y = <span class="built_in">math</span>.<span class="built_in">max</span>(<span class="number">0</span>, player1Y + -PADDLE_SPEED * dt)</span><br><span class="line"></span><br><span class="line">        <span class="comment">-- 用max来锁住活动范围</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elseif</span> love.keyboard.isDown(<span class="string">&#x27;s&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- add positive paddle speed to current Y scaled by deltaTime</span></span><br><span class="line">        <span class="comment">-- math.min returns the lesser of two values; bottom of the egde minus paddle height</span></span><br><span class="line">        <span class="comment">-- and player Y will ensure we don&#x27;t go below it</span></span><br><span class="line">        player1Y = <span class="built_in">math</span>.<span class="built_in">min</span>(VIRTUAL_HEIGHT - <span class="number">20</span>, player1Y + PADDLE_SPEED * dt)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- player 2 movement</span></span><br><span class="line">    <span class="keyword">if</span> love.keyboard.isDown(<span class="string">&#x27;up&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- add negative paddle speed to current Y scaled by deltaTime</span></span><br><span class="line">        player2Y = <span class="built_in">math</span>.<span class="built_in">max</span>(<span class="number">0</span>, player2Y + -PADDLE_SPEED * dt)</span><br><span class="line">    <span class="keyword">elseif</span> love.keyboard.isDown(<span class="string">&#x27;down&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- add positive paddle speed to current Y scaled by deltaTime</span></span><br><span class="line">        player2Y = <span class="built_in">math</span>.<span class="built_in">min</span>(VIRTUAL_HEIGHT - <span class="number">20</span>, player2Y + PADDLE_SPEED * dt)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- update our ball based on its DX and DY only if we&#x27;re in play state;</span></span><br><span class="line">    <span class="comment">-- scale the velocity by dt so movement is framerate-independent</span></span><br><span class="line">    <span class="keyword">if</span> gameState == <span class="string">&#x27;play&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        ballX = ballX + ballDX * dt</span><br><span class="line">        ballY = ballY + ballDY * dt</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Keyboard handling, called by LÖVE2D each frame;</span></span><br><span class="line"><span class="comment">    passes in the key we pressed so we can access.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.keypressed</span><span class="params">(key)</span></span></span><br><span class="line">    <span class="comment">-- keys can be accessed by string name</span></span><br><span class="line">    <span class="keyword">if</span> key == <span class="string">&#x27;escape&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- function LÖVE gives us to terminate application</span></span><br><span class="line">        love.event.quit()</span><br><span class="line">    <span class="comment">-- if we press enter during the start state of the game, we&#x27;ll go into play mode</span></span><br><span class="line">    <span class="comment">-- during play mode, the ball will move in a random direction</span></span><br><span class="line">    <span class="keyword">elseif</span> key == <span class="string">&#x27;enter&#x27;</span> <span class="keyword">or</span> key == <span class="string">&#x27;return&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">if</span> gameState == <span class="string">&#x27;start&#x27;</span> <span class="keyword">then</span></span><br><span class="line">            gameState = <span class="string">&#x27;play&#x27;</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            gameState = <span class="string">&#x27;start&#x27;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">-- start ball&#x27;s position in the middle of the screen</span></span><br><span class="line">            ballX = VIRTUAL_WIDTH / <span class="number">2</span> - <span class="number">2</span></span><br><span class="line">            ballY = VIRTUAL_HEIGHT / <span class="number">2</span> - <span class="number">2</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">-- given ball&#x27;s x and y velocity a random starting value</span></span><br><span class="line">            <span class="comment">-- the and/or pattern here is Lua&#x27;s way of accomplishing a ternary operation</span></span><br><span class="line">            <span class="comment">-- in other programming languages like C</span></span><br><span class="line">            ballDX = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">2</span>) == <span class="number">1</span> <span class="keyword">and</span> <span class="number">100</span> <span class="keyword">or</span> <span class="number">-100</span></span><br><span class="line">            <span class="comment">-- 这跟在C里写 math.random(2) == 1 ? 100 : -100相同</span></span><br><span class="line">            ballDY = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">-50</span>, <span class="number">50</span>) * <span class="number">1.5</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Called after update by LÖVE2D, used to draw anything to the screen,</span></span><br><span class="line"><span class="comment">    updated or otherwise.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.draw</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">-- begin rendering at virtual resolution</span></span><br><span class="line">    push:apply(<span class="string">&#x27;start&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- clear the screen with a specific color; in this case, a color similar</span></span><br><span class="line">    <span class="comment">-- to some versions of the original Pong</span></span><br><span class="line">    love.graphics.clear(<span class="number">40</span>/<span class="number">255</span>, <span class="number">45</span>/<span class="number">255</span>, <span class="number">52</span>/<span class="number">255</span>, <span class="number">255</span>/<span class="number">255</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- draw different things based on the state of the game</span></span><br><span class="line">    love.graphics.setFont(smallFont)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> gameState == <span class="string">&#x27;start&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        love.graphics.printf(<span class="string">&#x27;Hello Start State!&#x27;</span>, <span class="number">0</span>, <span class="number">20</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        love.graphics.printf(<span class="string">&#x27;Hello Play State!&#x27;</span>, <span class="number">0</span>, <span class="number">20</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- render first paddle (left side), now using the players&#x27; Y variable</span></span><br><span class="line">    love.graphics.rectangle(<span class="string">&#x27;fill&#x27;</span>, <span class="number">10</span>, player1Y, <span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- render second paddle (right side)</span></span><br><span class="line">    love.graphics.rectangle(<span class="string">&#x27;fill&#x27;</span>, VIRTUAL_WIDTH - <span class="number">10</span>, player2Y, <span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- render ball (center)</span></span><br><span class="line">    love.graphics.rectangle(<span class="string">&#x27;fill&#x27;</span>, ballX, ballY, <span class="number">4</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- end rendering at virtual resolution</span></span><br><span class="line">    push:apply(<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h1 id="4-1"><a href="#4-1" class="headerlink" title="4"></a>4</h1><p>Class update,把paddle和球换成class.<br>(Yeah this makes more sense.)</p>
<h2 id="function-5"><a href="#function-5" class="headerlink" title="function"></a>function</h2><p>What is a class?</p>
<img src="/blog/2022/02/08/P224/P224_4.png" class="">

<ul>
<li>Blueprints for creating bundles of data and code that are related.</li>
<li>A “Car” class can have attributes that describe its brand, model, color, miles, and anything else descriptive; these are also known as “fields”.</li>
<li>A “Car” class can also have “methods” that define its behavior, such as “accelerate”, “turn”, “honk”, and more, which take the form of functions.</li>
<li>Objects are instantiated from these class blueprints, and it’s these concrete objects that are the physical “cars” you see on the road, as opposed to the blueprints that may exist in the factory.</li>
<li>Our Paddles and Ball are perfect simple use cases for taking some of our code and bundling it together into classes and objects.</li>
</ul>
<h2 id="source-code-5"><a href="#source-code-5" class="headerlink" title="source code"></a>source code</h2><p>main.lua:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    GD50 2018</span></span><br><span class="line"><span class="comment">    Pong Remake</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    pong-5</span></span><br><span class="line"><span class="comment">    &quot;The Class Update&quot;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    -- Main Program --</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- push is a library that will allow us to draw our game at a virtual</span></span><br><span class="line"><span class="comment">-- resolution, instead of however large our window is; used to provide</span></span><br><span class="line"><span class="comment">-- a more retro aesthetic</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- https://github.com/Ulydev/push</span></span><br><span class="line">push = <span class="built_in">require</span> <span class="string">&#x27;push&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- the &quot;Class&quot; library we&#x27;re using will allow us to represent anything in</span></span><br><span class="line"><span class="comment">-- our game as code, rather than keeping track of many disparate variables and</span></span><br><span class="line"><span class="comment">-- methods</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- https://github.com/vrld/hump/blob/master/class.lua</span></span><br><span class="line">Class = <span class="built_in">require</span> <span class="string">&#x27;class&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- our Paddle class, which stores position and dimensions for each Paddle</span></span><br><span class="line"><span class="comment">-- and the logic for rendering them</span></span><br><span class="line"><span class="built_in">require</span> <span class="string">&#x27;Paddle&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- our Ball class, which isn&#x27;t much different than a Paddle structure-wise</span></span><br><span class="line"><span class="comment">-- but which will mechanically function very differently</span></span><br><span class="line"><span class="built_in">require</span> <span class="string">&#x27;Ball&#x27;</span></span><br><span class="line"></span><br><span class="line">WINDOW_WIDTH = <span class="number">1280</span></span><br><span class="line">WINDOW_HEIGHT = <span class="number">720</span></span><br><span class="line"></span><br><span class="line">VIRTUAL_WIDTH = <span class="number">432</span></span><br><span class="line">VIRTUAL_HEIGHT = <span class="number">243</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- speed at which we will move our paddle; multiplied by dt in update</span></span><br><span class="line">PADDLE_SPEED = <span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Runs when the game first starts up, only once; used to initialize the game.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.load</span><span class="params">()</span></span></span><br><span class="line">    love.graphics.setDefaultFilter(<span class="string">&#x27;nearest&#x27;</span>, <span class="string">&#x27;nearest&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- &quot;seed&quot; the RNG so that calls to random are always random</span></span><br><span class="line">    <span class="comment">-- use the current time, since that will vary on startup every time</span></span><br><span class="line">    <span class="built_in">math</span>.<span class="built_in">randomseed</span>(<span class="built_in">os</span>.<span class="built_in">time</span>())</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- more &quot;retro-looking&quot; font object we can use for any text</span></span><br><span class="line">    smallFont = love.graphics.newFont(<span class="string">&#x27;font.ttf&#x27;</span>, <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- set LÖVE2D&#x27;s active font to the smallFont object</span></span><br><span class="line">    love.graphics.setFont(smallFont)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- initialize window with virtual resolution</span></span><br><span class="line">    push:setupScreen(VIRTUAL_WIDTH, VIRTUAL_HEIGHT, WINDOW_WIDTH, WINDOW_HEIGHT, &#123;</span><br><span class="line">        fullscreen = <span class="literal">false</span>,</span><br><span class="line">        resizable = <span class="literal">true</span>,</span><br><span class="line">        vsync = <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- initialize our player paddles; make them global so that they can be</span></span><br><span class="line">    <span class="comment">-- detected by other functions and modules</span></span><br><span class="line">    player1 = Paddle(<span class="number">10</span>, <span class="number">30</span>, <span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">    player2 = Paddle(VIRTUAL_WIDTH - <span class="number">10</span>, VIRTUAL_HEIGHT - <span class="number">30</span>, <span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- place a ball in the middle of the screen</span></span><br><span class="line">    ball = Ball(VIRTUAL_WIDTH / <span class="number">2</span> - <span class="number">2</span>, VIRTUAL_HEIGHT / <span class="number">2</span> - <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- game state variable used to transition between different parts of the game</span></span><br><span class="line">    <span class="comment">-- (used for beginning, menus, main game, high score list, etc.)</span></span><br><span class="line">    <span class="comment">-- we will use this to determine behavior during render and update</span></span><br><span class="line">    gameState = <span class="string">&#x27;start&#x27;</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Runs every frame, with &quot;dt&quot; passed in, our delta in seconds</span></span><br><span class="line"><span class="comment">    since the last frame, which LÖVE2D supplies us.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.update</span><span class="params">(dt)</span></span></span><br><span class="line">    <span class="comment">-- player 1 movement</span></span><br><span class="line">    <span class="keyword">if</span> love.keyboard.isDown(<span class="string">&#x27;w&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player1.dy = -PADDLE_SPEED</span><br><span class="line">    <span class="keyword">elseif</span> love.keyboard.isDown(<span class="string">&#x27;s&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player1.dy = PADDLE_SPEED</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        player1.dy = <span class="number">0</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- player 2 movement</span></span><br><span class="line">    <span class="keyword">if</span> love.keyboard.isDown(<span class="string">&#x27;up&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player2.dy = -PADDLE_SPEED</span><br><span class="line">    <span class="keyword">elseif</span> love.keyboard.isDown(<span class="string">&#x27;down&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player2.dy = PADDLE_SPEED</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        player2.dy = <span class="number">0</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- update our ball based on its DX and DY only if we&#x27;re in play state;</span></span><br><span class="line">    <span class="comment">-- scale the velocity by dt so movement is framerate-independent</span></span><br><span class="line">    <span class="keyword">if</span> gameState == <span class="string">&#x27;play&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        ball:update(dt)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    player1:update(dt)</span><br><span class="line">    player2:update(dt)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Keyboard handling, called by LÖVE2D each frame;</span></span><br><span class="line"><span class="comment">    passes in the key we pressed so we can access.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.keypressed</span><span class="params">(key)</span></span></span><br><span class="line">    <span class="comment">-- keys can be accessed by string name</span></span><br><span class="line">    <span class="keyword">if</span> key == <span class="string">&#x27;escape&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- function LÖVE gives us to terminate application</span></span><br><span class="line">        love.event.quit()</span><br><span class="line">    <span class="comment">-- if we press enter during the start state of the game, we&#x27;ll go into play mode</span></span><br><span class="line">    <span class="comment">-- during play mode, the ball will move in a random direction</span></span><br><span class="line">    <span class="keyword">elseif</span> key == <span class="string">&#x27;enter&#x27;</span> <span class="keyword">or</span> key == <span class="string">&#x27;return&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">if</span> gameState == <span class="string">&#x27;start&#x27;</span> <span class="keyword">then</span></span><br><span class="line">            gameState = <span class="string">&#x27;play&#x27;</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            gameState = <span class="string">&#x27;start&#x27;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">-- ball&#x27;s new reset method</span></span><br><span class="line">            ball:reset()</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Called after update by LÖVE2D, used to draw anything to the screen,</span></span><br><span class="line"><span class="comment">    updated or otherwise.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.draw</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">-- begin rendering at virtual resolution</span></span><br><span class="line">    push:apply(<span class="string">&#x27;start&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- clear the screen with a specific color; in this case, a color similar</span></span><br><span class="line">    <span class="comment">-- to some versions of the original Pong</span></span><br><span class="line">    love.graphics.clear(<span class="number">40</span>/<span class="number">255</span>, <span class="number">45</span>/<span class="number">255</span>, <span class="number">52</span>/<span class="number">255</span>, <span class="number">255</span>/<span class="number">255</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- draw different things based on the state of the game</span></span><br><span class="line">    love.graphics.setFont(smallFont)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> gameState == <span class="string">&#x27;start&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        love.graphics.printf(<span class="string">&#x27;Hello Start State!&#x27;</span>, <span class="number">0</span>, <span class="number">20</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        love.graphics.printf(<span class="string">&#x27;Hello Play State!&#x27;</span>, <span class="number">0</span>, <span class="number">20</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- render paddles, now using their class&#x27;s render method</span></span><br><span class="line">    player1:render()</span><br><span class="line">    player2:render()</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- render ball using its class&#x27;s render method</span></span><br><span class="line">    ball:render()</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- end rendering at virtual resolution</span></span><br><span class="line">    push:apply(<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Ball.lua:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    GD50 2018</span></span><br><span class="line"><span class="comment">    Pong Remake</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    -- Ball Class --</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Author: Colton Ogden</span></span><br><span class="line"><span class="comment">    cogden@cs50.harvard.edu</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Represents a ball which will bounce back and forth between paddles</span></span><br><span class="line"><span class="comment">    and walls until it passes a left or right boundary of the screen,</span></span><br><span class="line"><span class="comment">    scoring a point for the opponent.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"></span><br><span class="line">Ball = Class&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Ball:init</span><span class="params">(x, y, width, height)</span></span></span><br><span class="line">    <span class="built_in">self</span>.x = x</span><br><span class="line">    <span class="built_in">self</span>.y = y</span><br><span class="line">    <span class="built_in">self</span>.width = width</span><br><span class="line">    <span class="built_in">self</span>.height = height</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- these variables are for keeping track of our velocity on both the</span></span><br><span class="line">    <span class="comment">-- X and Y axis, since the ball can move in two dimensions</span></span><br><span class="line">    <span class="built_in">self</span>.dy = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">2</span>) == <span class="number">1</span> <span class="keyword">and</span> <span class="number">-100</span> <span class="keyword">or</span> <span class="number">100</span></span><br><span class="line">    <span class="built_in">self</span>.dx = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">-50</span>, <span class="number">50</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Places the ball in the middle of the screen, with an initial random velocity</span></span><br><span class="line"><span class="comment">    on both axes.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Ball:reset</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">self</span>.x = VIRTUAL_WIDTH / <span class="number">2</span> - <span class="number">2</span></span><br><span class="line">    <span class="built_in">self</span>.y = VIRTUAL_HEIGHT / <span class="number">2</span> - <span class="number">2</span></span><br><span class="line">    <span class="built_in">self</span>.dy = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">2</span>) == <span class="number">1</span> <span class="keyword">and</span> <span class="number">-100</span> <span class="keyword">or</span> <span class="number">100</span></span><br><span class="line">    <span class="built_in">self</span>.dx = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">-50</span>, <span class="number">50</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Simply applies velocity to position, scaled by deltaTime.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Ball:update</span><span class="params">(dt)</span></span></span><br><span class="line">    <span class="built_in">self</span>.x = <span class="built_in">self</span>.x + <span class="built_in">self</span>.dx * dt</span><br><span class="line">    <span class="built_in">self</span>.y = <span class="built_in">self</span>.y + <span class="built_in">self</span>.dy * dt</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Ball:render</span><span class="params">()</span></span></span><br><span class="line">    love.graphics.rectangle(<span class="string">&#x27;fill&#x27;</span>, <span class="built_in">self</span>.x, <span class="built_in">self</span>.y, <span class="built_in">self</span>.width, <span class="built_in">self</span>.height)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>Paddle.lua:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    GD50 2018</span></span><br><span class="line"><span class="comment">    Pong Remake</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    -- Paddle Class --</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Author: Colton Ogden</span></span><br><span class="line"><span class="comment">    cogden@cs50.harvard.edu</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Represents a paddle that can move up and down. Used in the main</span></span><br><span class="line"><span class="comment">    program to deflect the ball back toward the opponent.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"></span><br><span class="line">Paddle = Class&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    The `init` function on our class is called just once, when the object</span></span><br><span class="line"><span class="comment">    is first created. Used to set up all variables in the class and get it</span></span><br><span class="line"><span class="comment">    ready for use.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Our Paddle should take an X and a Y, for positioning, as well as a width</span></span><br><span class="line"><span class="comment">    and height for its dimensions.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Note that `self` is a reference to *this* object, whichever object is</span></span><br><span class="line"><span class="comment">    instantiated at the time this function is called. Different objects can</span></span><br><span class="line"><span class="comment">    have their own x, y, width, and height values, thus serving as containers</span></span><br><span class="line"><span class="comment">    for data. In this sense, they&#x27;re very similar to structs in C.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Paddle:init</span><span class="params">(x, y, width, height)</span></span></span><br><span class="line">    <span class="built_in">self</span>.x = x</span><br><span class="line">    <span class="built_in">self</span>.y = y</span><br><span class="line">    <span class="built_in">self</span>.width = width</span><br><span class="line">    <span class="built_in">self</span>.height = height</span><br><span class="line">    <span class="built_in">self</span>.dy = <span class="number">0</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Paddle:update</span><span class="params">(dt)</span></span></span><br><span class="line">    <span class="comment">-- math.max here ensures that we&#x27;re the greater of 0 or the player&#x27;s</span></span><br><span class="line">    <span class="comment">-- current calculated Y position when pressing up so that we don&#x27;t</span></span><br><span class="line">    <span class="comment">-- go into the negatives; the movement calculation is simply our</span></span><br><span class="line">    <span class="comment">-- previously-defined paddle speed scaled by dt</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">self</span>.dy &lt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">self</span>.y = <span class="built_in">math</span>.<span class="built_in">max</span>(<span class="number">0</span>, <span class="built_in">self</span>.y + <span class="built_in">self</span>.dy * dt)</span><br><span class="line">    <span class="comment">-- similar to before, this time we use math.min to ensure we don&#x27;t</span></span><br><span class="line">    <span class="comment">-- go any farther than the bottom of the screen minus the paddle&#x27;s</span></span><br><span class="line">    <span class="comment">-- height (or else it will go partially below, since position is</span></span><br><span class="line">    <span class="comment">-- based on its top left corner)</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">self</span>.y = <span class="built_in">math</span>.<span class="built_in">min</span>(VIRTUAL_HEIGHT - <span class="built_in">self</span>.height, <span class="built_in">self</span>.y + <span class="built_in">self</span>.dy * dt)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    To be called by our main function in `love.draw`, ideally. Uses</span></span><br><span class="line"><span class="comment">    LÖVE2D&#x27;s `rectangle` function, which takes in a draw mode as the first</span></span><br><span class="line"><span class="comment">    argument as well as the position and dimensions for the rectangle. To</span></span><br><span class="line"><span class="comment">    change the color, one must call `love.graphics.setColor`. As of the</span></span><br><span class="line"><span class="comment">    newest version of LÖVE2D, you can even draw rounded rectangles!</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Paddle:render</span><span class="params">()</span></span></span><br><span class="line">    love.graphics.rectangle(<span class="string">&#x27;fill&#x27;</span>, <span class="built_in">self</span>.x, <span class="built_in">self</span>.y, <span class="built_in">self</span>.width, <span class="built_in">self</span>.height)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>class.lua:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">Copyright (c) 2010-2013 Matthias Richter</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Permission is hereby granted, free of charge, to any person obtaining a copy</span></span><br><span class="line"><span class="comment">of this software and associated documentation files (the &quot;Software&quot;), to deal</span></span><br><span class="line"><span class="comment">in the Software without restriction, including without limitation the rights</span></span><br><span class="line"><span class="comment">to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span></span><br><span class="line"><span class="comment">copies of the Software, and to permit persons to whom the Software is</span></span><br><span class="line"><span class="comment">furnished to do so, subject to the following conditions:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The above copyright notice and this permission notice shall be included in</span></span><br><span class="line"><span class="comment">all copies or substantial portions of the Software.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Except as contained in this notice, the name(s) of the above copyright holders</span></span><br><span class="line"><span class="comment">shall not be used in advertising or otherwise to promote the sale, use or</span></span><br><span class="line"><span class="comment">other dealings in this Software without prior written authorization.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span></span><br><span class="line"><span class="comment">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span></span><br><span class="line"><span class="comment">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span></span><br><span class="line"><span class="comment">AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span></span><br><span class="line"><span class="comment">LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span></span><br><span class="line"><span class="comment">OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN</span></span><br><span class="line"><span class="comment">THE SOFTWARE.</span></span><br><span class="line"><span class="comment">]]</span><span class="comment">--</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">include_helper</span><span class="params">(to, from, seen)</span></span></span><br><span class="line">	<span class="keyword">if</span> from == <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">		<span class="keyword">return</span> to</span><br><span class="line">	<span class="keyword">elseif</span> <span class="built_in">type</span>(from) ~= <span class="string">&#x27;table&#x27;</span> <span class="keyword">then</span></span><br><span class="line">		<span class="keyword">return</span> from</span><br><span class="line">	<span class="keyword">elseif</span> seen[from] <span class="keyword">then</span></span><br><span class="line">		<span class="keyword">return</span> seen[from]</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">	seen[from] = to</span><br><span class="line">	<span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">pairs</span>(from) <span class="keyword">do</span></span><br><span class="line">		k = include_helper(&#123;&#125;, k, seen) <span class="comment">-- keys might also be tables</span></span><br><span class="line">		<span class="keyword">if</span> to[k] == <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">			to[k] = include_helper(&#123;&#125;, v, seen)</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	<span class="keyword">return</span> to</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- deeply copies &#x27;other&#x27; into &#x27;class&#x27;. keys in &#x27;other&#x27; that are already</span></span><br><span class="line"><span class="comment">-- defined in &#x27;class&#x27; are omitted</span></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">include</span><span class="params">(class, other)</span></span></span><br><span class="line">	<span class="keyword">return</span> include_helper(class, other, &#123;&#125;)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- returns a deep copy of &#x27;other&#x27;</span></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">clone</span><span class="params">(other)</span></span></span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">setmetatable</span>(include(&#123;&#125;, other), <span class="built_in">getmetatable</span>(other))</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">new</span><span class="params">(class)</span></span></span><br><span class="line">	<span class="comment">-- mixins</span></span><br><span class="line">	class = class <span class="keyword">or</span> &#123;&#125;  <span class="comment">-- class can be nil</span></span><br><span class="line">	<span class="keyword">local</span> inc = class.__includes <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">getmetatable</span>(inc) <span class="keyword">then</span> inc = &#123;inc&#125; <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> _, other <span class="keyword">in</span> <span class="built_in">ipairs</span>(inc) <span class="keyword">do</span></span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">type</span>(other) == <span class="string">&quot;string&quot;</span> <span class="keyword">then</span></span><br><span class="line">			other = <span class="built_in">_G</span>[other]</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		include(class, other)</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">-- class implementation</span></span><br><span class="line">	class.<span class="built_in">__index</span> = class</span><br><span class="line">	class.init    = class.init    <span class="keyword">or</span> class[<span class="number">1</span>] <span class="keyword">or</span> <span class="function"><span class="keyword">function</span><span class="params">()</span></span> <span class="keyword">end</span></span><br><span class="line">	class.include = class.include <span class="keyword">or</span> include</span><br><span class="line">	class.clone   = class.clone   <span class="keyword">or</span> clone</span><br><span class="line"></span><br><span class="line">	<span class="comment">-- constructor call</span></span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">setmetatable</span>(class, &#123;<span class="built_in">__call</span> = <span class="function"><span class="keyword">function</span><span class="params">(c, ...)</span></span></span><br><span class="line">		<span class="keyword">local</span> o = <span class="built_in">setmetatable</span>(&#123;&#125;, c)</span><br><span class="line">		o:init(...)</span><br><span class="line">		<span class="keyword">return</span> o</span><br><span class="line">	<span class="keyword">end</span>&#125;)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- interface for cross class-system compatibility (see https://github.com/bartbes/Class-Commons).</span></span><br><span class="line"><span class="keyword">if</span> class_commons ~= <span class="literal">false</span> <span class="keyword">and</span> <span class="keyword">not</span> common <span class="keyword">then</span></span><br><span class="line">	common = &#123;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">common.class</span><span class="params">(name, prototype, parent)</span></span></span><br><span class="line">		<span class="keyword">return</span> new&#123;__includes = &#123;prototype, parent&#125;&#125;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">common.instance</span><span class="params">(class, ...)</span></span></span><br><span class="line">		<span class="keyword">return</span> class(...)</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- the module</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">setmetatable</span>(&#123;new = new, include = include, clone = clone&#125;,</span><br><span class="line">	&#123;<span class="built_in">__call</span> = <span class="function"><span class="keyword">function</span><span class="params">(_,...)</span></span> <span class="keyword">return</span> new(...) <span class="keyword">end</span>&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h1 id="5"><a href="#5" class="headerlink" title="5"></a>5</h1><p>The FPS(frame per second) Update.</p>
<h2 id="function-6"><a href="#function-6" class="headerlink" title="function"></a>function</h2><p>love.window.setTitle(title) - 改个标题</p>
<ul>
<li>Simply sets the title of our application window, adding a slight level of polish.</li>
</ul>
<p>love.timer.getFPS()</p>
<ul>
<li>Returns the current FPS of our application, making it easy to monitor when printed.</li>
</ul>
<h2 id="source-code-6"><a href="#source-code-6" class="headerlink" title="source code"></a>source code</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    <span class="comment">-- render paddles, now using their class&#x27;s render method</span></span><br><span class="line">    player1:render()</span><br><span class="line">    player2:render()</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- render ball using its class&#x27;s render method</span></span><br><span class="line">    ball:render()</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- new function just to demonstrate how to see FPS in LÖVE2D</span></span><br><span class="line">    displayFPS()</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- end rendering at virtual resolution</span></span><br><span class="line">    push:apply(<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Renders the current FPS.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">displayFPS</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">-- simple FPS display across all states</span></span><br><span class="line">    love.graphics.setFont(smallFont)</span><br><span class="line">    love.graphics.setColor(<span class="number">0</span>, <span class="number">255</span>/<span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>/<span class="number">255</span>)</span><br><span class="line">    love.graphics.<span class="built_in">print</span>(<span class="string">&#x27;FPS: &#x27;</span> .. <span class="built_in">tostring</span>(love.timer.getFPS()), <span class="number">10</span>, <span class="number">10</span>) <span class="comment">-- 这里的点点是合并string</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h1 id="7"><a href="#7" class="headerlink" title="7"></a>7</h1><p>终于要做撞击设定了.</p>
<h2 id="function-7"><a href="#function-7" class="headerlink" title="function"></a>function</h2><p>AABB Collision Detection</p>
<p>Relies on all colliding entities to have “alix-aligned bounding boxes”, which simply means their collision boxes contain no rotation in our world space, which allows us to use a simple math formula to test for collision:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if rect1.x is not &gt; rect2.x + rect2.width and</span><br><span class="line"> rect1.x + rect1.width is not &lt; rect2.x and</span><br><span class="line"> rect1.y is not &gt; rect2.y + rect2.height and</span><br><span class="line"> rect1.y + rect1.height is not &lt; rect2.y:</span><br><span class="line"> collision is true</span><br><span class="line">else</span><br><span class="line"> collision is false</span><br></pre></td></tr></table></figure>

<p>逻辑是check四次:<br>A方块的左边在B方块的右边,那就不会collision.同理上下左右.</p>
<h2 id="source-code-7"><a href="#source-code-7" class="headerlink" title="source code"></a>source code</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.update</span><span class="params">(dt)</span></span></span><br><span class="line">    <span class="keyword">if</span> gameState == <span class="string">&#x27;play&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- detect ball collision with paddles, reversing dx if true and</span></span><br><span class="line">        <span class="comment">-- slightly increasing it, then altering the dy based on the position of collision</span></span><br><span class="line">        <span class="keyword">if</span> ball:collides(player1) <span class="keyword">then</span></span><br><span class="line">            ball.dx = -ball.dx * <span class="number">1.03</span> <span class="comment">-- this 1.03 is for speed up the game</span></span><br><span class="line">            ball.x = player1.x + <span class="number">5</span> <span class="comment">-- this is for not overlap paddle collision box and the ball</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">-- keep velocity going in the same direction, but randomize it</span></span><br><span class="line">            <span class="keyword">if</span> ball.dy &lt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">                ball.dy = -<span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">10</span>, <span class="number">150</span>)</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                ball.dy = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">10</span>, <span class="number">150</span>)</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">if</span> ball:collides(player2) <span class="keyword">then</span></span><br><span class="line">            ball.dx = -ball.dx * <span class="number">1.03</span></span><br><span class="line">            ball.x = player2.x - <span class="number">4</span> <span class="comment">-- in this case 4 is for width of the ball</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">-- keep velocity going in the same direction, but randomize it</span></span><br><span class="line">            <span class="keyword">if</span> ball.dy &lt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">                ball.dy = -<span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">10</span>, <span class="number">150</span>)</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                ball.dy = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">10</span>, <span class="number">150</span>)</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">-- detect upper and lower screen boundary collision and reverse if collided</span></span><br><span class="line">        <span class="keyword">if</span> ball.y &lt;= <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">            ball.y = <span class="number">0</span></span><br><span class="line">            ball.dy = -ball.dy</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">-- -4 to account for the ball&#x27;s size</span></span><br><span class="line">        <span class="keyword">if</span> ball.y &gt;= VIRTUAL_HEIGHT - <span class="number">4</span> <span class="keyword">then</span></span><br><span class="line">            ball.y = VIRTUAL_HEIGHT - <span class="number">4</span></span><br><span class="line">            ball.dy = -ball.dy</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- player 1 movement</span></span><br><span class="line">    <span class="keyword">if</span> love.keyboard.isDown(<span class="string">&#x27;w&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player1.dy = -PADDLE_SPEED</span><br><span class="line">    <span class="keyword">elseif</span> love.keyboard.isDown(<span class="string">&#x27;s&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player1.dy = PADDLE_SPEED</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        player1.dy = <span class="number">0</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- player 2 movement</span></span><br><span class="line">    <span class="keyword">if</span> love.keyboard.isDown(<span class="string">&#x27;up&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player2.dy = -PADDLE_SPEED</span><br><span class="line">    <span class="keyword">elseif</span> love.keyboard.isDown(<span class="string">&#x27;down&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player2.dy = PADDLE_SPEED</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        player2.dy = <span class="number">0</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- update our ball based on its DX and DY only if we&#x27;re in play state;</span></span><br><span class="line">    <span class="comment">-- scale the velocity by dt so movement is framerate-independent</span></span><br><span class="line">    <span class="keyword">if</span> gameState == <span class="string">&#x27;play&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        ball:update(dt)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    player1:update(dt)</span><br><span class="line">    player2:update(dt)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Ball:collides</span><span class="params">(paddle)</span></span></span><br><span class="line">    <span class="comment">-- first, check to see if the left edge of either is farther to the right</span></span><br><span class="line">    <span class="comment">-- than the right edge of the other</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">self</span>.x &gt; paddle.x + paddle.width <span class="keyword">or</span> paddle.x &gt; <span class="built_in">self</span>.x + <span class="built_in">self</span>.width <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- then check to see if the bottom edge of either is higher than the top</span></span><br><span class="line">    <span class="comment">-- edge of the other</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">self</span>.y &gt; paddle.y + paddle.height <span class="keyword">or</span> paddle.y &gt; <span class="built_in">self</span>.y + <span class="built_in">self</span>.height <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- if the above aren&#x27;t true, they&#x27;re overlapping</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h1 id="8"><a href="#8" class="headerlink" title="8"></a>8</h1><p>The Score Update.</p>
<h2 id="source-code-8"><a href="#source-code-8" class="headerlink" title="source code"></a>source code</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.update</span><span class="params">(dt)</span></span></span><br><span class="line">    <span class="keyword">if</span> gameState == <span class="string">&#x27;play&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- detect ball collision with paddles, reversing dx if true and</span></span><br><span class="line">        <span class="comment">-- slightly increasing it, then altering the dy based on the position of collision</span></span><br><span class="line">        <span class="keyword">if</span> ball:collides(player1) <span class="keyword">then</span></span><br><span class="line">            ball.dx = -ball.dx * <span class="number">1.03</span></span><br><span class="line">            ball.x = player1.x + <span class="number">5</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">-- keep velocity going in the same direction, but randomize it</span></span><br><span class="line">            <span class="keyword">if</span> ball.dy &lt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">                ball.dy = -<span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">10</span>, <span class="number">150</span>)</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                ball.dy = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">10</span>, <span class="number">150</span>)</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">if</span> ball:collides(player2) <span class="keyword">then</span></span><br><span class="line">            ball.dx = -ball.dx * <span class="number">1.03</span></span><br><span class="line">            ball.x = player2.x - <span class="number">4</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">-- keep velocity going in the same direction, but randomize it</span></span><br><span class="line">            <span class="keyword">if</span> ball.dy &lt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">                ball.dy = -<span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">10</span>, <span class="number">150</span>)</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                ball.dy = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">10</span>, <span class="number">150</span>)</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">-- detect upper and lower screen boundary collision and reverse if collided</span></span><br><span class="line">        <span class="keyword">if</span> ball.y &lt;= <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">            ball.y = <span class="number">0</span></span><br><span class="line">            ball.dy = -ball.dy</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">-- -4 to account for the ball&#x27;s size</span></span><br><span class="line">        <span class="keyword">if</span> ball.y &gt;= VIRTUAL_HEIGHT - <span class="number">4</span> <span class="keyword">then</span></span><br><span class="line">            ball.y = VIRTUAL_HEIGHT - <span class="number">4</span></span><br><span class="line">            ball.dy = -ball.dy</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- if we reach the left or right edge of the screen,</span></span><br><span class="line">    <span class="comment">-- go back to start and update the score</span></span><br><span class="line">    <span class="keyword">if</span> ball.x &lt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">        servingPlayer = <span class="number">1</span></span><br><span class="line">        player2Score = player2Score + <span class="number">1</span></span><br><span class="line">        ball:reset()</span><br><span class="line">        gameState = <span class="string">&#x27;start&#x27;</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ball.x &gt; VIRTUAL_WIDTH <span class="keyword">then</span></span><br><span class="line">        servingPlayer = <span class="number">2</span></span><br><span class="line">        player1Score = player1Score + <span class="number">1</span></span><br><span class="line">        ball:reset()</span><br><span class="line">        gameState = <span class="string">&#x27;start&#x27;</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- player 1 movement</span></span><br><span class="line">    <span class="keyword">if</span> love.keyboard.isDown(<span class="string">&#x27;w&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player1.dy = -PADDLE_SPEED</span><br><span class="line">    <span class="keyword">elseif</span> love.keyboard.isDown(<span class="string">&#x27;s&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player1.dy = PADDLE_SPEED</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        player1.dy = <span class="number">0</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- player 2 movement</span></span><br><span class="line">    <span class="keyword">if</span> love.keyboard.isDown(<span class="string">&#x27;up&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player2.dy = -PADDLE_SPEED</span><br><span class="line">    <span class="keyword">elseif</span> love.keyboard.isDown(<span class="string">&#x27;down&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player2.dy = PADDLE_SPEED</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        player2.dy = <span class="number">0</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- update our ball based on its DX and DY only if we&#x27;re in play state;</span></span><br><span class="line">    <span class="comment">-- scale the velocity by dt so movement is framerate-independent</span></span><br><span class="line">    <span class="keyword">if</span> gameState == <span class="string">&#x27;play&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        ball:update(dt)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    player1:update(dt)</span><br><span class="line">    player2:update(dt)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h1 id="9"><a href="#9" class="headerlink" title="9"></a>9</h1><p>增加一个叫做serve的stage.</p>
<p>游戏的设定是一开始在start stage,需要按enter才能正经进入游戏.<br>serve是分别给player1和player2一次试玩的机会.<br>在player1 的serve时,球会往player1那里跑.</p>
<p>这一步的目的是,把游戏分成不同的stage来考虑(make sense!).</p>
<h2 id="function-8"><a href="#function-8" class="headerlink" title="function"></a>function</h2><img src="/blog/2022/02/08/P224/P224_4.png" class="">

<h2 id="source-code-9"><a href="#source-code-9" class="headerlink" title="source code"></a>source code</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.load</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">-- set love&#x27;s default filter to &quot;nearest-neighbor&quot;, which essentially</span></span><br><span class="line">    <span class="comment">-- means there will be no filtering of pixels (blurriness), which is</span></span><br><span class="line">    <span class="comment">-- important for a nice crisp, 2D look</span></span><br><span class="line">    love.graphics.setDefaultFilter(<span class="string">&#x27;nearest&#x27;</span>, <span class="string">&#x27;nearest&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- set the title of our application window</span></span><br><span class="line">    love.window.setTitle(<span class="string">&#x27;Pong&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- &quot;seed&quot; the RNG so that calls to random are always random</span></span><br><span class="line">    <span class="comment">-- use the current time, since that will vary on startup every time</span></span><br><span class="line">    <span class="built_in">math</span>.<span class="built_in">randomseed</span>(<span class="built_in">os</span>.<span class="built_in">time</span>())</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- more &quot;retro-looking&quot; font object we can use for any text</span></span><br><span class="line">    smallFont = love.graphics.newFont(<span class="string">&#x27;font.ttf&#x27;</span>, <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- larger font for drawing the score on the screen</span></span><br><span class="line">    scoreFont = love.graphics.newFont(<span class="string">&#x27;font.ttf&#x27;</span>, <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- set LÖVE2D&#x27;s active font to the smallFont obect</span></span><br><span class="line">    love.graphics.setFont(smallFont)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- initialize window with virtual resolution</span></span><br><span class="line">    push:setupScreen(VIRTUAL_WIDTH, VIRTUAL_HEIGHT, WINDOW_WIDTH, WINDOW_HEIGHT, &#123;</span><br><span class="line">        fullscreen = <span class="literal">false</span>,</span><br><span class="line">        resizable = <span class="literal">false</span>,</span><br><span class="line">        vsync = <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- initialize score variables, used for rendering on the screen and keeping</span></span><br><span class="line">    <span class="comment">-- track of the winner</span></span><br><span class="line">    player1Score = <span class="number">0</span></span><br><span class="line">    player2Score = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- either going to be 1 or 2; whomever is scored on gets to serve the</span></span><br><span class="line">    <span class="comment">-- following turn</span></span><br><span class="line">    servingPlayer = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- initialize player paddles and ball</span></span><br><span class="line">    player1 = Paddle(<span class="number">10</span>, <span class="number">30</span>, <span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">    player2 = Paddle(VIRTUAL_WIDTH - <span class="number">10</span>, VIRTUAL_HEIGHT - <span class="number">30</span>, <span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">    ball = Ball(VIRTUAL_WIDTH / <span class="number">2</span> - <span class="number">2</span>, VIRTUAL_HEIGHT / <span class="number">2</span> - <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    gameState = <span class="string">&#x27;start&#x27;</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Runs every frame, with &quot;dt&quot; passed in, our delta in seconds</span></span><br><span class="line"><span class="comment">    since the last frame, which LÖVE2D supplies us.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.update</span><span class="params">(dt)</span></span></span><br><span class="line">    <span class="keyword">if</span> gameState == <span class="string">&#x27;serve&#x27;</span> <span class="keyword">then</span> <span class="comment">-- serve state</span></span><br><span class="line">        <span class="comment">-- before switching to play, initialize ball&#x27;s velocity based</span></span><br><span class="line">        <span class="comment">-- on player who last scored</span></span><br><span class="line">        ball.dy = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">-50</span>, <span class="number">50</span>)</span><br><span class="line">        <span class="keyword">if</span> servingPlayer == <span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">            ball.dx = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">140</span>, <span class="number">200</span>)</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            ball.dx = -<span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">140</span>, <span class="number">200</span>)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">elseif</span> gameState == <span class="string">&#x27;play&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- detect ball collision with paddles, reversing dx if true and</span></span><br><span class="line">        <span class="comment">-- slightly increasing it, then altering the dy based on the position of collision</span></span><br><span class="line">        <span class="keyword">if</span> ball:collides(player1) <span class="keyword">then</span></span><br><span class="line">            ball.dx = -ball.dx * <span class="number">1.03</span></span><br><span class="line">            ball.x = player1.x + <span class="number">5</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">-- keep velocity going in the same direction, but randomize it</span></span><br><span class="line">            <span class="keyword">if</span> ball.dy &lt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">                ball.dy = -<span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">10</span>, <span class="number">150</span>)</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                ball.dy = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">10</span>, <span class="number">150</span>)</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">if</span> ball:collides(player2) <span class="keyword">then</span></span><br><span class="line">            ball.dx = -ball.dx * <span class="number">1.03</span></span><br><span class="line">            ball.x = player2.x - <span class="number">4</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">-- keep velocity going in the same direction, but randomize it</span></span><br><span class="line">            <span class="keyword">if</span> ball.dy &lt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">                ball.dy = -<span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">10</span>, <span class="number">150</span>)</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                ball.dy = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">10</span>, <span class="number">150</span>)</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">-- detect upper and lower screen boundary collision and reverse if collided</span></span><br><span class="line">        <span class="keyword">if</span> ball.y &lt;= <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">            ball.y = <span class="number">0</span></span><br><span class="line">            ball.dy = -ball.dy</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">-- -4 to account for the ball&#x27;s size</span></span><br><span class="line">        <span class="keyword">if</span> ball.y &gt;= VIRTUAL_HEIGHT - <span class="number">4</span> <span class="keyword">then</span></span><br><span class="line">            ball.y = VIRTUAL_HEIGHT - <span class="number">4</span></span><br><span class="line">            ball.dy = -ball.dy</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- if we reach the left or right edge of the screen,</span></span><br><span class="line">    <span class="comment">-- go back to start and update the score</span></span><br><span class="line">    <span class="keyword">if</span> ball.x &lt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">        servingPlayer = <span class="number">1</span></span><br><span class="line">        player2Score = player2Score + <span class="number">1</span></span><br><span class="line">        ball:reset()</span><br><span class="line">        gameState = <span class="string">&#x27;serve&#x27;</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ball.x &gt; VIRTUAL_WIDTH <span class="keyword">then</span></span><br><span class="line">        servingPlayer = <span class="number">2</span></span><br><span class="line">        player1Score = player1Score + <span class="number">1</span></span><br><span class="line">        ball:reset()</span><br><span class="line">        gameState = <span class="string">&#x27;serve&#x27;</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- player 1 movement</span></span><br><span class="line">    <span class="keyword">if</span> love.keyboard.isDown(<span class="string">&#x27;w&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player1.dy = -PADDLE_SPEED</span><br><span class="line">    <span class="keyword">elseif</span> love.keyboard.isDown(<span class="string">&#x27;s&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player1.dy = PADDLE_SPEED</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        player1.dy = <span class="number">0</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- player 2 movement</span></span><br><span class="line">    <span class="keyword">if</span> love.keyboard.isDown(<span class="string">&#x27;up&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player2.dy = -PADDLE_SPEED</span><br><span class="line">    <span class="keyword">elseif</span> love.keyboard.isDown(<span class="string">&#x27;down&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player2.dy = PADDLE_SPEED</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        player2.dy = <span class="number">0</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- update our ball based on its DX and DY only if we&#x27;re in play state;</span></span><br><span class="line">    <span class="comment">-- scale the velocity by dt so movement is framerate-independent</span></span><br><span class="line">    <span class="keyword">if</span> gameState == <span class="string">&#x27;play&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        ball:update(dt)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    player1:update(dt)</span><br><span class="line">    player2:update(dt)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Keyboard handling, called by LÖVE2D each frame;</span></span><br><span class="line"><span class="comment">    passes in the key we pressed so we can access.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.keypressed</span><span class="params">(key)</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> key == <span class="string">&#x27;escape&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        love.event.quit()</span><br><span class="line">    <span class="comment">-- if we press enter during either the start or serve phase, it should</span></span><br><span class="line">    <span class="comment">-- transition to the next appropriate state</span></span><br><span class="line">    <span class="keyword">elseif</span> key == <span class="string">&#x27;enter&#x27;</span> <span class="keyword">or</span> key == <span class="string">&#x27;return&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">if</span> gameState == <span class="string">&#x27;start&#x27;</span> <span class="keyword">then</span></span><br><span class="line">            gameState = <span class="string">&#x27;serve&#x27;</span></span><br><span class="line">        <span class="keyword">elseif</span> gameState == <span class="string">&#x27;serve&#x27;</span> <span class="keyword">then</span></span><br><span class="line">            gameState = <span class="string">&#x27;play&#x27;</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Called after update by LÖVE2D, used to draw anything to the screen,</span></span><br><span class="line"><span class="comment">    updated or otherwise.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.draw</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line">    push:apply(<span class="string">&#x27;start&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- clear the screen with a specific color; in this case, a color similar</span></span><br><span class="line">    <span class="comment">-- to some versions of the original Pong</span></span><br><span class="line">    love.graphics.clear(<span class="number">40</span>/<span class="number">255</span>, <span class="number">45</span>/<span class="number">255</span>, <span class="number">52</span>/<span class="number">255</span>, <span class="number">255</span>/<span class="number">255</span>)</span><br><span class="line"></span><br><span class="line">    love.graphics.setFont(smallFont)</span><br><span class="line"></span><br><span class="line">    displayScore()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> gameState == <span class="string">&#x27;start&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        love.graphics.setFont(smallFont)</span><br><span class="line">        love.graphics.printf(<span class="string">&#x27;Welcome to Pong!&#x27;</span>, <span class="number">0</span>, <span class="number">10</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">        love.graphics.printf(<span class="string">&#x27;Press Enter to begin!&#x27;</span>, <span class="number">0</span>, <span class="number">20</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">    <span class="keyword">elseif</span> gameState == <span class="string">&#x27;serve&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        love.graphics.setFont(smallFont)</span><br><span class="line">        love.graphics.printf(<span class="string">&#x27;Player &#x27;</span> .. <span class="built_in">tostring</span>(servingPlayer) .. <span class="string">&quot;&#x27;s serve!&quot;</span>,</span><br><span class="line">            <span class="number">0</span>, <span class="number">10</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">        love.graphics.printf(<span class="string">&#x27;Press Enter to serve!&#x27;</span>, <span class="number">0</span>, <span class="number">20</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">    <span class="keyword">elseif</span> gameState == <span class="string">&#x27;play&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- no UI messages to display in play</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    player1:render()</span><br><span class="line">    player2:render()</span><br><span class="line">    ball:render()</span><br><span class="line"></span><br><span class="line">    displayFPS()</span><br><span class="line"></span><br><span class="line">    push:apply(<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h1 id="10"><a href="#10" class="headerlink" title="10"></a>10</h1><p>增加winning condition.</p>
<h2 id="source-code-10"><a href="#source-code-10" class="headerlink" title="source code"></a>source code</h2><p>当赢了的时候.</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> player1Score == <span class="number">10</span> <span class="keyword">then</span></span><br><span class="line">  winningPlayer = <span class="number">1</span></span><br><span class="line">  gameState = <span class="string">&#x27;done&#x27;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  gameState = <span class="string">&#x27;serve&#x27;</span></span><br><span class="line">  ball:reset()</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>当进入下一轮的时候.</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.keypressed</span><span class="params">(key)</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> key == <span class="string">&#x27;escape&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        love.event.quit()</span><br><span class="line">    <span class="comment">-- if we press enter during either the start or serve phase, it should</span></span><br><span class="line">    <span class="comment">-- transition to the next appropriate state</span></span><br><span class="line">    <span class="keyword">elseif</span> key == <span class="string">&#x27;enter&#x27;</span> <span class="keyword">or</span> key == <span class="string">&#x27;return&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">if</span> gameState == <span class="string">&#x27;start&#x27;</span> <span class="keyword">then</span></span><br><span class="line">            gameState = <span class="string">&#x27;serve&#x27;</span></span><br><span class="line">        <span class="keyword">elseif</span> gameState == <span class="string">&#x27;serve&#x27;</span> <span class="keyword">then</span></span><br><span class="line">            gameState = <span class="string">&#x27;play&#x27;</span></span><br><span class="line">        <span class="keyword">elseif</span> gameState == <span class="string">&#x27;done&#x27;</span> <span class="keyword">then</span></span><br><span class="line">            <span class="comment">-- game is simply in a restart phase here, but will set the serving</span></span><br><span class="line">            <span class="comment">-- player to the opponent of whomever won for fairness!</span></span><br><span class="line">            gameState = <span class="string">&#x27;serve&#x27;</span></span><br><span class="line"></span><br><span class="line">            ball:reset()</span><br><span class="line"></span><br><span class="line">            <span class="comment">-- reset scores to 0</span></span><br><span class="line">            player1Score = <span class="number">0</span></span><br><span class="line">            player2Score = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">-- decide serving player as the opposite of who won</span></span><br><span class="line">            <span class="keyword">if</span> winningPlayer == <span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">                servingPlayer = <span class="number">2</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                servingPlayer = <span class="number">1</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h1 id="11"><a href="#11" class="headerlink" title="11"></a>11</h1><p>加音乐!</p>
<h2 id="function-9"><a href="#function-9" class="headerlink" title="function"></a>function</h2><p>love.audio.newSource(path, [type])</p>
<ul>
<li>Creates a LÖVE2D Audio object that we can play back at any point in our program. Can also be given a “type” of “stream” or “static”; streamed assets will be streamed from disk as needed, whereas static assets will be preserved in memory. For larger sound effects and music tracks, streaming is more memory-effective; in our examples, audio assets are static, since they’re so small that they won’t take up much memory at all.</li>
</ul>
<h2 id="software"><a href="#software" class="headerlink" title="software"></a>software</h2><ul>
<li>Simple sound-generating program, freely available on major OSes.</li>
<li>Used to generate all sound effects for our Pong example and most examples going forward.</li>
<li><a target="_blank" rel="noopener" href="https://www.bfxr.net/">https://www.bfxr.net/</a></li>
</ul>
<h2 id="source-code-11"><a href="#source-code-11" class="headerlink" title="source code"></a>source code</h2><p>Import sound as a table.</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- set up our sound effects; later, we can just index this table and</span></span><br><span class="line"><span class="comment">-- call each entry&#x27;s `play` method</span></span><br><span class="line">sounds = &#123;</span><br><span class="line">    [<span class="string">&#x27;paddle_hit&#x27;</span>] = love.audio.newSource(<span class="string">&#x27;sounds/paddle_hit.wav&#x27;</span>, <span class="string">&#x27;static&#x27;</span>),</span><br><span class="line">    <span class="comment">-- if static, it will load into and memory, if steam, they are loaded on the fly</span></span><br><span class="line">    <span class="comment">-- steam is helpful for saving memory(for example large music files)</span></span><br><span class="line">    [<span class="string">&#x27;score&#x27;</span>] = love.audio.newSource(<span class="string">&#x27;sounds/score.wav&#x27;</span>, <span class="string">&#x27;static&#x27;</span>),</span><br><span class="line">    [<span class="string">&#x27;wall_hit&#x27;</span>] = love.audio.newSource(<span class="string">&#x27;sounds/wall_hit.wav&#x27;</span>, <span class="string">&#x27;static&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要的时候.</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sounds[<span class="string">&#x27;paddle_hit&#x27;</span>]:play()</span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h1 id="12"><a href="#12" class="headerlink" title="12"></a>12</h1><p>The Resize Update.</p>
<h2 id="function-10"><a href="#function-10" class="headerlink" title="function"></a>function</h2><p>love.resize(width, height)</p>
<ul>
<li>Called by LÖVE every time we resize the application; logic should go in here if anything in the game (like a UI) is sized dynamically based on the window size. push:resize() needs to be called here for our use case so that it can dynamically rescale its internal canvas to fit our new window dimensions.</li>
</ul>
<h2 id="source-code-12"><a href="#source-code-12" class="headerlink" title="source code"></a>source code</h2><p>这是最后的版本了,所以是全部的main.lua .</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    GD50 2018</span></span><br><span class="line"><span class="comment">    Pong Remake</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    -- Main Program --</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Author: Colton Ogden</span></span><br><span class="line"><span class="comment">    cogden@cs50.harvard.edu</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Originally programmed by Atari in 1972. Features two</span></span><br><span class="line"><span class="comment">    paddles, controlled by players, with the goal of getting</span></span><br><span class="line"><span class="comment">    the ball past your opponent&#x27;s edge. First to 10 points wins.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    This version is built to more closely resemble the NES than</span></span><br><span class="line"><span class="comment">    the original Pong machines or the Atari 2600 in terms of</span></span><br><span class="line"><span class="comment">    resolution, though in widescreen (16:9) so it looks nicer on</span></span><br><span class="line"><span class="comment">    modern systems.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- push is a library that will allow us to draw our game at a virtual</span></span><br><span class="line"><span class="comment">-- resolution, instead of however large our window is; used to provide</span></span><br><span class="line"><span class="comment">-- a more retro aesthetic</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- https://github.com/Ulydev/push</span></span><br><span class="line">push = <span class="built_in">require</span> <span class="string">&#x27;push&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- the &quot;Class&quot; library we&#x27;re using will allow us to represent anything in</span></span><br><span class="line"><span class="comment">-- our game as code, rather than keeping track of many disparate variables and</span></span><br><span class="line"><span class="comment">-- methods</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- https://github.com/vrld/hump/blob/master/class.lua</span></span><br><span class="line">Class = <span class="built_in">require</span> <span class="string">&#x27;class&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- our Paddle class, which stores position and dimensions for each Paddle</span></span><br><span class="line"><span class="comment">-- and the logic for rendering them</span></span><br><span class="line"><span class="built_in">require</span> <span class="string">&#x27;Paddle&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- our Ball class, which isn&#x27;t much different than a Paddle structure-wise</span></span><br><span class="line"><span class="comment">-- but which will mechanically function very differently</span></span><br><span class="line"><span class="built_in">require</span> <span class="string">&#x27;Ball&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- size of our actual window</span></span><br><span class="line">WINDOW_WIDTH = <span class="number">1280</span></span><br><span class="line">WINDOW_HEIGHT = <span class="number">720</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- size we&#x27;re trying to emulate with push</span></span><br><span class="line">VIRTUAL_WIDTH = <span class="number">432</span></span><br><span class="line">VIRTUAL_HEIGHT = <span class="number">243</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- paddle movement speed</span></span><br><span class="line">PADDLE_SPEED = <span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Called just once at the beginning of the game; used to set up</span></span><br><span class="line"><span class="comment">    game objects, variables, etc. and prepare the game world.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.load</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">-- set love&#x27;s default filter to &quot;nearest-neighbor&quot;, which essentially</span></span><br><span class="line">    <span class="comment">-- means there will be no filtering of pixels (blurriness), which is</span></span><br><span class="line">    <span class="comment">-- important for a nice crisp, 2D look</span></span><br><span class="line">    love.graphics.setDefaultFilter(<span class="string">&#x27;nearest&#x27;</span>, <span class="string">&#x27;nearest&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- set the title of our application window</span></span><br><span class="line">    love.window.setTitle(<span class="string">&#x27;Pong&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- seed the RNG so that calls to random are always random</span></span><br><span class="line">    <span class="built_in">math</span>.<span class="built_in">randomseed</span>(<span class="built_in">os</span>.<span class="built_in">time</span>())</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- initialize our nice-looking retro text fonts</span></span><br><span class="line">    smallFont = love.graphics.newFont(<span class="string">&#x27;font.ttf&#x27;</span>, <span class="number">8</span>)</span><br><span class="line">    largeFont = love.graphics.newFont(<span class="string">&#x27;font.ttf&#x27;</span>, <span class="number">16</span>)</span><br><span class="line">    scoreFont = love.graphics.newFont(<span class="string">&#x27;font.ttf&#x27;</span>, <span class="number">32</span>)</span><br><span class="line">    love.graphics.setFont(smallFont)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- set up our sound effects; later, we can just index this table and</span></span><br><span class="line">    <span class="comment">-- call each entry&#x27;s `play` method</span></span><br><span class="line">    sounds = &#123;</span><br><span class="line">        [<span class="string">&#x27;paddle_hit&#x27;</span>] = love.audio.newSource(<span class="string">&#x27;sounds/paddle_hit.wav&#x27;</span>, <span class="string">&#x27;static&#x27;</span>),</span><br><span class="line">        [<span class="string">&#x27;score&#x27;</span>] = love.audio.newSource(<span class="string">&#x27;sounds/score.wav&#x27;</span>, <span class="string">&#x27;static&#x27;</span>),</span><br><span class="line">        [<span class="string">&#x27;wall_hit&#x27;</span>] = love.audio.newSource(<span class="string">&#x27;sounds/wall_hit.wav&#x27;</span>, <span class="string">&#x27;static&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- initialize our virtual resolution, which will be rendered within our</span></span><br><span class="line">    <span class="comment">-- actual window no matter its dimensions</span></span><br><span class="line">    push:setupScreen(VIRTUAL_WIDTH, VIRTUAL_HEIGHT, WINDOW_WIDTH, WINDOW_HEIGHT, &#123;</span><br><span class="line">        fullscreen = <span class="literal">false</span>,</span><br><span class="line">        resizable = <span class="literal">true</span>,</span><br><span class="line">        vsync = <span class="literal">true</span>,</span><br><span class="line">        canvas = <span class="literal">false</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- initialize our player paddles; make them global so that they can be</span></span><br><span class="line">    <span class="comment">-- detected by other functions and modules</span></span><br><span class="line">    player1 = Paddle(<span class="number">10</span>, <span class="number">30</span>, <span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">    player2 = Paddle(VIRTUAL_WIDTH - <span class="number">10</span>, VIRTUAL_HEIGHT - <span class="number">30</span>, <span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- place a ball in the middle of the screen</span></span><br><span class="line">    ball = Ball(VIRTUAL_WIDTH / <span class="number">2</span> - <span class="number">2</span>, VIRTUAL_HEIGHT / <span class="number">2</span> - <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- initialize score variables</span></span><br><span class="line">    player1Score = <span class="number">0</span></span><br><span class="line">    player2Score = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- either going to be 1 or 2; whomever is scored on gets to serve the</span></span><br><span class="line">    <span class="comment">-- following turn</span></span><br><span class="line">    servingPlayer = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- player who won the game; not set to a proper value until we reach</span></span><br><span class="line">    <span class="comment">-- that state in the game</span></span><br><span class="line">    winningPlayer = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- the state of our game; can be any of the following:</span></span><br><span class="line">    <span class="comment">-- 1. &#x27;start&#x27; (the beginning of the game, before first serve)</span></span><br><span class="line">    <span class="comment">-- 2. &#x27;serve&#x27; (waiting on a key press to serve the ball)</span></span><br><span class="line">    <span class="comment">-- 3. &#x27;play&#x27; (the ball is in play, bouncing between paddles)</span></span><br><span class="line">    <span class="comment">-- 4. &#x27;done&#x27; (the game is over, with a victor, ready for restart)</span></span><br><span class="line">    gameState = <span class="string">&#x27;start&#x27;</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Called whenever we change the dimensions of our window, as by dragging</span></span><br><span class="line"><span class="comment">    out its bottom corner, for example. In this case, we only need to worry</span></span><br><span class="line"><span class="comment">    about calling out to `push` to handle the resizing. Takes in a `w` and</span></span><br><span class="line"><span class="comment">    `h` variable representing width and height, respectively.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.resize</span><span class="params">(w, h)</span></span></span><br><span class="line">    push:resize(w, h)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Called every frame, passing in `dt` since the last frame. `dt`</span></span><br><span class="line"><span class="comment">    is short for `deltaTime` and is measured in seconds. Multiplying</span></span><br><span class="line"><span class="comment">    this by any changes we wish to make in our game will allow our</span></span><br><span class="line"><span class="comment">    game to perform consistently across all hardware; otherwise, any</span></span><br><span class="line"><span class="comment">    changes we make will be applied as fast as possible and will vary</span></span><br><span class="line"><span class="comment">    across system hardware.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.update</span><span class="params">(dt)</span></span></span><br><span class="line">    <span class="keyword">if</span> gameState == <span class="string">&#x27;serve&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- before switching to play, initialize ball&#x27;s velocity based</span></span><br><span class="line">        <span class="comment">-- on player who last scored</span></span><br><span class="line">        ball.dy = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">-50</span>, <span class="number">50</span>)</span><br><span class="line">        <span class="keyword">if</span> servingPlayer == <span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">            ball.dx = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">140</span>, <span class="number">200</span>)</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            ball.dx = -<span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">140</span>, <span class="number">200</span>)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">elseif</span> gameState == <span class="string">&#x27;play&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- detect ball collision with paddles, reversing dx if true and</span></span><br><span class="line">        <span class="comment">-- slightly increasing it, then altering the dy based on the position</span></span><br><span class="line">        <span class="comment">-- at which it collided, then playing a sound effect</span></span><br><span class="line">        <span class="keyword">if</span> ball:collides(player1) <span class="keyword">then</span></span><br><span class="line">            ball.dx = -ball.dx * <span class="number">1.03</span></span><br><span class="line">            ball.x = player1.x + <span class="number">5</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">-- keep velocity going in the same direction, but randomize it</span></span><br><span class="line">            <span class="keyword">if</span> ball.dy &lt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">                ball.dy = -<span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">10</span>, <span class="number">150</span>)</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                ball.dy = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">10</span>, <span class="number">150</span>)</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">            sounds[<span class="string">&#x27;paddle_hit&#x27;</span>]:play()</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">if</span> ball:collides(player2) <span class="keyword">then</span></span><br><span class="line">            ball.dx = -ball.dx * <span class="number">1.03</span></span><br><span class="line">            ball.x = player2.x - <span class="number">4</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">-- keep velocity going in the same direction, but randomize it</span></span><br><span class="line">            <span class="keyword">if</span> ball.dy &lt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">                ball.dy = -<span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">10</span>, <span class="number">150</span>)</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                ball.dy = <span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">10</span>, <span class="number">150</span>)</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">            sounds[<span class="string">&#x27;paddle_hit&#x27;</span>]:play()</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">-- detect upper and lower screen boundary collision, playing a sound</span></span><br><span class="line">        <span class="comment">-- effect and reversing dy if true</span></span><br><span class="line">        <span class="keyword">if</span> ball.y &lt;= <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">            ball.y = <span class="number">0</span></span><br><span class="line">            ball.dy = -ball.dy</span><br><span class="line">            sounds[<span class="string">&#x27;wall_hit&#x27;</span>]:play()</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">-- -4 to account for the ball&#x27;s size</span></span><br><span class="line">        <span class="keyword">if</span> ball.y &gt;= VIRTUAL_HEIGHT - <span class="number">4</span> <span class="keyword">then</span></span><br><span class="line">            ball.y = VIRTUAL_HEIGHT - <span class="number">4</span></span><br><span class="line">            ball.dy = -ball.dy</span><br><span class="line">            sounds[<span class="string">&#x27;wall_hit&#x27;</span>]:play()</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">-- if we reach the left or right edge of the screen, go back to serve</span></span><br><span class="line">        <span class="comment">-- and update the score and serving player</span></span><br><span class="line">        <span class="keyword">if</span> ball.x &lt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">            servingPlayer = <span class="number">1</span></span><br><span class="line">            player2Score = player2Score + <span class="number">1</span></span><br><span class="line">            sounds[<span class="string">&#x27;score&#x27;</span>]:play()</span><br><span class="line"></span><br><span class="line">            <span class="comment">-- if we&#x27;ve reached a score of 10, the game is over; set the</span></span><br><span class="line">            <span class="comment">-- state to done so we can show the victory message</span></span><br><span class="line">            <span class="keyword">if</span> player2Score == <span class="number">10</span> <span class="keyword">then</span></span><br><span class="line">                winningPlayer = <span class="number">2</span></span><br><span class="line">                gameState = <span class="string">&#x27;done&#x27;</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                gameState = <span class="string">&#x27;serve&#x27;</span></span><br><span class="line">                <span class="comment">-- places the ball in the middle of the screen, no velocity</span></span><br><span class="line">                ball:reset()</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ball.x &gt; VIRTUAL_WIDTH <span class="keyword">then</span></span><br><span class="line">            servingPlayer = <span class="number">2</span></span><br><span class="line">            player1Score = player1Score + <span class="number">1</span></span><br><span class="line">            sounds[<span class="string">&#x27;score&#x27;</span>]:play()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> player1Score == <span class="number">10</span> <span class="keyword">then</span></span><br><span class="line">                winningPlayer = <span class="number">1</span></span><br><span class="line">                gameState = <span class="string">&#x27;done&#x27;</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                gameState = <span class="string">&#x27;serve&#x27;</span></span><br><span class="line">                ball:reset()</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">--</span></span><br><span class="line">    <span class="comment">-- paddles can move no matter what state we&#x27;re in</span></span><br><span class="line">    <span class="comment">--</span></span><br><span class="line">    <span class="comment">-- player 1</span></span><br><span class="line">    <span class="keyword">if</span> love.keyboard.isDown(<span class="string">&#x27;w&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player1.dy = -PADDLE_SPEED</span><br><span class="line">    <span class="keyword">elseif</span> love.keyboard.isDown(<span class="string">&#x27;s&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player1.dy = PADDLE_SPEED</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        player1.dy = <span class="number">0</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- player 2</span></span><br><span class="line">    <span class="keyword">if</span> love.keyboard.isDown(<span class="string">&#x27;up&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player2.dy = -PADDLE_SPEED</span><br><span class="line">    <span class="keyword">elseif</span> love.keyboard.isDown(<span class="string">&#x27;down&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">        player2.dy = PADDLE_SPEED</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        player2.dy = <span class="number">0</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- update our ball based on its DX and DY only if we&#x27;re in play state;</span></span><br><span class="line">    <span class="comment">-- scale the velocity by dt so movement is framerate-independent</span></span><br><span class="line">    <span class="keyword">if</span> gameState == <span class="string">&#x27;play&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        ball:update(dt)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    player1:update(dt)</span><br><span class="line">    player2:update(dt)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    A callback that processes key strokes as they happen, just the once.</span></span><br><span class="line"><span class="comment">    Does not account for keys that are held down, which is handled by a</span></span><br><span class="line"><span class="comment">    separate function (`love.keyboard.isDown`). Useful for when we want</span></span><br><span class="line"><span class="comment">    things to happen right away, just once, like when we want to quit.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.keypressed</span><span class="params">(key)</span></span></span><br><span class="line">    <span class="comment">-- `key` will be whatever key this callback detected as pressed</span></span><br><span class="line">    <span class="keyword">if</span> key == <span class="string">&#x27;escape&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- the function LÖVE2D uses to quit the application</span></span><br><span class="line">        love.event.quit()</span><br><span class="line">    <span class="comment">-- if we press enter during either the start or serve phase, it should</span></span><br><span class="line">    <span class="comment">-- transition to the next appropriate state</span></span><br><span class="line">    <span class="keyword">elseif</span> key == <span class="string">&#x27;enter&#x27;</span> <span class="keyword">or</span> key == <span class="string">&#x27;return&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">if</span> gameState == <span class="string">&#x27;start&#x27;</span> <span class="keyword">then</span></span><br><span class="line">            gameState = <span class="string">&#x27;serve&#x27;</span></span><br><span class="line">        <span class="keyword">elseif</span> gameState == <span class="string">&#x27;serve&#x27;</span> <span class="keyword">then</span></span><br><span class="line">            gameState = <span class="string">&#x27;play&#x27;</span></span><br><span class="line">        <span class="keyword">elseif</span> gameState == <span class="string">&#x27;done&#x27;</span> <span class="keyword">then</span></span><br><span class="line">            <span class="comment">-- game is simply in a restart phase here, but will set the serving</span></span><br><span class="line">            <span class="comment">-- player to the opponent of whomever won for fairness!</span></span><br><span class="line">            gameState = <span class="string">&#x27;serve&#x27;</span></span><br><span class="line"></span><br><span class="line">            ball:reset()</span><br><span class="line"></span><br><span class="line">            <span class="comment">-- reset scores to 0</span></span><br><span class="line">            player1Score = <span class="number">0</span></span><br><span class="line">            player2Score = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">-- decide serving player as the opposite of who won</span></span><br><span class="line">            <span class="keyword">if</span> winningPlayer == <span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">                servingPlayer = <span class="number">2</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                servingPlayer = <span class="number">1</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Called each frame after update; is responsible simply for</span></span><br><span class="line"><span class="comment">    drawing all of our game objects and more to the screen.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">love.draw</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">-- begin drawing with push, in our virtual resolution</span></span><br><span class="line">    push:start()</span><br><span class="line"></span><br><span class="line">    love.graphics.clear(<span class="number">40</span>/<span class="number">255</span>, <span class="number">45</span>/<span class="number">255</span>, <span class="number">52</span>/<span class="number">255</span>, <span class="number">255</span>/<span class="number">255</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- render different things depending on which part of the game we&#x27;re in</span></span><br><span class="line">    <span class="keyword">if</span> gameState == <span class="string">&#x27;start&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- UI messages</span></span><br><span class="line">        love.graphics.setFont(smallFont)</span><br><span class="line">        love.graphics.printf(<span class="string">&#x27;Welcome to Pong!&#x27;</span>, <span class="number">0</span>, <span class="number">10</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">        love.graphics.printf(<span class="string">&#x27;Press Enter to begin!&#x27;</span>, <span class="number">0</span>, <span class="number">20</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">    <span class="keyword">elseif</span> gameState == <span class="string">&#x27;serve&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- UI messages</span></span><br><span class="line">        love.graphics.setFont(smallFont)</span><br><span class="line">        love.graphics.printf(<span class="string">&#x27;Player &#x27;</span> .. <span class="built_in">tostring</span>(servingPlayer) .. <span class="string">&quot;&#x27;s serve!&quot;</span>,</span><br><span class="line">            <span class="number">0</span>, <span class="number">10</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">        love.graphics.printf(<span class="string">&#x27;Press Enter to serve!&#x27;</span>, <span class="number">0</span>, <span class="number">20</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">    <span class="keyword">elseif</span> gameState == <span class="string">&#x27;play&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- no UI messages to display in play</span></span><br><span class="line">    <span class="keyword">elseif</span> gameState == <span class="string">&#x27;done&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- UI messages</span></span><br><span class="line">        love.graphics.setFont(largeFont)</span><br><span class="line">        love.graphics.printf(<span class="string">&#x27;Player &#x27;</span> .. <span class="built_in">tostring</span>(winningPlayer) .. <span class="string">&#x27; wins!&#x27;</span>,</span><br><span class="line">            <span class="number">0</span>, <span class="number">10</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">        love.graphics.setFont(smallFont)</span><br><span class="line">        love.graphics.printf(<span class="string">&#x27;Press Enter to restart!&#x27;</span>, <span class="number">0</span>, <span class="number">30</span>, VIRTUAL_WIDTH, <span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- show the score before ball is rendered so it can move over the text</span></span><br><span class="line">    displayScore()</span><br><span class="line"></span><br><span class="line">    player1:render()</span><br><span class="line">    player2:render()</span><br><span class="line">    ball:render()</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- display FPS for debugging; simply comment out to remove</span></span><br><span class="line">    displayFPS()</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- end our drawing to push</span></span><br><span class="line">    push:finish()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Simple function for rendering the scores.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">displayScore</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">-- score display</span></span><br><span class="line">    love.graphics.setFont(scoreFont)</span><br><span class="line">    love.graphics.<span class="built_in">print</span>(<span class="built_in">tostring</span>(player1Score), VIRTUAL_WIDTH / <span class="number">2</span> - <span class="number">50</span>,</span><br><span class="line">        VIRTUAL_HEIGHT / <span class="number">3</span>)</span><br><span class="line">    love.graphics.<span class="built_in">print</span>(<span class="built_in">tostring</span>(player2Score), VIRTUAL_WIDTH / <span class="number">2</span> + <span class="number">30</span>,</span><br><span class="line">        VIRTUAL_HEIGHT / <span class="number">3</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">    Renders the current FPS.</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">displayFPS</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">-- simple FPS display across all states</span></span><br><span class="line">    love.graphics.setFont(smallFont)</span><br><span class="line">    love.graphics.setColor(<span class="number">0</span>, <span class="number">255</span>/<span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>/<span class="number">255</span>)</span><br><span class="line">    love.graphics.<span class="built_in">print</span>(<span class="string">&#x27;FPS: &#x27;</span> .. <span class="built_in">tostring</span>(love.timer.getFPS()), <span class="number">10</span>, <span class="number">10</span>)</span><br><span class="line">    love.graphics.setColor(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>
<br>
<br>

<h1 id="Encore"><a href="#Encore" class="headerlink" title="Encore"></a>Encore</h1><p>这个project的作业是给paddle1或2加入一个AI.<br>仔细一读,不需要从头开始code起,只要个feature就行,真是温柔呢.</p>
<blockquote>
<p>Implement an AI-controlled paddle (either the left or the right will do) such that it will try to deflect the ball at all times. Since the paddle can move on only one axis (the Y axis), you will need to determine how to keep the paddle moving in relation to the ball. Currently, each paddle has its own chunk of code where input is detected by the keyboard; this feels like an excellent place to put the code we need! Once either the left or right paddle (or both, if desired) try to deflect the paddle on their own, you’ve done it!</p>
</blockquote>
<div class="note ">
            <p>At the time of the course’s lectures being filmed, we were using a now-outdated version of LÖVE (0.10.2); most of everything has remained the same into the newer version 11 series of the framework, but one core change is worth noting: love.graphics.clear and functions like it which take four arguments representing the red, green, blue, and alpha components of a color (or RGBA) formerly took integer values between 0 and 255:</p><p>love.graphics.clear(255, 0, 0, 255)<br>However, the API has now changed to where all functions that formerly took integer values for color components now take a floating-point value between 0 and 1; for example, the above API call would translate to the following:</p><p>love.graphics.clear(1, 0, 0, 1)<br>An easy way to normalize the old style to the new style is simply to divide components by 255. If, for example, we had a color we liked with the components 120, 30, 70, and 255, we could write it like the below:</p><p>love.graphics.clear(120/255, 30/255, 70/255, 255/255)</p>
          </div>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/blog/tags/%E7%BC%96%E7%A0%81/" rel="tag"># 编码</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/blog/2022/02/11/P229/" rel="prev" title="更新报…预,预告">
      <i class="fa fa-chevron-left"></i> 更新报…预,预告
    </a></div>
      <div class="post-nav-item">
    <a href="/blog/2022/01/31/P226/" rel="next" title="Problem solver">
      Problem solver <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#0"><span class="nav-number">1.</span> <span class="nav-text">0</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#function"><span class="nav-number">1.1.</span> <span class="nav-text">function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#source-code"><span class="nav-number">1.2.</span> <span class="nav-text">source code</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1"><span class="nav-number">2.</span> <span class="nav-text">1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#function-1"><span class="nav-number">2.1.</span> <span class="nav-text">function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#source-code-1"><span class="nav-number">2.2.</span> <span class="nav-text">source code</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2"><span class="nav-number">3.</span> <span class="nav-text">2</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#function-2"><span class="nav-number">3.1.</span> <span class="nav-text">function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#source-code-2"><span class="nav-number">3.2.</span> <span class="nav-text">source code</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3"><span class="nav-number">4.</span> <span class="nav-text">3</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#function-3"><span class="nav-number">4.1.</span> <span class="nav-text">function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#source-code-3"><span class="nav-number">4.2.</span> <span class="nav-text">source code</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4"><span class="nav-number">5.</span> <span class="nav-text">4</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#function-4"><span class="nav-number">5.1.</span> <span class="nav-text">function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#source-code-4"><span class="nav-number">5.2.</span> <span class="nav-text">source code</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-1"><span class="nav-number">6.</span> <span class="nav-text">4</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#function-5"><span class="nav-number">6.1.</span> <span class="nav-text">function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#source-code-5"><span class="nav-number">6.2.</span> <span class="nav-text">source code</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5"><span class="nav-number">7.</span> <span class="nav-text">5</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#function-6"><span class="nav-number">7.1.</span> <span class="nav-text">function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#source-code-6"><span class="nav-number">7.2.</span> <span class="nav-text">source code</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7"><span class="nav-number">8.</span> <span class="nav-text">7</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#function-7"><span class="nav-number">8.1.</span> <span class="nav-text">function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#source-code-7"><span class="nav-number">8.2.</span> <span class="nav-text">source code</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8"><span class="nav-number">9.</span> <span class="nav-text">8</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#source-code-8"><span class="nav-number">9.1.</span> <span class="nav-text">source code</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9"><span class="nav-number">10.</span> <span class="nav-text">9</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#function-8"><span class="nav-number">10.1.</span> <span class="nav-text">function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#source-code-9"><span class="nav-number">10.2.</span> <span class="nav-text">source code</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#10"><span class="nav-number">11.</span> <span class="nav-text">10</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#source-code-10"><span class="nav-number">11.1.</span> <span class="nav-text">source code</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#11"><span class="nav-number">12.</span> <span class="nav-text">11</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#function-9"><span class="nav-number">12.1.</span> <span class="nav-text">function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#software"><span class="nav-number">12.2.</span> <span class="nav-text">software</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#source-code-11"><span class="nav-number">12.3.</span> <span class="nav-text">source code</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#12"><span class="nav-number">13.</span> <span class="nav-text">12</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#function-10"><span class="nav-number">13.1.</span> <span class="nav-text">function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#source-code-12"><span class="nav-number">13.2.</span> <span class="nav-text">source code</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Encore"><span class="nav-number">14.</span> <span class="nav-text">Encore</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Mazui"
      src="/blog/images/logo_7.png">
  <p class="site-author-name" itemprop="name">Mazui</p>
  <div class="site-description" itemprop="description">与孤独和平共处.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives/">
        
          <span class="site-state-item-count">233</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/blog/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/blog/tags/">
          
        <span class="site-state-item-count">51</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:mazui.and.rio@gmail.com" title="E-Mail → mailto:mazui.and.rio@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/3032131561?topnav=1&wvr=6&topsug=1&ssl_rnd=1606158448.6943&is_all=1" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;3032131561?topnav&#x3D;1&amp;wvr&#x3D;6&amp;topsug&#x3D;1&amp;ssl_rnd&#x3D;1606158448.6943&amp;is_all&#x3D;1" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/mazui_3" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;mazui_3" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://instagram.com/mazui_3" title="Instagram → https:&#x2F;&#x2F;instagram.com&#x2F;mazui_3" rel="noopener" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
      </span>
  </div>



      </div>

<br>
      <!--new music test-->

  <!--网易云插件-->
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=465530020&auto=0&height=66"></iframe>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2015 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mazui</span>

<!--
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>


    <span title="C">967k</span>
  -->

  <!--
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="T">14:39</span>

  -->

</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>
<br>
<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">阅览室一共有967k的老兔正在打瞌睡</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/blog/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/blog/lib/velocity/velocity.min.js"></script>
  <script src="/blog/lib/velocity/velocity.ui.min.js"></script>

<script src="/blog/js/utils.js"></script>

<script src="/blog/js/motion.js"></script>


<script src="/blog/js/schemes/pisces.js"></script>


<script src="/blog/js/next-boot.js"></script>




  




  
<script src="/blog/js/local-search.js"></script>













  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://mazui3-com.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://mazui3.github.io/blog/2022/02/08/P224/";
    this.page.identifier = "2022/02/08/P224/";
    this.page.title = "GD50 - Pong";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://mazui3-com.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
